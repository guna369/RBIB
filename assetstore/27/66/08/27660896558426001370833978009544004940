Transforming Men into Mice (polynomial algorithm for genomic distance problem)
Sridhar Hannenhalli1 and Pavel A. Pevzner1;
Department of Computer Science and Engineering Institute of Molecular Evolutionary Genetics The Pennsylvania State University University Park, PA 16802
Then Puss said, \I understand that you have magical powers, that you can change yourself into any kind of animal... But, it must be easy to turn yourself into something huge. However, it must be impossible to turn into something very, very small - like a mouse". Brothers Grimm, Puss N Boots
Abstract
Many people (including ourselves) believe that transformations of humans into mice happen only in fairy tales. However, despite some di erences in appearance and habits, men and mice are genetically very similar. In the pioneering paper, Nadeau and Taylor, 1984 estimated that surprisingly few genomic rearrangements (178 39) happened since the divergence of human and mouse 80 million years ago. However, their analysis is non-constructive and no rearrangement scenario for human-mouse evolution has been suggested yet. The problem is complicated by the fact that rearrangements in multi-chromosomal genomes include inversions, translocations, fusions and ssions of chromosomes, a rather complex set of operations. As a result, at the rst glance, a polynomial algorithm for the genomic distance problem with all these operations looks almost as improbable as the transformation of a (real) man into a (real) mouse. We prove a duality theorem which expresses the genomic distance in terms of easily computable parameters re ecting di erent combinatorial properties of sets of strings. This theorem leads to a polynomial-time algorithm for computing most parsimonious rearrangement scenarios. Based on this result and the latest comparative physical mapping data we have constructed a scenario of human-mouse evolution with 131 reversals/translocations/fusions/ ssions. A combination of the genome rearrangement algorithm with the recently proposed experimental technique called ZOO-FISH suggests a new constructive approach to the 100-year old problem of reconstructing mammalian evolution.
1This work is supported by NSF Young Investigator award CCR-9457784 and NIH grant 1R01 HG00987. Authors' E-mail addresses: @ @hannenha cse:psu:edu; pevzner cse:psu:edu

1 Introduction

When the Brothers Grimm described a transformation of a man into a mouse they could hardly anticipate that two centuries later human and mouse will be the most genetically studied mammals. Man-mouse comparative physical mapping started 20 years ago and currently more than 1300 pairs of homologous genes are mapped in these species. As a result, biologists found that the related genes in human and mouse are not chaotically distributed over the genomes but instead form \conserved blocks" (synteny groups).

Current comparative mapping data indicate that both human and mouse genomes are combined from approximately 150 blocks which are \shu ed" in human as compared to mouse (Copeland et al., 1993). Shu ing of blocks happens quite rarely (roughly once in a million years) thus making it possible to reconstruct a rearrangement scenario of human-mouse evolution. Below we present the combinatorial formulation of the problem.

In an

the model we consider, associated sign ( \+"

oerve\r?y"g)enree

is represented by an ecting the direction

identi of the

cation number (positive gene. A chromosome is

integer) de ned

and as a

sequence of genes, while a genome is de ned as a set of chromosomes. Given two genomes and ?

with the same set of genes, we are interested in a most parsimonious scenario of evolution of into ?,

i.e. the shortest sequence of rearrangements (de ned below) to transform into ?. Fig. 1 illustrates

4 rearrangement events transforming one genome into another.

Let = f (1); : : :; (N)g be n\eqlieufbtivetianolegrnitgthhrete"pn(uriem.see.bneatrsaotifo=gnes(noef1s

a genome in the ith

consisting of chromosome.

N chromosomes and Every chromosome

let can

(i) be

=vie(w(eid)1e:it:h: er(if)rnoim),

::: the

sna)m) oercfhroromm\orsiogmhtet.oFlreoftm"

(i.e. this

as ? = (?
perspective

an

3:-:c:h?ro1m))osleoamdainl ggetnootmwoe

f (1); (2); (3)g is equivalent to f (1); ? (2); (3)g or f? (1); ? (2); ? (3)g, i.e. the directions

of chromosomes are irrelevant. The four most common elementary rearrangement events in multi-

chromosomal genomes are reversals, translocations, fusions and ssions as de ned below.

LjrLaeenttgmes==+th((1e.g11Ae::n::e:t:rsaiiin??ns11sliodiice:a::t:tih::oennjc)hjar(+on1m;d:o:;s:io=;mjn)()eeba1xne:cdh:a:atcrnhajg?rneo1ssmfogjore:msn:oe:sms embiean)tntwbodeeea1tnwchtowroicohmrcoohjsmrooommsneoo.m(soAe1ms:raee:snv:deri1?saa1nl?di(j

; i; j) rear: :n:+?1,i1j+1 and trans-

:

:

:

n).

faonrdm(sjt?he1m) +in(tno?chir+om1)osgoemneessr(es1p:e:c:tivie?l1y. jW: :e:demn)oatend (

1

:: as

:thje?g1enio:m: :e

no)btwaiitnhed(if?ro1m)

+

(m as

?
a

j + 1) result

of a rearrangement . Given genomes and ?, the genomic sorting problem is to nd a series of

rearrangements (reversals and translocations) We call t the genomic distance between and

?1;a:n: :d;

dtensuotceh

that it as

d(

; 1?).

t = ? and t is minimum.

We distinguish between internal reversals which do not involve ends of the chromosomes (i.e. the

reversals ( ; i; j) of a n-gene chromosome with 1 < i j < n) and pre x reversals involving ends of the

chromosomes (i.e. either i = 1 or j = n). Also note that a translocation ( ; ; n + 1; 1) concatenates

the chromosomes and This special translocation

resulting leading to

in a chromosome a reduction in the

n1u:m: :benr

o1f:(:n:onm-eamnpdtya)ncehmropmtyoscohmroems iossokmnoew;n.

in molecular biology as a fusion. The translocation ( ; ;; i; 1) for 1 < i n \breaks" a chromosome

into two chromosomes ( the number of (non-empty)

1c:h:r:omi?o1s)omanesd

( is

kin: o: w: nn)a.s

This translocation leading a ssion. A translocation

to an increase is internal if it

in is

neither a fusion, nor a ssion. Fusions and ssions are rather common in mammalian evolution. For

example, the only di erence in the overall genome organization of human and chimpanzee is the fusion

of chimpanzee chromosomes 12 and 13 into human chromosome 2.

Genome rearrangements provide a multitude of challenges for computer scientists; see Pevzner and Waterman, 1995 for a review of combinatorial problems motivated by genome rearrangements. Kececioglu and Sanko , 1993 suggested the rst approximation algorithm to analyze genome rearrangements in uni-chromosomal genomes (reversals only). The problem was further studied by Bafna and Pevzner, 1993, Kececioglu and Sanko , 1994, Kececioglu and Gus eld, 1994, Bafna and Pevzner, 1995a and Hannenhalli and Pevzner, 1995. See also Sanko et al.,1992, Bafna and Pevzner, 1995b and Hannenhalli et al., 1995 for biological applications, as well as Gates and Papadimitriou, 1979, Even and Goldreich,

1

1981, Jerrum, 1985, Aigner and West, 1987, Cohen and Blum, 1993, Heydari and Sudborough, 1993 for studies of related combinatorial problems. Kececioglu and Ravi, 1995 made the rst attempt to analyze rearrangements of multi-chromosomal genomes by devising an approximation algorithm for genomes evolving by internal reversals and internal translocations. Recently Hannenhalli, 1995 devised a polynomial algorithm for the case when only internal translocations are allowed. All these algorithms address the case when both genomes contain the same number of chromosomes. This is a serious limitation since di erent organisms (in particular human and mouse) have di erent numbers of chromosomes. From this perspective, every realistic model of genome rearrangements should include fusions and ssions. Moreover, despite some shortcomings (see the last section for a discussion on centromeres) the reversals/translocations/fusions/ ssions model adequately re ects the existing biological challenges (Joe Nadeau, personal communication). It turns out that fusions and ssions present a major di culty in analyzing genome rearrangements: the problem of devising an approximation algorithm for genome rearrangements with reversals/translocations/fusions/ ssions was raised by Kececioglu and Ravi, 1995. This paper presents an exact polynomial algorithm for this problem. Every analysis of rearrangements involves revealing \hidden obstacles" which prevent a \fast" transformation of one genome into another (like dual variables in linear programming). Sixty years ago Dobzhansky and Sturtevant, 1938 already used a notion of breakpoint, which is the most obvious example of such an obstacle. Based on this notion, Kececioglu and Sanko , 1994, devised a 2-approximation algorithm for uni-chromosomal genomes. However, an estimate of genomic distance in terms of breakpoints is very inaccurate. Bafna and Pevzner, 1993 revealed another obstacle (cycle decomposition) which signi cantly improves the bounds for genomic distance. Finally, Hannenhalli and Pevzner, 1995 found a duality theorem for uni-chromosomal genomes (reversals only) which expresses the genomic distance in terms of four parameters describing the combinatorial structure of permutations. In the case of multi-chromosomal genomes combinatorics of rearrangements becomes rather complicated. This paper presents the duality theorem for multi-chromosomal genomes which computes the genomic distance in terms of seven (!) parameters capturing di erent combinatorial properties of sets of strings. Our analysis of multi-chromosomal genomes extensively uses the duality theorem for uni-chromosomal genomes (Hannenhalli and Pevzner, 1995), which is stated in section 2. In section 3 we introduce an idea called ipping of chromosomes to analyze a relatively simple case of so-called co-tailed genomes (approximation algorithm for this case was proposed by Kececioglu and Ravi, 1995). In section 4 we introduce another idea called capping of chromosomes. In section 5, using cappings, we take the rst step towards a polynomial-time algorithm for genomic distance by proving a bound which is at most one rearrangement away from the genomic distance. This bound provides the intuition for a rather complicated potential function that leads to a polynomial-time algorithm and duality theorem for genomic sorting (section 6). Finally, in section 7 we present biological applications, formulate open problems, and discuss our result in relation to the recent experimental breakthrough in ZOO-FISH chromosome painting.

2 Cycles, hurdles and fortresses

In reversal distance problem, the order of genes in two (uni-chromosomal) genomes is represented by

(unsigned) permutations ments are reversals (i.e.

=( both

1 a2n:d: :

nc)onasnidst

of=a(si1ng2le: :c:hrno)maonsdomtheeaonndlythceongseidneerseddorenaortrahnagvee-

associated signs). Given (unsigned) permutations and , the reversal distance problem is to nd a

tshereiersevoefrrseavl edrissatlasnc1e;

be2;tw: :e:e;n

t

such and

th.atSortin1g

2by

retve=rsalsanisdttheispmroibnliemmumof

(Fig. 2a). We call t nding the reversal

distance, d( ), between and the identity permutation (12 : : :n).

Lpigreieartampjnhuda=tGnadt((ii+ob11)ny,:w:0ai:t=ghnr(a)inyb1+ee:dn:2ag:,evpoeneifrf)rtmbicyiuaetsaabdftrdeiojai0nn.k;gp(ooS1fi;en0te:ht=:eF:if;i0egl.eanimn2;6 dben)n.+tnis1L++gfa11.1.t=e;WTr: :nehw:+e;ejonb1aigrn.le.saWovDkeueperostnceiioacntlettlehsageirpaniapoaihjtrnioodiofnffjciojo?fnibsbsjyerajcean=uatkbei1pvlda.oegciEenek-lxtceetomgdelrnogearednpetidhasf

2

G( ; ) for two permutations and which is de ned as G( ; ) G( ?1) described earlier. A cycle in an edge-colored graph G is alternating if the colors of every two consecutive edges of this cycle are distinct. In the following, by cycles we mean alternating cycles.

Let ~ be a signed permutation of f1; : : :; ng, i.e. a permutation with 00+00 or 00?00 sign associated

with each element (Fig. 2c). In the signed case, every reversal of fragment i; j] changes both the

order and the signs of the elements within that fragment. We are interested in the minimum number

of reversals d(~) required to transform a signed permutation ~ into the identity signed permutation

(+1 + 2 : : : + n). De ne a transformation from a signed permutation ~ of order n to an (unsigned)

permutation of f1; : : :; 2ng as follows. To model the signs of elements in ~ replace the positive

elements +x by 2x ? 1; 2x and negative elements ?x by 2x; 2x ? 1 (Fig. 2c). We call the unsigned

permutation , the image of the signed permutation ~. In the breakpoint graph G( ), elements 2x?1

and 2x are joined by both black and gray edges for 1 x n. We de ne the breakpoint graph G(~) of

a signed permutation ~ as the breakpoint graph G( ) with these 2n edges excluded. Observe that in

G(~) every vertex has degree 2 (Fig. 2c) and therefore the breakpoint graph of a signed permutation is

a collection of disjoint cycles. Denote the number of such cycles as c(~). We observe that the identity

signed permutation of order n maps to the identity (unsigned) permutation of order 2n, and the e ect

of a reversal on ~ can be mimicked by a reversal on thus implying d(~) d( ). In the following, by

sorting the image reversals (2i + 1;

2j=) wh1ic2h:

:\:cu2tn"

of a only

signed permutation ~ = after even positions in

~ .

1~In2

:t:h:e~rne,swt eofmtehaisn

sorting section,

of

is

by an

image of a signed permutation.

We say reversal reversal

that reversal (i; j) acts on on a cycle if the black edges increases c( ) by at most 1,

black (i.ei.?, 1c;(

edi)g)ae?sndc(((i?)j1;;

1ji+)(1Ba) nabfdenlao(nagjn; dtojP+te1hv)ezinsnaemrG, e(1c9y)9.c3leW).ineAGcga(rlla)y.(eiEd;vgjee)ryga

is oriented if for a reversal acting on two black edges incident to g, c( ) ? c( ) = 1 and unoriented

otherwise. A cycle in G( ) is oriented if it has an oriented gray edge and unoriented otherwise. Gray

edges ( of them
g1 2 C1

aic;nodnjt)ga2ainn2sdCt(h2e.koS; tehet)eFri.nigC.G2y(cclf)eosarCreex1ianamntepdrlleCesa.2vianrge

if the intervals interleaving if

i; j] there

and k; t] overlap exist interleaving

but neither gray edges

Let C be the set of cycles in the breakpoint graph of a permutation . De ne an interleaving graph

H (C ; I )
The vertex

of set

with of H

the edge set I
is partitioned

in=tofo(rCie1n; Cte2d)

a: nCd 1uannodrieCn2teadreveinrttiecrelsea(vciyncglecsyicnleCs

in ).

g (Fig. 2d).
A connected

component of H is oriented if it has at least one oriented vertex and unoriented otherwise. In the

following we use the terms edge of , cycle in and component of instead of (more accurate) terms

sceeydtcgleoefsoifonftGeU(g.er)Fs,ocUryca=lesfeitin:oGf (iin2t)egCaenrd2s

cUogmrpeopnreesnetnotifnHg (the).seAt

connected component U corresponds to the of positions of the permutation belonging to

U de ne Umin = minu2U u and Umax = maxu2U u.

Let be a partial order on a set P. An element x 2 P is called a minimal element in if there is

no element y 2 P with y x. An element x 2 P is the greatest in if y x for every y 2 P and

jPj > 1. Let U ti herUemeixni;sUtsmuax2] component U in

be a collection of sets of integers. De ne a partial order on U by

U U

Wswumchhiinch;thWiasmt eaUixtm]0haefoxrra<Um;uWin<im2UamU0l0 i.nh.WurAedlsehauoyrrdtlhtehaetfogarrsetheateteUssett2huUUrdsilseepdwaerhanetreeesd

the sets

Uru0leanUd

U 00Wif

as an unoriented

a minimal hurdle

is a minimal element in and the greatest hurdle satis es the following two conditions (i) U is the

greatest element in and (ii) U does not separate any two sets in U. A hurdle K 2 U protects a

non-hurdle U 2 U if deleting K from U transforms U from a non-hurdle into a hurdle (i.e. U is a

hurdle in U n K). A hurdle in is a superhurdle if it protects a non-hurdle U 2 U.

De let

ne h(

a )

collection of sets of integers U =
be the overall number of hurdles

fU
for

t:heUcoisllaecntiuonnoUrien. tPedermcoumtaptoinoennt

of is

permutation g
called a fortress

and if it

has an odd number of hurdles and all these hurdles are superhurdles. De ne

f( ) =

1; if is a fortress 0; otherwise

For a signed permutation ~ with the image we de ne b(~) = b( ), c(~) = c( ), h(~) = h( ) and f(~) = f( ).

3

Theorem 1 (Hannenhalli and Pevzner, 1995) For a signed permutation ~ of order n, d(~) = b(~) ?
c(~) + h(~) + f(~).

3 Flipping the chromosomes

For the

daircehcrtoiomnosoofma echro=m(os1o:m:e:

dno)e,stnhoetncuhmanbgeerst+he

s1eatnodf

?
its

tnaialsr.e

called tails of . Note that changing Tails in a N-chromosomal genome

comprise the set T ( ) of 2N tails. In this section we consider co-tailed genomes and ? with T ( ) =

T (?). For co-tailed genomes internal reversals and translocations are su cient for genomic sorting, i.e.

pre x reversals, fusions and ssions can be ignored (the validity of this assumption will become clear

l(bfDaoyter(emp1re))n;.a+:d:icFn:oo;gnraco(nacnNhdtert)noth)ahmeiteneochsfaoouofmsigcieoeennsooafms(aea=1 :pi(:pe:rav1mnne:duc:?tt:aoartniotm)ihpna:evn:ree:d(c?estx)oirs==1ts)ss=(2b(N1y1()s:c(:o(1:1n?))c;ma:+t:).e::n;d:saeG:(nt+Nieovste)seno)(Nftwah)inethf(ofoNursrsd(e)iieoa)ronci2nhn(goPff?1oNiN:f=1:;1c!:+hnori1nrodgeme1loero:mnin:seo:gemnscmtaoesn)sf.

chromosomes in . If an order of chromosomes in a genome is xed we call an ordered genome.

In is

this section the identity

we assume w.l.o.g. permutation. We

that ? denote

= d(

(

)1;

:

::; d(

N; ?))isaannd

(ordered) genome call a problem of

and = genomic

s1o+rti:n:g:

+ of

N

into ? simply a sorting of a genome .

We use the following idea to analyze co-tailed genomes. Given a concatenate of a genome one

can optimally sort by reversals (Hannenhalli and Pevzner, 1995). Every reversal in this sorting

corresponds to a reversal or a translocation in a (not necessarily optimal) sorting of the genome .

For can

example, a translocation be alternatively viewed as

( a

; ; i; j) reversal

a(ctin?g

on ; i;

nch+ro(mmo?sojm+es1))=ac(tin1g:

:: on

n)?and(and=v(ice1

:v:e:rsam)).

De ne an optimal concatenate of as a concatenate with minimum reversal distance d( ) among

all concatenates of . Below we prove that sorting of an optimal concatenate of mimics an optimal

sorting of a genome . This approach reduces the problem of sorting to a problem of nding an

optimal concatenate of .

Let be a concatenate of = ( (1); : : :; (N)). Every tail of (i) corresponds to two vertices of of the breakpoint graph G( ), exactly one of which is a boundary (either leftmost or rightmost) vertex among the vertices of the chromosome (i) in the concatenate . We extend the term tail to denote such vertices in G( ). An edge in a breakpoint graph G( ) of a concatenate is interchromosomal if it connects vertices in di erent chromosomes of and intrachromosomal otherwise. A component of
is interchromosomal if it contains an interchromosomal edge and intrachromosomal otherwise.

ENve?ry1)inbteercthhreomnuomsobmeralobf lianctkerecdhgroeminosGom( a)l

connects two tails. black edges in G(

)L.etNbottaeil(tha)t(nfoorticceo-tthaialtedbtgaieln(om) e=s

tails in G( ) are adjacent to tails only and hence a cycle containing a tail contains only tails. Let

bc(tail)(

=)nb?e

the number N and b( )

of =

ncy?cl1es)

of G( and c(

) containing tails.
) = c( ) ? ctail(

De ).

ne b(

) = b(

) ? btail(

) (notice that

Consider the set of intrachromosomal unoriented components IU in . Hurdles, superhurdles and

fortresses for the set IU are called knots, superknots and fortresses-of-knots respectively. Let k( ) be

the number of knots in a concatenate of . De ne f( ) = 1 if is a fortress-of-knots and f( ) = 0

LoPterhmoeormwf iasAe1. mCFoloerraercilnoy,v-tobal(ivlee)dd,

c( ), k(
genomes version of

) and f( ) do not depend on the choice of a concatenate . and ?, d( ) b( ) ? c( ) + k( ) + f( ). the proof of theorem 1 from Hannenhalli and Pevzner, 1995.

Concatenates (s) and (s0) of an (ordered) genome are i-twins if the directions of all chromosomes

but ith one in (s) and (s0) coincide, i.e. s(i) = ?s0(i) and s(j) = s0(j) for j 6= i. A chromosome

(i) is properly ipped in (s) if all interchromosomal edges originating in this chromosome belong to

oriented components in (s). A concatenate is properly ipped if every chromosome in is properly

ipped. The following lemma proves the existence of a properly ipped concatenate.

Li-etwminma0

2
of

If

a chromosome (i) is not
. Moreover, every properly

properly ipped in ipped chromosome

= in

(s) then
remains

it is properly ipped properly ipped in

0i.n

the

4

Proof: Let g be an interchromosomal gray edge in originating in the chromosome (i) and
gbbinreetalceoyornmcgehedirnsgogemortooioesrnoigatmienndaalutiennindoggrei0eaanotntreidgdi(vniic)acoteimisnvpgedoriasntaee)nr.et(nSi)itinnacinned.ailnlNateeosdrtgleceeoastmvhiinpantatgerrtewlhdeieathtvooingrigeinn0wt(aiit.theiiso.gnorianoiefnnotaennad-yroeirniuinentneot0r.recidhenreotedmdgo,eseoivnmerayl

gAlilnint0e.rcShinrocme ogsoismoarlieendtgeeds Therefore, (i) is properly

ioinprpigei0dnaailtnlinsug0c.ihn

(i) which are not edges belong to an

ionrtieernlteeadvincogmwpitohnegntincon, tianitneirnlegavgeinwith0.

Let (j) be a properly ipped chromosome in . If (j) is not properly ipped in 0 then there exists

an(ji)nitnerch0.roImf oUsodmoaesl

unoriented component U having not have an edge originating at

a(ni)ininterc0htrhoemnosUomisaal ngruanyoerdiegneteodrigcoinmatpionngenatt

in , implying that (j) was not properly gray edge h originating at (i) then, clearly,

ipped in this edge

, a contradiction. does not interleave

If U with

has g in

an0.

(unoriented) Therefore h

interleaves with g in and h is oriented in thus implying that g belonged to an oriented component

in , a contradiction.

Lemma 2 implies f( ). Below we mimics a sorting

existence of a properly

show that of by b(

th) e?rec(exi)s+ts

a k(

ipped concatenate sorting of by b( ) + f( ) internal

)

?=

(s) with c( ) + h(

h( )+

)= f(

k( ) and f( ) = ) reversals which

reversals and translocations.

Theorem 2 For co-tailed genomes and ?, d( ; ?) d( ) = b( ) ? c( ) + k( ) + f( ).

Proof Assume the contrary and let be a genome with the minimum value of b( )?c( )+h( )+f( )
among the genomes for which the theorem fails. Let be a properly ipped concatenate of with
minimal value of btail( ) ? ctail( ) among all properly ipped concatenates of .

tIfhebrtaeile(xi)st=s acntaoilp(ti)m(ai.les.oretvienrgyoifntebrcyhbr(om)o?sco(ma)+l bkl(ack)+efd(ge)isreivnevroslavlesdwihnicahcaycctleonofinlternagcthhrotmwoo)sotmheanl

black edges (Hannenhalli and Pevzner, 1995). Every such reversal can be mimicked as an internal

reversal or an internal translocation on thus leading to sorting by b( ) ? c( ) + k( ) + f( )

internal reversals/translocations.

c( ) = c( sorting of

)

+byctba(il(

)

)?,

h( c(

) = k( ) + k(

Since is a properly ipped concatenate, b( ), f( ) = f( ). Therefore, optimal sorting of ) + f( ) internal reversals/translocations.

) = b( ) + mimics an

obtpatili(ma)l,

gIfrebatatielr(

)> than

ctwtaoil(an)dtthheins

there exists an edge belongs to

interchromosomal black edge involved in a cycle of length an oriented component in (since every interchromosomal

black edge belongs to an oriented component in a properly ipped concatenate). Hannenhalli and

Pevzner, 1995 proved that if there exists an oriented component in then there exists a reversal in

acting on the black edges of an oriented cycle in this component such that c( ) = c( )+1. Moreover,

this reversal does not create new unoriented components in and h( ) = h( ), f( ) = f( ). Note

that every cycle containing tails of chromosomes belongs to an oriented component in and consists

entirely from edges between tails. Therefore acts either on two intrachromosomal black edges or on

two interchromosomal black edges belonging to some oriented cycle of this component.

A reversal acting on two interchromosomal black edges can be interpreted as a transformation
ocmchtfairn0iaoli(=mmcooan)sli0oct(=amyst0ee)bosntfwaaabihtlnt(eaedirl)e(s?0o)=f(0?ci(tscasti(a=al1(il)n((;)e:w+):(.1:o;1)sr;)d(:ai:enr?:;idn1g()i;(??i(ss11(a)j);;)p:; ::r(:o:i;):p;;e:?(r:ils:y?(;i)1(i;p)js;p)(;je(d+j()jc1;o+:)n:;c::1;a:)t:;e;:(nsi:)(a:;N;te)(()ojN.f+T))1h,)iena;rt:eco:foo:a;nret,cr(aoNbdntaic)ci)alt(tioeofnnt)ahtt?oee
If reversal acts on two intrachromosomal black edges then is a properly ipped concatenate of implying that

(b(

)

?

b( ) ? btail(

c( ))

) + k( ? (c(

)

) + f( ?1?

)= ctail(

(b()))+?hb(tail)(

)) ? + f(

(c( )

) =

? b(

cta)il?(

)) c(

+

h( )+

)+ h(

f

( )

)= +f

(

)+1

Since b( )? c( )+ k( ) + f( ) > b( . Therefore d( ) d( ) + 1 = b(

))??cc((

)+ h( ) + f( ) + k( ) + f( )

), the theorem holds for the genome

5

4 Capping the chromosomes

We now turn to the general case when genomes and ? might have di erent sets of tails and di erent number of chromosomes. Below we describe an algorithm for computing d( ; ?) which is polynomial in the number of genes but exponential in the number of chromosomes. This algorithm provides an intuition for the (truly) polynomial-time algorithm which is described in the following sections.

Let and ? be two genomes with M and N chromosomes respectively. W.l.o.g. assume that

M N and extend by N ? M empty chromosomes. As a result = f (1); : : :; (N)g and

? = f (1); : 2N distinct

: :; (N)g contain the same number
positive integers (called caps) which

oafrechdriomeroensotmfreosm. Lgeetnefscaopf0;

:::; (or

ceaqpu2iNva?le1ngtblye,

a set of ?). Let

^ = f^(1); : : :; ^(N)g be a genome obtained from by adding caps to the ends of each chromosome,

i.e. ^(i) = cap2(i?1); sponds to an internal

(rie)v1e; r:s:a:l;/t(ria)nnsil;occaapt2i(oin?1i)n+1.^

Note that every reversal/translocation in corre. If this translocation is a ssion we assume that

there are enough empty chromosomes in (the validity of this assumption will become clear later).

Every sorting of into ? induces a sorting of ^ into a genome ?^ = f^(1); : : :; ^(N)g (called capping
o?c?i^naf.ap?trpTh)eie,hncwegnouh-fdtomeaerllibeolenew^dre(idnois)gifbn=gycleeem(nt(The?mse(1ab^d)ui)jlstect=aaredpixbTjspu;(ott^?^oin(o)iena)=n1nt;oiS:aaf:ll2i2g=:NiN;on0?^ri1t(tchi(ha)?empm1sni);ufoio(cmf?rabp^1cei)o.rkimn+Top1f?h^cucea.thrpienDrkog)eemxnfgoiooesrtstneo0o(mm2thNeiescj);Ns!dkedit.sitoaef2nrN(ce2enN?twc)1ha!.ipccGphapienipnsgiosnpmgooselfys?onf^,ome?aanicaahdsl

Lemma 3 d( ; ?) = min?^2? b( ^ ; ?^) ? c( ^; ?^) + k( ^ ; ?^) + f( ^; ?^)
Proof Follows from theorem 2 and an observation that every sorting of ^ into a genome ?^ 2 ? by
internal reversals/translocations induces a sorting of into ?.

Let ^ and ^ be arbitrary obtained from G(^; ^) by

concatenates of deleting all tails

(ordered) (vertices

cappings ^ of G(^; ^))

oafngden?^o.meLe^t

G( ^ (or

e; q?^u)ivbaeleantlgyr,ap?^h)

from G(^; ^). Di erent cappings ?^ correspond to di erent graphs G(^; ?^). Graph G(^; ?^) has 2N

v?^e.rtTicheesrecfoorrree,sdpeolnedtiinngg

to caps, these 2N

gray gray

edges edges

incident on transforms

Gth(e^s;e?^v)eirntticoesa

completely graph G(

de ; ?)

ne the capping which does not

depend on capping ?^ (Fig. 3a,b,c,d).

Graph G( ; ?) contains 2N vertices of degree 1 corresponding to 2N caps of (called -caps) and 2N vertices of degree 1 corresponding to 2N tails of ? (called ?-tails). Therefore, G( ; ?) is a collection of cycles and 2N paths, each path starting and ending with a black edge. A path is a -path (??-path) if it starts and ends with -caps (?-tails) and a ?-path if it starts with a -cap and ends with a ?-tail. A vertex in G( ; ?) is a ?-vertex if it is a -cap in a ?-path and a -vertex if it is a -cap in a -path. ? - and ??-vertices are de ned similarly (see Fig. 3d).

Every capping ?^ corresponds to adding 2N gray edges to the graph G( ; ?), each edge joining a -cap with a ?-tail. These edges transform G( ; ?) into the graph G(^; ?^) corresponding to a capping ?^ (Fig. 3e).

De and

ne b( paths

; ?) as in G(

the number of black edges ; ?). The parameter b( ;

in ?)

G( =

; b(

^?;)?^a)nddoce(s

; ?) not

daseptehnedoovneraclalpnpuinmgbe?^r.

of cycles Clearly

c(^; ?^) c( ; ?) with c(^; ?^) = c( ; An observation that every cycle in G(

?^); ?^if)ecvoenrtyaipnaitnhg

in a

G(

; ?) is \closed" by a gray -path contains at least one

edge in G( more path

^; ?^). leads

to an inequality c(^; ?^) c( ; ?)?p( ; ?), where p( ; ?) is the number of -paths (or equivalently,

??-paths) in G( ; ?).

We de ne the notions of interleaving cycles/paths, oriented and unoriented components, etc. in the

graph G( ; ?) in a usual way (see Appendix) by making no distinction between cycles and paths in

G( mal

; ?). We say that a vertex component for genomes

ajnids

inside a component U of if ? is called a real component

j if

2
it

hUamsinn;eUitmheaxr].a

An intrachromoso-cap nor a ?-tail

inside.

6

FtifHnohoutrerrtrradsgecelsehetsnsreo,oosfmms-uokeofpns-seororetmhasula-(arlkind.necdlo.oetsm?sh.aupdnrLodednelteefnnsoRetrfsKtoRrr(eabUstsseh(eesdth;esfe?eotnr)seeItadthUseo(btfyshre;eett?ahsR)l-ee)kt.Ung(Aooraftsp;kr?hne(ai)o.Gleta.(cfrroheomu;mcr?apd)lotll)eenh.sdeenfCrsoteerslatetlaa-KhrknelnydnosetRRIstU,KURs((uUips;(;e?a?r)-;)sr?eeaam)s)l-itkaI-hknnUenod(otsstKe;tiaf?nboi)detf.
does not contain a - or ??-vertex inside. Clearly, every semi-knot contains a ?-path (otherwise, it would be a real-knot). Denote the number of real-knots and semi-knots for genomes and ? as r( ; ?) and s( ; ?), respectively. Clearly k(^; ?^) r( ; ?) implying that
b( ^ ; ?^) ? c( ^; ?^) + k( ^ ; ?^) b( ; ?) ? c( ; ?) + p( ; ?) + r( ; ?) However, this bound is not tight since it assumes that there exists a capping ?^ which simultaneously
maximizes c(^; ?^) and minimizes k(^; ?^). Taking s( ; ?) into account leads to a better bound for genomic distance which is at most 1 rearrangement apart from the genomic distance (next section).

5 Caps and tails

Genomes and ? are correlated if all the real-knots in G( ; ?) are located on the same chromosome and non-correlated otherwise. In this section we restrict our analysis to non-correlated genomes (it turns out that the analysis of correlated genomes involves some additional technical di culties) and prove a tight bound for d( ; ?) (this bound provides an intuition for a rather complicated potential function used in the proof of the duality theorem):

b(

; ?) ? c(

; ?) + p(

; ?) + r(

;

?)

+

d s(

;
2

?) e

d( ; ?)

b(

; ?) ? c(

; ?) + p(

; ?) + r(

;

?)

+

d s(

;
2

?) e

+

1

The following lemmas suggest a way to connect some paths in G( ; ?) by oriented edges.

Lemma 4 For every -path and ??-path in G( ; ?) there exists either an interchromosomal or an

oriented gray edge which joins these paths into a ?-path.

Lemma 5 For every two unoriented ?-paths located on the same chromosome there exists an ori-
ented gray edge which joins these paths into a ?-path.

In a search for an optimal capping we rst ignore the term f(^; ?^) in lemma 3 and nd a capping whose genomic distance d(^; ?^) is within 1 from the optimal. The following theorem suggests a way to nd such an \almost optimal" capping ?^.

Theorem 3

min?^2? b(^; ?^) ? c(^; ?^) + k(^; ?^) = b(

; ?) ? c(

; ?) + p(

; ?) + r(

;

?)

+

d

s(

;?)
2

e.

Pibgg.irrxeriaa.=eoyp=daohbedif((ddcGGwgiiEn0eei?)vsg=,iepgtracoinyiG?ogG=cr(rarea(picy;i(?pn?;Geid?nd)die.g)g)sx2:,ieF?e^Gpido),idr(o?i=e.eaes(;.cnp?pnide(?a)oGser1t=naai?o)imn,tGtprceera0riti?ene!ga=r1s1sf=?oerGr(trmd1Ghie?ia!egi,1)t2npei?oa:etancn:rd.:daosgm!if22?sNGiei1te=aG(e)sr.2sN;cB(?(iGe=)?lio;i)nGw?ta)i(or?w?^e1Ge;,dp?^(pei()^.re:o;n.;Fv?^e?eo)d)rtbc?hiayina=grtctr(ohancepisi;hes??ac)Gumc0?tiiei?vftdo1weh,rsleay(e1y2pta;?caad.)rsdeaiD.ifmnoeFgreno2t2toreNhNtraees,

Depending on the edge are non-correlated):

gi

the

following

cases

are

possible

(the

analysis

below

assumes

that

and ?

C?a-spea1th:)e. dIfgethgisi

\closes"
vertex is

a
the

o?n-lpyath?-(vi.eer.tegxi

connects a ?-vertex in a semi-knot, then

with a ? c = 0;

-vertex within the same
p = 0; r = 1; s = ?1

(note that this might not be true for correlated genomes). Otherwise c = 0; p = 0; r = 0; s = 0.

In both cases 0.

C\daessetro2y:s"edagt emgoistctownonseecmtsi-kanot?s-avnedrtexc

with
= ?1;

a

? -vertex
p = 0; r =

in
0;

a di erent ?-path.
s ?2. Therefore

This 0.

edge

7

CThaissee3d:geed\gdeesgtriocyos"nnaetcmtsoast

?-vertex with a ??-vertex (or a
one semi-knot and c = ?1; p =

? 0;

-vertex
r = 0;

with a
s > ?2.

-vertex).
It implies

0.

Case 4: edge
semi-knots and

gci

connects a
= ?1; p = ?1;

-vertex with a ??-vertex. This
r = 0; s 0. It implies 0.

edge

can

not destroy any

Note that Therefore

bb(2^N;

= ?^)

b(^; ?^) = b( ? c(^; ?^) + k(

b( ; ?) ? c( ; ?) + p( ; ?) + r(

; ?) = ^; ?^) = ; ?) + d

b0, c2N =

b2N ? c2N

s(

;?)
2

e.

c(^; ?^), + p2N +

p2N = r2N + d

0,
s22N

s2N e

= 0 and r2N b0 ? c0 + p0 +

= k( r0 + d

^; ?^). s20 e =

We now prove that there exists a capping ?^ such that b(^; ?^) ? c(^; ?^) + k(^; ?^) = b( ; ?) ? c( ; ?) +

p( ; with

?) + r( ?-tails

; ?)+ in G(

d;s?( )2;?su)echbythcaotnstriu=ct0infgoar

sequence all 1 i

of 2N 2N .

gray

edges

g1;

:

:

:;

g2N

connecting

-caps

eAix?sissu1tsmeadengteihnsattetortchGher(omr;so?ts)o.im?Ifa1lGosir?uo1crhiheaendstgeadesgarar-eypeaadltrhgeeatdjhoyeinnfioniutgnhtdahseasnaed?pla?et-thpsGatiinh?t1oasbaenweothlrlieeanrntedes,dulbty?olf-epmaadmtdhai.nCg4 lttehhaeerrslyee

c = ?1, p = ?1, r = 0, s = 0 for this edge, implying = 0.

IsbfeomGthii-?ks1enmohtais-s.kanItfotlves1.asaTtnhdtwevro2efsaoerrmee ii-nkcndo=i tse?r(ei1.n;et.
the same chromosome then by lemma 5

ctsphhi?re=or1me>0eo;xs1oi)srmtlse=etsanv0o1;foarnisedtn=htvee2n?db2tgehraeaanygdrea?dyg- eea=dnjogd0ie.nagiIni?fg=vt1-h(vvaee1snr;etdvep2xv)a2it\nhbdsdeelisiontntreoogryeanstn"ot

oriented ?-path. This gray edge destroys two semi-knots. Therefore = 0 in this case also.

sIfemG=ii-?0k1.nohOtatshthethrewne iosfoen,rlyasncem=edi-g0ke;ngopit,\=lcelt0o;sPin1rgb"=e ta0h;is

?-path in this semi-knot. If it path, c = 0; p = 0; r = s = 0 implying that = 0.

is 1;

the s

=on?ly1

?-path in the implying that

IbiTnf(h^GGe;ri?^i?e?f)1o1?.rhea,cSs(ti^nhnc;eeei?^tc)hgoe+inrsdktaor(ue^sc;t?n^e-do)pt=astebhqbe(,uloennn;og?cre)ta?oosfeacem(dsige-;mke?sni)-ogk+t1n;tpo:h(t:e,:n;;g?l2ce)Nt+=gtirr0a(b;nes;fa?ponr)=m+eds0dgG;se((c2r;l?o;)s=?ein). g0in;atnosaG=r(b^i0t;r?a^ar)nydsuc?h-p=tahta0ht.

Since 0 is within

f( ; ?) 1, lemma 3 and theorem 3 imply that b( one rearrangement from the genomic distance d(

; ?)?c( ; ?) for

; ?)+p( ; ?)+r( ; ?)+d
non-correlated genomes.

sI(n2;t?h)ee

following section we close the gap between b( for arbitrary genomes.

; ?) ? c(

; ?) + p(

; ?) + r(

;

?)

+

d

s(

;?)
2

e

and

d(

; ?)

6 Duality theorem for genomic distance

The major di culty in d( ; ?) is to \uncover"

closing the gap between b( ; ?) ? c(
remaining \obstacles" in the duality

; ?) + p( theorem.

I;t?t)u+rnrs(ou;t?t)h+atdtsh( e2;?d)ueaalintyd

theorem involves 7 (!) parameters, thus making it very hard to explain an intuition behind it. Theorem

3 provides such an intuition for the rst ve parameters. Two more parameters are de ned below.

A component in G( ; ?) containing a ?-path is simple if it is not a semi-knot.

Lemma 6 There exists an optimal capping ?^ which closes all ?-paths in simple components.

Let G be a graph obtained from G( ; ?) by closing all ?-paths in simple components. Without a confusion we can use the terms real-knots, super-real-knots and fortress-of-real-knots in G and de ne rr( ; ?) as the number of real-knots in G. Note that rr( ; ?) does not necessarily coincide with r( ; ?). Correlated genomes and ? form a weak-fortress-of-real-knots if (i) they have an odd number of real-knots in G , (ii) one of the real-knots is the greatest real-knot in G, (iii) every real-knot but the

8

greatest one is a super-real-knot in G and (iv) s( ; ?) > 0. Notice that a weak-fortress-of-real-knots can be transformed into fortress-of-real-knots by closing ?-paths contained in one of the semi-knots. De ne two more parameters as follows:

fr( ; ?) =

1; 0;

oiftherawnidse? form a fortress-of-real-knots or a weak-fortress-of-real-knots in G

gr( ; ?) =

1; if there exists the greatest real-knot in G and s( ; ?) > 0 0; otherwise

The following duality theorem proves that the algorithm Genomic Sort (Fig. 4) solves the genomic sorting problem. The running time of Genomic Sort (dominated by the running time of sorting signed permutations by reversals3 ) is O(n4), where n is the overall number of genes (Hannenhalli and Pevzner, 1995).

Theorem 4

d(

; ?) = b(

; ?) ? c(

; ?) + p(

; ?) + rr(

; ?) + ds(

;?)?gr( ;?)+fr(
2

;?) e

Proof Let t be the number of ?-paths in simple components of G( ; ?) and let ?^ be an optimal

capping which closes all these ?-paths in simple components (lemma 6). Similar to the proof of the

theorem 3 we consider a transformation of G( ; ?) into G(^; ?^) de ned by 2N gray edges: G( ; ?) =

Gtr0an!gs1forGm1a!tgi2on:

: : !gt
close

G?t -=paGthsg!ti+n1si:m: :plg!e2NcoGm2pNon=enGts(.^;

?^)

and

assume

that

the

rst t edges in this

fTohri e=t +p(ac1ria?mpieit?err2siN?bi.d; csFiio?; rpgira2;i+rif;xrgieerd)i

i?awn(cdei?ifg1rn?iorpaeir?ei1nd?deerxin?ie1,d?i.eidn.sidt?eh1n?eogstraei?2m1+ef=wri?ay1ie,)a.estBcin.elotwhewteheporroevme th3.at

Denote i0

Depending on the edge gi the following cases are possible:
ckCitasIfsfheonnrgaegtnegdio?hrrssrttgeei1sshi=dr=ieao=i=e1na>tnr?:0tl0Gi0e,t1yn0wes.ti.ttr?dhtoheIhTh1fgefaesinunerhl(sfu-riekrbfdcgerni-aailie?cfteosnf1ah?)ceroty.selr=1)ieGorenSssaiii:g1e0enmGrd,riesgcsiaipgGer?,lnealaoiy1asidc?=giifa=nco1i>togr?1etftn0ord-r0ttaaprehr,onmonsaaarS0sndsdtts.-fghoiiotgcasrfhrtr-imnePir?fiooeo1s=s.nartatlS=mIat-r00fkoe..siens1tnSes.hIocItm-ffhtioobsIsgirffge--torpakirrhgmnineanier?ga=tdooihl1?gts-tfrk1o1h(=iernmssea=tiiohnttge1=tehecr0sasneeett1soahtS.otrthSerhneeneTa.isealsnythrlMwn-erekoeecroenaaetc?rxo=fkleao--i=to-spkrfhtv0niaoesn0eu;tror;rhtttG,drhfreiplieinepnsir.?s=giG=-=I1anrotei>f0sI00a-i(e;mr;tUsm0eieempa)sesir,lltr-pi-itkanek=rlh=nsycenceeoiaootn0t1ldhtno-g;;sekattS.rhntanOesotsadrihtnltw=i=leciieonintr0sni??ec.eowaGano11ISlne-ffi.,,

If the path P is the only ?-path in a simple component then after closing the path P, either gr = 0 (in this case c = 0; p = 0; r = 0; s = 0, fr 0) or gr = 1 (in this case c = 0; p = 0; r = 1; s = 0, fr ?1). In both cases 0. If the path P is not the only ?-path in its component then closing P does not destroy any semi-knots. Therefore, c = 0; p = 0; r = 0; s = 0, gr = 0 and fr = 0, implying = 0.

C\daessetro2y:s"edagtemgoistcotnwnoescetms ia-kno?t-sv. erIfteitx

with a
destroys

? -vertex in
less than two

a di erent ?-path.
semi-knots then c =

This
?1;

edge p=

0; r = 0; s ?1. Since gr 0 and fr ?1, 0. If it does destroy two semi-knots, c =

?1; p = 0; r = 0; s = ?2. Clearly gr 0 in this case. If gr = ?1 then s ? gr+ fr ?2

and

gfrrii

= =

0. If gr = 0 and fr 0 then 0. If gr 00.aIntdimpglrie=s t?ha1t, Ga ic?o1ntisraadwicetaiokn-f.ortress-of-real-knots

= 0 and and si?1

=

fr = ?1 2; si = 0.

Ittheimn pflireis?1gr=i?11

and = 1,

CThaissee3d:gee\ddgeestgrioycso"nantemctossta

?-vertex with a
one semi-knots and

??c -=ve?rt1e; x

(or
p=

a
0;

?

-vertex
r = 0; s

with a -vertex).
?1. Since gr 0

and fr ?1, 0.

3Recently Berman and Hannenhalli further improved the running time for sorting signed permutations by reversals

9

Case
knots

a4n:dedgce=gi?c1o; nnpe=ct?s 1a;

-vertex with a ??-vertex. This edge can not destroy any semi-
r = 0; s 0, gr 0, fr 0. Note that if gr = 1 then both

Gi?1 and Gi have the greatest real-knots, si?1 = 0 and si = 1. It implies s = 1 and 0.

Note that and fr2N grt = gr(

b2N =f ; ?)

= b(^; (^; ?^). and frt

?^) = b( Also bt = fr( ;

; ?), c2N = c(^; ?^), p2N = 0, r2N =

= b( ; ?), ct ?). Therefore

= c( for an

;o?p)t,impat l=capp(pin;g?)?^,

k( rt :

^; =

?^), s2N = rr( ; ?),

0, st

gr2N = s(

=0 ; ?),

d(^; ?^) bt ? ct

= +

b( pt

^; ?^) ? c( + rt + dst

^; ?^) + k(^

?grt+f
2

rt

e

=

; ?^) b(

+ f(^ ; ?) ?

; ?^) c(

= b(^; ?^) ; ?) + p(

? c2N ; ?) +

r+r(p2;N?+) +r2dNs(+;?d)s?2Ngr?(g2r;?22N)++ffrr(2N;?e)

e

We now prove that there exists a capping ?^

r?set-qt?auiedlnsscti?engorG2tf+efsdrugtceehsbityshasbhtuoiwldinin=ign

a sequence of 0 for all t + 1 Fig. 4.

such that c2N ? p2N ? r2N 2N ? t gray edges gt+1; : :

:?; gd2sN2Nc?ognr2n2Ne+ctfirn2Ng

i 2N. The algorithm Genomic Sort

e = ct ?
-caps building

pt ?
with this

Closing a ?-path inside a component having more than one ?-path inside it (line 3) does not a ect any of the parameters and hence = 0 for the gray edge closing such a path.

Connecting a -path with a ??-path via an interchromosomal or oriented edge (line 6) a ects only
two parameters ( c = ?1, p = ?1) and = 0.

When and

snu=m?be2r.

of semi-knots is greater than 2, for an Other parameters do not change and

edge \destroying" hence, = 0.

2

semi-knots

(line

8),

c = ?1

When number of semi-knots semi-knots (line 11), c =

is 2 r=

anpd=gr0i?a1nd=

afnri?ed1g=e

\fdreis, throenyicneg"

fr = 0. the two

Thus = semi-knots

0. If (line

1 then for the edge closing the ?-path in one of the
1t3hs)e=, nu?cm1=.beC?rl1eoafarnslyed,mgir-ksin==ot0?s 2his.en2Octeahnedrggprra=ir?a1?m=1e.te0Mrstohdreoenonvfooetrr

change, hence, = 0.

For s
f ri

the edge closing the
= ?1, gr = ?1,
= 0. It can be veri

?-path in the only semi-knot (line 15),

fr ed

= 0, that

hence =0

= 0. in this

Else if case.

gri?1

=

0,

if c

g=ri?1p=,

1 then r = 1,

c= p= s = ?1,

r = 0, gr = 0,

Closing any other ?-path (line 17) doesn't a ect any parameters and hence = 0.

7 Applications and Open Problems
To derive human and mouse gene orders we used comparative mapping data from the Mouse Genome Database (Jackson Laboratory). Deriving gene orders is a non-trivial task since the map accuracy in human is signi cantly lower than in mouse (mice are much easier to breed!) and for some closely located genes in human the relative ordering is still unknown. Moreover, despite the fact that the average number of genes in a human-mouse \conserved block" is about 10, some of the blocks consist of a single gene thus making it impossible to infer a sign of these blocks. These problems forced us to make a number of arbitrary decisions while deriving the order of synteny groups in human and mouse. The rapid progress in human-mouse comparative mapping leaves no doubt that in a few years the complete and unambiguous information about human-mouse synteny groups will be obtained. Centromeres represent another di culty in analyzing chromosomal rearrangements. We have chosen to ignore the positions of centromeres since the molecular structure and evolution of centromeres are very poorly understood. In particular it is unclear whether a transformation of an inactive centromere into an active one and vice versa is a frequent evolutionary event. From this perspective, ignoring centromeres might be the most reasonable approach at the moment. We also ignore transpositions since they are extremely rare in chromosome evolution.
10

Under all these limitations we derived a human-mouse gene order consisting of 138 conserved gene blocks. For this (tentative) gene order, a most parsimonious scenario of human-mouse evolution involves 131 reversals/translocations/fusions/ ssions, thus \improving" the Nadeau and Taylor, 1984 and more recent Copeland et al., 1993 estimates. Note that our estimate is constructive unlike all the previous estimates. At the same time this estimate should be taken with caution until a more reliable gene order is produced by experts in human-mouse comparative mapping. Of course, gene orders for just two genomes are hardly su cient to delineate a correct rearrangement scenario. Comparative gene mapping has made possible the generation of comparative maps for 28 species representing di erent mammalian orders (O'Brien and Graves, 1991). However, the resolution of these maps is signi cantly lower than the resolution of the human-mouse map. Since conventional comparative physical mapping is very laborious and time consuming, one can hardly expect that the tremendous e orts involved in obtaining the human-mouse map will be repeated for other mammalian genomes. However, a newly developed experimental technique called chromosome painting allows one to derive gene order without actually building an accurate \gene-based" map! In past, applications of chromosome painting were limited to primates (Jauch et al., 1992), and attempts to extend this approach to other mammals were not successful because of DNA sequence diversity between distantly related species. Very recently, an improved version of chromosome painting, called ZOO-FISH that is capable of detecting homologous chromosome fragments in distant mammalian species was developed (Scherthan et al., 1994). In April, 1995 Rettenberger et al., reported successful completion of the human-pig chromosome painting project. In a relatively inexpensive experiment Rettenberger et al., 1995 identi ed 47 conserved blocks common to human and pigs and used these data for analyzing human-pig evolution. The success of the human-pig chromosome painting project indicates that gene orders of many mammalian species can be generated with ZOO-FISH inexpensively. This provides an invaluable new source of data to attack a 100-years old problem of mammalian evolution with a new constructive approach versus previous ones based on the statistics of point mutations. This paper makes the rst step in this direction but the problem of analyzing genome rearrangements in multiple genomes remains open.
8 Acknowledgments
We are indebted to Joe Nadeau for many helpful insights on biology of genome rearrangements and comparative human-mouse physical mapping. We are also grateful to Vineet Bafna and Webb Miller for many helpful comments and Jannan Eppig for her help with the Mouse Genome Database.
References
1] M. Aigner and D. B. West. Sorting by insertion of leading element. Journal of Combinatorial Theory, 45:306{309, 1987.
2] V. Bafna and P. Pevzner. Genome rearrangements and sorting by reversals. In 34th Annual IEEE Symposium on Foundations of Computer Science, pages 148{157, 1993. (to appear in SIAM J. Computing).
3] V. Bafna and P. Pevzner. Sorting by reversals: Genome rearrangements in plant organelles and evolutionary history of X chromosome. Molecular Biology and Evolution, 12:239{246, 1995a.
4] V. Bafna and P. Pevzner. Sorting by transpositions. In Proc. 6th Annual ACM-SIAM Symposium on Discrete Algorithms, pages 614{623, 1995b.
5] D. Cohen and M. Blum. Improved bounds for sorting pancakes under a conjecture. 1993 (manuscript). 6] N. G. Copeland, N. A. Jenkins, D. J. Gilbert, J. T. Eppig, L. J. Maltals, J. C. Miller, W. F. Dietrich, A. Weaver,
S. E. Lincoln, R. G. Steen, L. D. Steen, J. H. Nadeau, and E. S. Lander. A genetic linkage map of the mouse: Current applications and future prospects. Science, 262:57{65, 1993. 7] T. Dobzhansky and A.H.Sturtevant. Inversions in the chromosomes of drosophila pseudoobscura. Genetics, 23:28{64, 1938. 8] S. Even and O. Goldreich. The minimum-length generator sequence problem is NP-hard. Journal of Algorithms, 2:311{313, 1981. 9] W. H. Gates and C. H. Papadimitriou. Bounds for sorting by pre x reversals. Discrete Mathematics, 27:47{57, 1979.
11

10] S. Hannenhalli. Polynomial algorithm for computing translocation distance between genomes. In Combinatorial Pattern Matching, Proc. 6th Annual Symposium (CPM'95), Lecture Notes in Computer Science, pages 162{176. Springer-Verlag, Berlin, 1995.
11] S. Hannenhalli, C. Chappey, E. Koonin, and P. Pevzner. Genome sequence comparison and scenarios for gene rearrangements: A test case. In Genomics, 1995. (to appear).
12] S. Hannenhalli and P. Pevzner. Transforming cabbage into turnip (polynomial algorithm for sorting signed permutations by reversals). In Proc. 27th Annual ACM Symposium on the Theory of Computing, pages 178{189, 1995a.
13] M. Heydari and I. H. Sudborough. On sorting by pre x reversals and the diameter of pancake networks. 1993 (manuscript).
14] A. Jauch, J. Wienberg, Stanyon, N. Arnold, S. Tofanelli, T. Ishida, and T. Cremer. Reconstruction of genomic rearrangements in great apes gibbons by chromosome painting. Proc. Natl. Acad. Sci., 89:8611{8615, 1992.
15] M. Jerrum. The complexity of nding minimum-length generator sequences. Theoretical Computer Science, 36:265{ 289, 1985.
16] J. Kececioglu and D. Gus eld. Reconstructing a history of recombinations from a set of sequences. In 5th Annual ACM-SIAM Symp. on Discrete Algorithms, pages 471{480, 1994.
17] J. Kececioglu and R. Ravi. Of mice and men: Evolutionary distances between genomes under translocation. In Proc. 6th Annual ACM-SIAM Symposium on Discrete Algorithms, pages 604{613, 1995.
18] J. Kececioglu and D. Sanko . Exact and approximation algorithms for the inversion distance between two permutations. In Combinatorial Pattern Matching, Proc. 4th Annual Symposium (CPM'93), volume 684 of Lecture Notes in Computer Science, pages 87{105. Springer-Verlag, Berlin, 1993. (Extended version has appeared in Algorithmica, 13: 180-210, 1995.).
19] J. Kececioglu and D. Sanko . E cient bounds for oriented chromosome inversion distance. In Combinatorial Pattern Matching, Proc. 5th Annual Symposium (CPM'94), volume 807 of Lecture Notes in Computer Science 807, pages 307{325. Springer-Verlag, Berlin, 1994.
20] J. H. Nadeau and B. A. Taylor. Lengths of chromosomal segments conserved since divergence of man and mouse. Proc. Natl. Acad. Sci. USA, 81:814{818, 1984.
21] S. O'Brien and J. Graves. Report of the committee on comparative gene mapping in mammals. Cytogenet. Cell Genet., 58:1124{1151, 1991.
22] P.A. Pevzner and M.S. Waterman. Open combinatorial problems in computational molecular biology. In 3rd Israel Symposium on Theory of Computing and Systems, pages 158{163. IEEE Computer Society Press, 1995.
23] G. Rettenberger, C. Klett, U. Zechner, J. Kunz, W. Vogel, and H. Hameister. Visualization of the conservation of synteny between humans and pigs by hetereologous chromosomal painting. Genomics, 26:372{378, 1995.
24] D. Sanko , G. Leduc, N. Antoine, B. Paquin, B. F. Lang, and R. Cedergren. Gene order comparisons for phylogenetic inference: Evolution of the mitochondrial genome. Proc. Natl. Acad. Sci. USA, 89:6575{6579, 1992.
25] H. Scherthan, T. Cremer, U. Arnason, H. Weier, A. Lima de Faria, and L. Fronicke. Comparative chromosomal painting discloses homologous segments in distantly related mammals. Nature Genetics, 6:342{347, April 1994.
12

Π
+1+2+3+4
+5+6+7+8
+9+10+11

reversal

-3-2-1+4 +5+6+7+8 +9+10+11

translocation

-3-2-1+4 +5+6+7+11 +9+10+8

fusion

-3-2-1+4+5+6+7+11 +9+10+8

fission

Γ
-3-2-1+4+5+6+7+11 +9
+10+8

Figure 1: Evolution of genome into genome ?

3 5 8 6 4 7 9 2 1 10 11
3 5 4 6 8 7 9 2 1 10 11
3 4 5 6 8 7 9 2 1 10 11
(a)
3 4 5 6 7 8 9 2 1 10 11
9 8 7 6 5 4 3 2 1 10 11
1 2 3 4 5 6 7 8 9 10 11
black edge gray edge

(b)
0 3 5 8 6 4 7 9 2 1 10 11 12
A

(c)
0

B

56
+3

10 9
-5

15 16 12 11
+8 -6

C
78
+4

D
14 13 17 18
-7 +9

34
+2

EF

12
+1

19 20 22 21 23
+10 -11

B
(d)

F D AE
C
non-oriented cycle oriented cycle

Figure 2: (a) Optimal sorting of a permutation = (3 5 8 6 4 7 9 2 1 10 11) by 5 reversals. (b) Breakpoint graph G( ). (c) Transformation of a signed permutation into an unsigned permutation
and the breakpoint graph G( ). Gray edges (8; 9) and (22; 23) are oriented while gray edges (4; 5) and (18; 19) are unoriented. Cycles C and F are oriented while cycles A; B; D and E are unoriented. Gray edges (6; 7) and (12; 13) are interleaving while gray edges (6; 7) and (4; 5) are non-interleaving. (d) Interleaving graph H with two oriented and one unoriented component.

13

Genomes Π: (-3-2)(-1+4+5+6+7+12)(+10+9+11+8) Γ: (+1+2+3+4)(+5+6+7+8)(+9+10+11+12)

Cappings Π^: (+13-3-2+14)(+15-1+4+5+6+7+12+16)(+17+10+9+11+8+18) Γ^: (+13+1+2+3+4+14)(+15+5+6+7+8+16)(+17+9+10+11+12+18)
(a)

Concatenates ^π: +13-3-2+14+15-1+4+5+6+7+12+16+17+10+9+11+8+18 ^γ: +13+1+2+3+4+14+15+5+6+7+8+16+17+9+10+11+12+18

G (^π,^γ)

0 +13

-3

-2 +14 +15 -1

+4 +5 +6 +7 +12 +16 +17 +10 +9 +11 +8 +18 19

chchrorommosoommee11

chromosome 2

chromosome 3

(b)

G (Π^ ,Γ^)

+13 -3

-2 +14 +15 -1

+4 +5 +6 +7 +12 +16 +17 +10 +9 +11 +8 +18

chromosome 1

chromosome 2

chromosome 3

(c)

ΠΓ-path

ΠΠ-path

+13 -3

-2 +14 +15 -1

chromosome 1

ΓΓ-path

G (Π,Γ)

+4 +5 +6 chromosome 2

(d)

+7

ΠΓ -path +12 +16

semi-knot ΠΓ-path
+17 +10

+9 +11 chromosome 3

ΠΓ-path +8 +18

+13 -3

-2 +14 +15 -1

+4 +5 +6 +7 +12 +16 +17 +10 +9 +11 +8 +18

chromosome 1

chromosome 2

chromosome 3

(e)

Π

-3-2 -1+4+5+6+7+12 +10+9+11+8

translocation

-3-2 -1+4+5+6+7+8 +10+9+11+12

fusion

-3-2-1+4+5+6+7+8 +10+9+11+12

fission

-3-2-1+4 +5+6+7+8 +10+9+11+12

Γ
+1+2+3+4 +5+6+7+8 +9+10+11+12

reversal

+1+2+3+4 +5+6+7+8 +9-10+11+12

reversal

+1+2+3+4 +5+6+7+8 -9-10+11+12

reversal

reversal

+1+2+3+4 +5+6+7+8 +10+9+11+12

(f)

Figure 3: (a) Genomes and ?, cappings ^ and ?^ and concatenates ^ and ^. (b) Graph G(^; ^).

Tails are shown as white boxes. (c) Graph G(^; ?^) is obtained from G(^; ^) by deleting the tails. Caps

are shown as white circles. (d) Graph G( ; ?) with 4 cycles and 6 paths (c( ; ?) = 10). -caps are

ps(he()owG; ?nr)aap=shb1Go,x(se(^s;w?^; ?h)i)cleo=r?r1-et,sapgilors(nadri;en?gs)ht=oowfannr(boyp;dt?iima)m=alo0cn.adpTsp.hiFnerogerfoogfre?e^nod=m( (e+s; ?1)3a=+nd115?+?,2b1(+0 +3; ?+1)+4=0?1+51,5d)r1((??021+;4?0e)+==5

0, 7. +

6 + 7 + 8 + 18)(+17 + 9 + 10 + 11 + 12 + 16). Added gray edges are shown by thick dashed lines. (f)

optimal sorting of into ? with seven rearrangements.

14

111111111967845321018236745..................

Algorithm Genomic Sort( ;?)

Construct the graph G = G( ; ?)

Close all ?-paths in simple components of G( ; ?) (lemma 6)

wClhoisilefetahGllerbceounettxoaisnintess

?-path in a path a -path

components in G

having

more

than

one

?-path inside them

elseinfdGahnaisnmteorcrhertohmaonso2mseaml oi-rknaontsoriented edge g joining this -path with a ??-path (lemma 4)

elseiifnfdGGahhnaasisnt2thesreechmgrrieo-amktneoossttosmreaall-okrnoatn oriented edge g joining ?-paths in any two semi-knots (lemma 5)

else nd an edge g closing the ?-path in one of these semi-knots

elseif

nd an G has 1

interchromosomal semi-knot

or

an

oriented

edge

g

joining

?-paths in these semi-knots (lemma 5)

else nd edge g closing the ?-path in this semi-knot

nd edge g closing arbitrary add edge g to the graph G, i.e G

?-Gpa+thfgg

19. nd a capping ?^ de ned by the graph G = G(^; ?^)

20. sort genome ^ into ?^ (theorem 3, Hannenhalli and Pevzner, 1995)

21. sorting of ^ into ?^ mimics sorting of into ?

Figure 4: Algorithm Genomic Sort

15

