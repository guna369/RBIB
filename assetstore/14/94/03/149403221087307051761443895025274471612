HOUSTON JOURNAL OF MATHEMATICS, Volume 11, No. 3, 1985.
COMPLETENESSOF MANY-SORTED EQUATIONAL LOGIC* J. A. Goguenand J. Meseguer
ABSTRACT.Assumingthat many-sorteodquationallogic"goes just asfor theone-sortedcase"hasledto incorrectstatementosf resultsin many-sorteduniversalalgebra;in fact, the one-sorted rulesarenot soundfor many-sortedeductionT. hispapergives soundand completerules,and characterizeswhen the one-sorted rules can still be used safely; it also characterizesthe related questionof when many-sortedalgebrascan be representedas one-sortedalgebrasT. he papercontainsa detailedintroduction to Hall's theory of clones(later developedinto "algebraic theories" by Lawvere and Benabou); this allows a full algebraizationof many-sortedequationaldeductionthat is not possiblewith the usualfully invariantcongruenceosn the free algebraon countablymanygenerators.
1. Introduction. The naive generalizationto many-sortedalgebraof the usual rules of one-sortedequational deduction is not sound.The aim of this paper is to state preciselywhat the differencesare from the one-sortedcase,to provide sound and complete many-sorted rules of deduction, and to give necessary and sufficient conditions under which the ordinary one-sorted rules are equivalent to our new rules. Some subtle differences from the one-sortedcaseseemnot to have been recognized previously,but they have important model-theoreticconsequencesF. or example,the Birkhoff Theorem does not hold as stated in [14] (the first paper on many-sorted algebra) precisely becausethe one-sortednotion of satisfactionof an equation is too naive for the many-sortedcase. The categoricalapproach to many-sorteduniversal algebra[2] hasan abstractversionof the right proof theory (givenasa category)and it providesan abstractproof of the CompletenessTheorem (usingthe Yoneda Lemma [16, 2]). However, the implicationswhich are implicit in the categoricalapproach
*Supported in part by the Office of Naval Research Contracts N00014-80-C-0296 and N00014-82-C-0333b,y NationaSl cienceFoundationGrantNo.MCS8201380a, ndby agift fromthe SystemDevelopmenFt oundation.
307

308 J.A. GOGUEN and J. MESEGUER
have not been fully recognized. For example, [2], Theorem 2.2.4.1, assertsthe existence of functionally free algebras[211 for any variety of many-sorted algebras, an assertionthat is shown to be false in this paper. However, the commentsof [17] show that Lawvere is fully aware of the inadequacy of the usual way of interpreting variables and terms in a model. Here, we correct the usual use of equational logic, previouslyassumedin the literature to be sound.
Familiarity with the categoricalapproach to universalalgebrais not necessaryto read this paper. Indeed, it usesthe smallestpossibleamount of technicalmachinery, and for the most part uses only many-sorted algebras, homomorphisms and congruences.Nevertheless, several auxiliary remarks indicate connections with the categoricalapproach, and we think that the interested reader will have lessdifficulty later with more abstractpresentations,havingseenthesemore concreteversionsof the same concepts.
Our interest in this problem arose from our work on abstract data types in theoretical computer science,where many-sorted algebrasare used for a variety of purposes [5, 22, 13, 12, 8, 20, 11, 19], in particular, [15] gives a bibliography containing870 papers"related to algebraicallyspecifiedabstractdata types." For such applications, our results have practical significance, because they support correct computer implementations.
The rest of this introduction illustrates the problem by means of two simple examples, introduces a convenient notation for the correct rules of equational deduction, and then informally summarizesour results.
1.1 SATISFACTION OF EQUATIONS IN MANY-SORTED ALGEBRAS. This subsection gives the basic definitions for many-sorted algebras, including the satisfactionof equations,to be usedin the restof the paper;this will make precisethe
statements in the rest of the introduction.
Let I be a set (of sorts), thenanI-sorted (or I-indexed) set A is just a family of
componesnettsAi foreachindexi inI. WesaythatanI-sortesdetA= {AiliGI) is
finiteif andonlyif thedisjoinut nionq•iAisa finiteset.If A andBarebothI-sorted
sets,then an I-sortedfi•nction f: A -> B is an I-sorted family of functions
(fi: Ai-• BiliGI)'

COMPLETENESS OF MANY-SORTED EQUATIONAL LOGIC

309

AnI-sortesdignatu2r3eisanI* XI-sortefdamily{23wilw, CI*, iCI} (wherIe*
denotetshefreemonoiodnI);oin23wi i,safunctiosnymboolfaritywandsorti;the
arity of a function symbol expresseswhat sortsof data it expectsin its argumentsand
in what order; and the sort of a function symbol expressesthe sort of data of the
result. A constant symbol of sort i has arity the empty stringe, i.e., it is a member of
23e,i' A 23-algebAraconsisotsf anI-sortefdamily{Aili• I), ofcarriesretsa,ndfor
eachfunctiosnymbolin 23wa,inactuaflunctioAno'Aw-•Ai wherAew=
AilX-'-XAinwhewn=i1'" in(whewn=e,theAnTMisaonpeoinsteatnAdocan
beidentifiedwithanelemenotf Ai).
A 23-homomorphismfrom a 23-algebraA to another B is an I-sorted function
f: A -• B that "preservesthe function symbolsin 22"in the sensethat

fi(A(oa1...,.an)=)Bo(1f(ia1),'",fin(an)),

whewre=i1'--inwithajinAijandoin23wF,io' cr onstai.net.fs,o,rw=e,the
condition becomes
fi(Av)= Bo-
GivenanI-sortesdetX = (Xi)i6I andsignatu2re3thenthefree23-algebornaX (also calledthe"algebroaf 23-termwsithvariableinsX") isdenotedF23(X)(.ForF23(X)to
have the universalproperty, terms should be unambiguous;a sufficient condition for
thisistorequi2r3ewi (,q2W3,.1... 0 whenevleenrgth(=wle) ngth(wan')d(w,i4) :(w',i').
Thicsaanlwabyesensurreepdlac2i3bnyg23#w,he2r3e#=w23,iwX,(i(w,}i),anwd e
will assume throughout that terms are always built from such a disambiguated
signaturewhenever23is ambiguous.)Its carrier setsare defined inductively by
(1) 22ie•, Xi_CF23(Xf)oi reachi inI;and
(2)o(t1,...n,t)isinF23(iXfo) reacohin23il...iiann, edacthjinF23(Xfo)irj
j= 1.... ,n.
F22(Xis)madientoa23-algebbyrdaefininFg23(Xo)foroin23et,oi bethesymboiln F23(X()it isin F23(Xb)y(1));anddefinintghefunctioFn22(Xo)foroin23wf,oi r w4:e,tosend(t1,...,nt)in(F23(XT)M)tothetermo(t1,...n,t)inF23(Xi ()itisinF23(X)
by (2)). It is a basic fact about free algebrasthat they have the following universal

310 J.A. GOGUEN and J. MESEGUER
property: given a Z-algebra A and an I-sorted function f: X-• A, there is a unique
Z-homomortp4h•F:izs(mX-)•Aextendfi,ni.eg.s, ucth atthediagram
nX
X • Fz(X)
I
if #
I
A
commutews,here•tXistheI-sortedinclusioonfX intoFz;(X).
CONVENTIOTNh.esuperscorifp•t issometimdersoppesdo,thatintherest
of this paper the same letter f may denote the map X-* A and its homomorphic
extensioFnz(X) -* A. The universaplropertyabovedeterminetshe algebraFz;(X) up to a unique
isomorphisTmhe. algebrFaZ(0),for0 theI-sortesdetwithallitssortsemptyi,s
called the initial Z-algebra;the universalproperty then saysthat for eachZ-algebraA
thereisauniqu2e3-homomorpFh2is3m(0-)* A. GivenanI-sortesdetX wecanthink
of theelementosf Xi (for i in I) asvariablseymbolosf sorti. Givena Z-algebrAa, an
I-sortedmappingf: X -• A is calledan assignmenftrom X to A. A Z-equation,denoted
(VX) t 1= t2
isa triple(X,tl,t2) withX a finiteI-sortedsetandt1,t2inFz;(X)i forsomesorti. We saythata Z-algebrAa satisfietsheZ-equatio(nVX) t1= t2 if andonlyif forevery
assignmf:Xen-*tA,wehavtehatt4(1t )=t4(t2)G. iveansePt of2;-equatwioens,
say that a Z-algebraA satisfiesF if and only if A satisfieseachequationin P; in that case,we call A a (Z,P)-algebra. The classof all (Z,F)-algebras is called the variety of F.
An ordinary Z-equation, denoted t 1 = t2,
isa pair(t1,t2) of termsof samesortin Fz;(X)forsomeX. WesaythatanalgebrAa satisfietsheordinaryequationt1= t2 if andonlyif it satisfietsheequation
(VX') t1= t2 forX' theI-sortesdetofvariablethsatoccuirneithetr1ort2.Forone-sorteadlgebra
there is no need to introduce quantifiers into equations, i.e., ordinary equationsare

COMPLETENESSOF MANY-SORTED EQUATIONAL LOGIC

311

enoughto describeall varietiesand to handleequationaldeductionand satisfaction. We will seethat thisis not the casefor many-sortedalgebra.
1.2UNSOUND DEDUCTIONS. The following example demonstrates the unsoundnessof usingthe usual one-sortedrules for many-sorteddeduction. Let • be
thesignatuwriethsorstet{a,b)a, ndwith•e,b=(T,F),•b,b=( -1),•bb,b= (&'+)' •a,b=(FOO),and•u,v=0 forallotheur ,v.(Althougwheinten"db"tosuggest
"Boolean," Y•-algebranseed not haveas elementsof sort b exactly the truth-valuesT and F; indeed, it may help to think of T and F astwo arbitrary symbolsthat may or may not happen to denote the sameelement in an algebra.)Finally, let I• consistof the following seven ordinary equations, where A,B are variables of sorts a,b, respectively
•T=F -IF=T B+•B=T B&-IB=F B&B=B B+B=B
FOO(A) = --1FOO(A).
Boolean algebra gives the first six equations.The rules of one-sortedequational deduction now give
T = FOO(A) + -1FOO(A) = FOO(A) + FOO(A)
= FOO(A)
= FOO(A) & FOO(A) = FOO(A) & -1FOO(A)
=1 •.
If this deductionwere sound,then the equationT = F shouldhold in every•-algebra
satisfyinI•g. Butthereisa •-algebraBARsatisfyin1•gwherethisisnotso:BARa= 0; BARb= (T,F•; FOOis theemptyfunctiona;ndallthebooleafnunctionasreas
expected. Therefore these rules are not sound. This example evolvedfrom one suggestedby Gerard Huet, who pointed out to us the unsoundnessof the ordinary rulesof deductionin the many-sortedcase;the presentis intendedto suggeshtow

312 J.A. GOGUENandJ. MESEGUER

unsoundnessmight arise in practical examples such as parameterized abstract data type definitions.
Anotherexampleof a signaturweithoutconstantis the followingI:= {a,b},
Zaa, = {o},Zab,a={g}, andFthefollowintwgoordinareyquations
o(x) = •(x,y)

I•(u (x,y),z) = •(x,y).

The rulesof one-sortedequationaldeductiongive

o(o(x)) = •(o (x),y) = •Cu(x,y),y) = •(x,y) = o(x).

ThefreealgebFra2;({x))(xofsorat )hasF2;({x)a)= {on(x)lCnco}F, •;({x)b) =0,
andsatisfiesF trivially, but doesnot satisfythe ordinaryequationo(o(x)) = o(x).

1.3 THE RULES OF DEDUCTION. The first step toward correcting this

situationhasalreadybeen taken: Equationsmusthaveall variablesexplicitly declared

with their sorts,yielding what canbe thought of asequationswith explicit quantifiers.

But, if the old one-sortedrulesof deductionare modified in this way, the resulting

systemis not complete. Two new rulesare neededfor addingand deletingquantifiers.

Given a signature•; and a set of Z-equations, the following are the rulesfor deriving

equations:

(1) Refiexivity. Each equation

(vx) t = t

is derivable.

(2) Symmetry. If

(VX) t = t'

is derivable, then so is

(VX) t'=t.

(3) Transitivity. If the ecluations
(VX) t: t', (VX) t' = t"

are derivable, then so is

(VX) t = t".

(4) Substitutivity. If

(VX) t1= t2

COMPLETENESSOF MANY-SORTEDEQUATIONAL LOGIC

313

of sorti isderivable,if x G X is of sorti', andif
(VY) u1= u2
of sorti' isderivablet,hensois
(VZ) v1= v2,
wherZe=(X-{x})UYv,j=tj(x+--uj)forj=1,2a, nd"tj(+x--uj)"denottehse
resuoltfsubstitutuinjfogrxintj.(Thinsotioonfsubstitutcioanbemadperecise
by usingthesamemachinertyhatwasusedabovetodefineequationaslatisfaction.
Lett bea Z-termwithvariablfersomX, i.e.,t GF2(X).LetxGXi andlet uGT2(Z),wherZe=(X-{x})UY. Nowdefinfe:X -->F2(Z)byf(y)=y if y4=x,
andfix)=u.ThetniPF: •(X)-->F2(Zi)stheuniqu2-ehomomorepxhtiesnmdfi,ng
andwedefinte(x *-- u)=f4P(t).)
The followingtwo rulescompletethesystem:
(5) Abstraction. If
(VX) t=t'
isderivablei,f y isa variableof sorti andy isnot in X, then (VX U (y}) t = t'
isalsoderivabl(eT.hisrulealsoapplieisf X = 0, wherethereareoriginallnyovariables,
and one is added.)
(6) ConcretioLne.tussaythatasoritisvoidinasignatuZreiffFZ(•))=i •).
Now, if
(VX) t=t'
isderivablief,x GXi doesnotappeairneithert ort', andif i isnon-voidth, en
(VX- (x}) t = t'
is also derivable.
1.4 THE EXAMPLESAGAIN.In the first examplem, akingexplicitthe quantifierosf the equationsit, is easyto checkthatthe deductivseequencgeiven
proves the equation
(V {{A},0}) T = F but not the equation
(V•)) T = F.
Similarlyin, theseconedxampltehedeductivseequencperovetsheequation

314 J. A. GOGUEN and J. MESEGUER

( v { {x},{y }})o (o(x)) =o(x)

but not the equation

(V((x) ,0)) o(o(x)) = o(x).

We are unable to apply the rule of concretion in either example, due to the presence

of a void sort.

1.5 SUMMARY OF RESULTS. This section summarizes the main results of this

paper, beginningwith the

COMPLETENESS THEOREM. Given a set F of 23-equationst,hen an equation (¾X) t = t'

is satisfiedby every algebra in the variety of F iff it is derivablefrom F usingthe rules

(1) to (6) of Section 1.3.

We now give necessaryand sufficient conditions on Z for the ordinary rulesof

equational deduction to yield the samederivedequationsasour rules,and henceto be

complete. The ordinary form of a 23-equationis the ordinary equationobtainedby eliminating the quantifier. By the ordinary rulesofequational deduction we mean the

variants of rules (1) to (4) of Section 1.3 obtained by eliminating the quantifiers

(V X). Then, for a givensignature23,we say that the CompletenessTheorem holdsin

ordinaryform iff for any setF of 23-equation(swith quantifiers),an ordinaryequation

is satisfiedby all algebrassatisfyingF iff it is derivablefrom the ordinary forms of the

equationsin F using the ordinary rules of equational deduction. Recall that a sort i is

voidin 23iff F23(0i)= 0. Let23(x: i ) denotethenewsignaturceonstructefrdom23by
adding a new constant x of sort i.

THEOREM 2. The CompletenessTheorem holds in ordinary form for a signature 23iff for all sortsi,i' of Z, i' isnon-voidin thesignature23(x: i).

REMARK. The condition given in Theorem 2 is equivalent to the following

model-theoretcicondition":For every23-algebAra, if someAi isempty,theneveryAi
is empty."

Given a set F of equations, an algebraA is initial in the variety of F iff there is a

unique 23-homomorphismfrom A to any other algebrain the variety of F (this in fact

characterizessuch an initial algebraup to isomorphism).The initial algebra in the

varietyof F canbeobtaineadsthequotienotf theinitial23-algebFrZa(0)bythe

COMPLETENESS OF MANY-SORTED EQUATIONAL LOGIC

31$

congruencfeormedby all pairs(t,t') suchthatt,t' areZ-terms(withoutvariables!a)nd (V0) t=t'
is derivable from F. We will say that the initial algebra of the variety of a set F of equations(with quantifiers) is definable in ordinary form iff it is the quotient of the
initial Z-algebraby the congruenceformedby all pairs(t,t') suchthat t = t' is
derivable from F by the ordinary rules of equational deduction. We next give conditions, weaker than those of Theorem 2, which characterizeexactly when this can be done. Let us say that a sort s is quasi-isolatedin X iff either it is void in X, or else there is only one Z-term of sort s.
THEOREM 1. For a given signature 2;, the initial algebra in the variety of F is
definablein ordinaryform for everyset F of equations(with quantifiersiJff either
ever),sort in X is quasi-isolatedor elseevery sort in 2: is non-void. REMARK. The condition given in Theorem 1 is equivalent to the following
model-theoretic condition in terms of reachablealgebras(a Z-algebra A is reachableiff
theuniquheomomorphFisym,(0)--A->issurjectiv"eF):oreveryreachabZle-algebra
A, if someAi is empty,then IAil•<1 for everyi."
The above resultsshow that the ordinary rules of deduction will suffice for most examples that one could expect to arise in practice. But there are some important exceptions. For example,in the theory of abstract data types, void sorts often occur in the equational theories associatedwith parameterizeddata abstractions.Thus, consider the parameterized data type Set(X); given an instanceof X, it produces (finite) Sets of X's. The theory associatedwith Set(X) has a constant of sort set, namelythe empty set, but hasno constantsof the parametersort X, and no operations that could producesuchconstants.(For further discussionof parameterized data types, see for example [1 1, 7, 4, 10].) In any case,we want to be able to state results with the greatestpossiblesimplicity and generality, and we believethat the explicit use of quantifiers is the right way to achieve this for many-sorted equational logic.
Theorem 2 characterizes the signatures for which many-sorted equational deduction canbe reducedto one-sortedequational deduction. Usinga result of [ 1] we can show that the signaturesmentioned in Theorem 2 are exactly those X for which every variety of (X,F)-algebras can be faithfully representedby a one-sortedvariety.

3 16 J.A. GOGUEN and J. MESEGUER
By this is meant that there is an equivalenceof categoriesbetween the category of (23,F)-algebrasand a category of one-sorted(23*,F*)-algebrasin such a way that a
many-soratelgdebAra= {Ai)iCI ismappetodaone-soratelgdebwraithcarrieIlriai.
THEOREM 3. The CompletenessTheoremholdsin ordinaryform for a signature 23 iff for each set F of 23-equationsthe variety of (23,F)-algebrascan be faithfully representedby a variety of one-sortedalgebras.
2. Many-sortaelgdebraLse. tI beaset.ThenthecategoSryeIthasI-sortesdets
as objects and I-sorted functions as morphisms. The category of I-sorted signaturesis
simpltyhecategoSryeIt*XI of (I* XI)-sortesdetsW. edenottehesseignatubreys
Greek capital letters, suchas 23,I2, and we denotetheir elementsby lower caseGreek
letterss,uchasoC23wi.,ThecategoArylg2o3fZ-algebrfaosr,23anI-sortesdignature,
has Z-algebras as objects and 23-homomorphismsas morphisms.A Z-homomorphism f
is saidto besurjectivein, jectire,or anisomorphismiff, for eachi 6 1 themapfi is
surjective, injective, or bijective, respectively. A Z-congruenceon a 23-algebraA is a
familRy={Ri)iICofequivalerenlcaetioRni Cs _Atih2aits"compatwibitlhethe
operationinst"hesenstehatforeacho6 Zwi, withw=i1"- ik • I* andwithi CI,
ifaj,b6jAifjojr=1,...a,kresucthaatjRjiitbheanlso
Ao(al,...,ak) Ri Ao(b1,...,bk).
Given a 23-algebraA and a Z-congruence R on A, there is a canonical Z-algebra
structuroenA/R= (Ai/Ri)i61 inducebdytheoneonA andmakintghecanonical surjectioqnR:A ->A/R a 23-homomorphAisnmy2. 3-homomorphf:isAm->Binduces a 23-congrueEnfwceithEf,i theequivalenrecleatioanssociateodthemapfiandwe
havae23-isomor#p:Ahi/sEmft-f(As)ucthhaft=J'#'qEwfhejr:ef(A)-B• isthe
inclusionhomomorphism(this isthe so-calledhomomorphismtheorem).The setof all 23-congruenceosn an algebraA is a completelattice which we shalldenoteC(A).
3. Derived operations and the completeness theorem. Given an I-sorted
23-algeAb=r{aAi}iGaI ndaseXt ,wecanconstrtuhceZt -algeAbraisetodtheXth
power denoted[X,A], with [X,A]i = [X,Ai], thesetof all functionsfromX to Ai,
and with operationsdefined componentwiseby
IX,A]o(fl,...,fk)(X)= Ao(fl(x)....,fk(x)),forallx • X.

COMPLETENESSOF MANY-SORTEDEQUATIONAL LOGIC

317

In particularf,or eachwordw C I* we havethealgebra[AW,A],andif theletteri
appeniatirmsientshwe owrdw, we ihllanvieprojecmtiao•prn.•s..•.ri.nCi[AW],iAf i
ATM=/0: andIAi[> 1,ortheuniqume ap½i• [AW,A] ifATM= 0orIAil--1. Let Xcodenotean I-sortedsetwitha countablienfinityof variableisn each
ii
componesnaty,Xco=,i (Xl,...,nx...}.. ForeachwGI* wecandefinaefiniteI-sorted
subXsweotfXcwoitXhwi=,0ifidoneosotccinuwra, nwditXhwi=,{xi,...,X) ini
if i occurnsi timesin w. For eachwGI* wethendefinethealgebrDa(A)w of
w-derivedoperations of a Z-algebraA as the imagealgebraof the Z-homomorphism
Aw:Fz(Xw)• [AWA,] whichextendthseI-sortemdapAw:Xw-• [AW,As] ending
foreachsoritoccurriinngw,xijtorrijifATM=/0: andIAi>l 1, andotherwsiseending xJ!to½i'
Byafamilyof Z-equatiownesmeananI-sortesdignatuI'r=e {I'w,i}wGi,,iCi
suctha1t-'iw__,FCZ(X2wi .T) hiissjusatsligrhetformuloafthioennotatuiosneind
theintroductinoanm, elayp, air(t,t')G1-'wi i,ntheI-sortesdignatuI'rceorrespotnods
an equation
(V Xw)t =t',
andquantifyingonly oversetsXw involvenso lossof generalitys,inceanyfinite I-sortedsetcanbe put intoI-sortedbijectionwithoneof the formXw for some
wGI*
We now reformulate the notion of satisfaction of an equation to an equivalent
one that is technically more convenient.
LEMMA. An equation
(i) (¾Xw)t=t'
is satisfiedby a Z-algebraA if and only if
(ii) Aw(t)=Aw(t'). PROOFN. otethatif w= i1 -" ik thenatuple(a1,...,ka)GATMisessentiatlhlye samethingasan I-sortedfunctiona' Xw• A thatweshalldenoteby (a1.....ak):
Xw-• A, and call an assignmenTto. see(ii)=• (i) it sufficesto showthat for any
assignma=e(natl,...,akX>w:-•A theinduchedomomorpah#i:sFmz(Xw)• A
factors as
($)a#=evalaOAw,

318 J.A. GOGUEN and J. MESEGUER
wherevala[:AWA,] -• A isthehomomorphtihsamtmapesachhC [AW,A] itothe
valuhe(a1...,.akC) Ai. Thisfollowbsyuniquenoefas#sfromthefacthatb, y
definition,
evalaoAwo=ra/X. w
To seetheimplicatio(in)=•(ii),noticethatif Aw(t):/:Aw(t'),thenthereisa tuple (al,...,ka)• ATMsuchthatAw(t)(1a,...,ka):/:Aw(t')(1a,...,ak)D. efininag=(a1,...,ak): Xw-• A andconsiderinthgeequatio(n$), onegets
a#(t=) evala(Aw=(/e=t)v)ala(Aw=(at'#))(t'),
showinthgatA doensotsatisftyheequatio(nV Xw)t = t'.ß WeshadllenotbeyAlgzF, thefullsubcategoofArylgZ formebdythosaelgebras
which satisfyF, i.e., the variety of algebrasdefinedby the equationsF.
The above discussioninvolves four I-sorted signatures,namely: the family
(FZ(Xw})wi •I*,i•IwhicwheshadllenoTteZt;hefamil{y[AWA,i]}w•I*,iCwI hich weshadllenoOte(A)t;hefamil(yD(A)wi },wGI*,iGwIhicwheshadllenoteD(aAn)d whicihsbydefinitiothneimagoefthesignatumraepA=( Awi,}:TZ->O(A)a;ndthe
familyF= (Fwi,}wGi.,iGwi hichcomeesquippwedithtwoprojectimonaptsothe
signaTtZudreenoPtel,dP2F:•TzinherriteesdpecftriovemthlyosoefT2•.The
property of an algebraA satisfyingthe equationsI' can then be expressedin a more
compacftormbytheconditionAOpl= Aop2orbycommutativiotyf thediagram
Pl A F •>T•; >O(A).
P2
In additiont,hesignaturTeZs andO(A)(andhencealsoD(A)) haveanI* X I-sorted
algebrastructurewhich is preservedby the map A. This algebraicstructurehas been calleda clone by P. Hall [6] and analgebraictheory by F. W. Lawvere,who exploited its potentialities in a far-reachingway [16,2]. It capturesthe notion of substitution
(of wordsinT•;andof functionisnO(A))whichisonlyimpliciitnearliear pproaches.
We proceedto describethis structurein detail, but in a first readingonemight prefer
to passfromthedefinitionof • belowto thediscussioonfsO(A)andT•;skippintghe
axioms © below except, perhaps,for their names.
The signatureof I-clone operationsis the (I* X I)* X (I* X D-sortedfamily •=

COMPLETENESOSF MANY-SORTEDEQUATIONALLOGIC

319

{•2wu,}wC(I*XI)*,uCIw*XitIh
•2e,()w--{,i•'r•,..i.},•ifrinoiccunirtsimeinsw
= 0 otherwise.

•2(w,i)(v.l.,.il()vk,ik),(Vk--+•-l[,-i.),..-.]} ifv1..... Vk1+anwd--i1--'ik

=(-Vk•+ilfw--eandk=0

-- 0 otherwise.

Thceonst•arn•atrsecallpedrojectwiohni-sl[e,-,...,a-]n-dvarecallseudbstitution
op era tors.

For an •2-algebrato be a clone, it hasto satisfythe following equations©, where
toavoidconfusiowneuseGreeklettersd•nT• Mforvariableosfsort(w,i),wherwe CI*'
i • I and n • co(codenotesthe non-negativeintegers)'

(i) Projection Axiom. Equationsof sort (v,il)'-.(v, ik),(w,i), with w--il...ik,
andimthejthoccurrenocfei inw:

•rif,•v,il ,•v,ik•= •v,im
jLV'nl '""V'nk J -nj '

(ii) Identity Axiom Equationsof sort (w,i),(w,i) with w = il...ik, and nij the
numbeorfoccurrenocfeisj uptothejthplace:

,0nw' tir•rinl il'""rirknik, J= 0-nw,'i

(iii) Associativity

Axiom. Equations of sort (w,i)(v,il)o.'(v,ik)

(u,jl)'-. (u,jh),(u,i), with w = il" 'ik, v = j 1.. 'jh:

•nwi,tf'•,n,l vilL,rV,'m•lu"",'Wjaml ,huJ,"j"h'•'na•k,vt,Wimkl-•,,.u.,•,jlh]

=w.•nwitrV,.n,•l wil,..,.,S.••nvkik,i ,[0r•ql,.h..].,0•jh
(iv) Invariance of ConstantFunctions Axiom. Equationsof sort (e,i),(v,i):
•ev,i["mnivll","'m"nvk,ik=] •ve,'i
i
Well-knofwanctsabouftunctiognisvethatO(A)isa clonienterpretitnhgerrj as
projectionfunctions,-[-,...,-] as substitutionof functions(i.e., f,hl,...,hk•
f(h1....,hk)), and-v as the conversioonf constantisnto constanftunction(si.e.,
1• Ai• Av-•1• Ai).SimilaTrlZyi,saclonienterprertJri!ansgxJ!and- [-.,..-.] as

320 J.A. GOGUEN andJ. MESEGUER

term substitution, i.e., the function
- (-,...,-)
FZ(Xwi)X FZ(Xv)ilX-.'X Fz(Xv)ik

) Fz(Xv)i

sendintg,t1....,tk tothetermt(tl,...,tk),definefdorw= i1o"ik andfort G Fz(Xw)
asthe imageof t underthe uniqueZ-homomorphismin the diagram
r/xw Xw ) Fz(Xw)

(1.tt.•.k..) -(1t,...,tk)

Fz(X v)

Note that by fixingv andthe firstvariableabove,termsubstitutiongivesthederived

operationosf FZ(Xv),i.e., t(tl,...,tk)= Fz(Xv)(t)(tl,...,tk)F. inallythe-v are interpreteadstheuniquheomomorphismFsz-(vX:e)= FZ(0)->FZ(Xv)T' heaxioms

(i) - (iv) can now be verified from the universalproperty of free Z-algebras;that the

mapA:TZ -> O(A)associatteoda Z-algebrAa is a clonehomomorphaislsmo
follows from the constructions.

Anotherconsequencoef the abovediscussioinsthata Z-algebraA satisfiegsiven
equatioFn_sCT• if andonlyiftheclonmeapA:TZ->O(Af)actotrhsroutghhe

canonicsaulrjectioqnFoT' z->Tz/FoforFø thesmallecsltonecongruen(ic.ee., C/,-congrueonnceTZ) containinFg, i.e.,if andonlyif wehavethecommutative

diagram

A
TZ ) O(A)

FøcabnedescraibstehdesmalIl*eXsIt-sorsteudbsoefTt•thactontafoinresach

wCI* andi CI,bothFwi,andthediagon{(at,lt)l•t(TZ)w,ia}n, disclosuednder

symmetryt,ransitivitya, ndsubstitutioni.,e.,satisfietsheconditions:

oo
(a)(t,t')GFwi,=•(t',t)• Fw,i;

(b) (t,t'),(t'",t ) GFøwi,=•(t,t")c Føw,i;

oo

I •o

(c)(t,t•')r'wi a, n(dtj,t•_F'jv),fioj jr=1...,.k=•(t(tl,...,(ttk•),,.t..,•tkF)vi) ,

COMPLETENESS OF MANY-SORTED EQUATIONAL LOGIC

321

whenevewr = i1' ø'ik;

o•

o

(d)(t,t')c Fei,=•(tvt,v)=(t,t')CFvi,-

The generationof Vø from V is actuallyan algebraicreformulationof thegeneration

of all the equations provable from a given set of equations F by the rules of

many-sortedequationaldeduction. Indeed, by the above discussionand the remark

belowt,hedeductionprocescsanbeunderstooadsgeneratinagnappropriatceongruence.

REMARK. The generationrules for Fø given above are equivalentto the

deductionrules(1) - (6) givenin the introduction. We now sketchthe main stepsof
o
thisequivalenrecfel:exivi(t1y)istheconditiVonwi,_D{(t,t)ltG(rZ)w,i}s;ymmetry
(2) is condition (a), and transitivity (3) is condition (b); that substitutivity(4) is

equivalentto condition (c) follows easily (by induction) after application of the

identity, projection, and associativityaxioms in the definition of clonesor, more

directly, by elementarypropertiesof term substitutionC. ondition(d) is a simple

speciacl aseof abstraction(5), so(5) =•(d). On the otherhand,Føreflexive(,c), and

(d) imply (5) by the identity axiom in the definitionof clone,and imply (6) by the

associativityand projection axioms in the definition of clone, using that (by

hypothesti=s)t(x2....,xn)andt' = t'(x2,...,Xna)n, dthatthesorit1isnon-voiHde. nce
we get the desiredequivalence.

Wecannowdefinea GaloisconnectiobnetweetnhecompletleatticeC(T•;)of clonecongruencoens T• and the set VAR• of all varietie(si.e.,equationally definablesubcategorieosf) Algz orderedby inclusionn: amely,to eachclone

congruenEceweassociaAtelgzE, andto eachvariet_yA_A_lCgzweassociathtee
congruencEeA = NAGAEA whereEA is the congruencaessociatetdo the map _ --
A:Tz-•O(A). The map E•Alg•;,Eis clearlysurjectivIet. is also an
anti-isomorphoisfcmompletlaetticeCs(Tz)• I•ARzbythefollowing.

COMPLETENETSHSEOREML.et _A=Algz,ib-,e a varietydefinedby
equatiVo_n_Ts2CZ.ThetnhesmallcelsotnceongruVeøngceenerabtyeVdcoincides
o
withthecongruenEAce=NAGAEdAefineadboveb.•othewr ords(t,,t')GFwi,if __
and only if A(t) = A(t') for all A GA. --
o
PROOFT.ha(tt,t')GVwi,=•A(t)= A(t')forallAG_Afollowfsromtheabove
discussion.To see the opposite implication, it sufficesto give for each w G I* an

322 J.A. GOGUEN and J. MESEGUER
algebArawC_Asucthhatfori CI andt,t'CFz;(Xwi w) ehavAew(t=) Aw(t'i)mplies
o
(t,t')• l•w.,iForeachw• I* considtehrefamily• (T2/l•ø)w•i,•iI whicwh eshall denotbeyF•,i•(Xw)F. romthedefinitioonfI•øit followthsatF2,1•(wX)hasa
well-define2d-algebrastructureinheritedas a quotientfromthat of F•(X w)=
• (TZ;)w,i•I ia• ndthatF•,i•(Xw)belontgos_Abydefining
F2,1•(Xw)(V1)(].[.t.,.[tk])= [v(tl,...,tk].) Supponsoewthatt,t'CF2(Xwi )aresuchthatF•,l•(Xw)(t)F=•,l•(Xw)(t'I)n.
particular, if w = il---ik, we will have
F2,1•(Xw)(t)(i[kkx]i)l=][,t..(.x,[i'l.X,x.niki)I•
=F2,1•(Xw)](,t-'.).(,i[kkxX])lnl i
=[t,(x,.l.l.,ixknik)],
o
andbytheidentitayxiom(ii)thisforceIts] = It'], i.e.(,t,t')• l•w.,-i
REMARK. This CompletenessTheorem can alsobe obtainedusingmethodsof
categortyheorya, ndtheproofisverysimplaendelegantht atwayT. 2/i•ohasthe structuorefacategowryithfiniteproducstosthataclonme apA:T2/l•O-• O(A)can be seenasa product-preserfuvinncgtoTr •/l•o-•Setandhomomorphitshmesn
become natural transformations between such functors. The proof of the
CompletenessTheorem can then be reducedto two successivaepplicationsof the
Yoneda Lemma. This idea is due to Lawvere [ 16] for the caseof one-sortedalgebras,
where the Completeness Theorem appears as an immediate corollary of his
structure-semanticsadjointnesstheorem. A similar argumentappearedin the thesisof
Benabou [2] for many-sortedalgebras. 4. Faithful clonecongruenceasnd fully invariantcongruencesIt. iswell-known
thagt iveannI-sortseidgna2tuarneedquati1•oCnTs2•therisea.fre(e2,1•)-algebra
oneachI-sortesdetX, sayTZ;,F(Xw),hicihsaquotienotfF•(X)andwhichasthe universparlopertyT:•,F(X) satisfie1•sandforany1-sortemdapf:X-•A to a
2-algebrasatisfying1• thereexistsa uniquehomomorphismf* suchthat f equalsthe
f*
compositiXo-n• F•(X)-• T•,i•(X) • A. HenceT•,i• canbeseenasa functor fromthecategoorfyI-sortesdettsoAlg•,[•W. eshaslloosneehowthesfereealgebras

COMPLETENESSOF MANY-SORTED EQUATIONAL LOGIC

323

look, but all the above assertions follow by abstract nonsense from the
homomorphitshmeoremandthe factthatAIgxF, is closeidn Algau: nderthe
formation of productsand subalgebras.
WenowclaimthatthealgebrFasZ,F(Xw)= ((Tx,FO)w,iI}ieCncounteirned
Section3 arethefree(X,F)-algebroasnthesetsXw.Thiscanbeseendirectlyfrom
the definition of Fø, or in more abstract terms as a consequenceof the Yoneda
Lemma(seetheremarkat theendof Section3). Thenthefree(X,F)-algebroanXcoas
understood in the last section(i.e., countably infinite variablesfor each sort) has an
easydescriptiniotnermosf Fx(XCaOn)dFø:letFwo CFX(Xw)d2enothee
oo
congruendceefininFgX,F(Xw)i,.e., let Fw= {F'w,i}iCaIndlet F'ø= Uw•i,Fow_CF•(Xco)T2h. enweclaimthatF•,F,(XCOF)=2;(Xcoo)/FTchoi.scanbe
seendirectly, or from the following facts:
(i) Xco= Uw•i,XwhencFe•,F(XCO=)colimw•i,F•,?(Xwb)e, cauFs•e,F isa
left adjoint and thus preservescolimits.
(ii) ThequotienFtx(XCO)•F2;,F(XCiOs)theuniqume apinduceidn the colimiftrsomthequotienFtsz;(Xw)• FX,F(Xwb),ytheirnaturality.
(iii) As for X-algebras, filtered colimits are computed in the category of sets
[18], and in the category of sets finite limits commute with filtered colimits
o
[18]' giventhateachFw isby definitionthekernel-paoirfthenaturaql uotient
o
Fz;(Xw)• F2;,F,(Xww),e havethatFcois thekernel-paoifr Fx(XCO)• FZ,F(XCO)-
These considerationaslso imply in the one-sortedcase (i.e., when I= {1},
I* -- { 1} * • co) the well-known fact that varietiescan be uniquely characterizedby
o
congruencoefstheformFcoonFz(Xco)i,.e.,byfullyinvarianctongruencLeest.• be
anI-sortedsignatureA. congruencReonFz(Xco)iscalledfidlyinvarianitf forevery
pai(rt,t')RCi andforevefriynitfeamitljCyF23(Xwcoit)h1i•j<•j<ksucthat
t,t' C Fz(Xil...ik)i one has (t(t1....,tk),t'(tl,...,tk)•) Ri. Fully invariant
congruencfeosrma completelatticeunderinclusiond,enotedFIC(F23(Xco)I)n. the
o
one-sortecdaset,hemapFø• ['coassociataesfullyinvarianctongruentcoeevery
clonecongruenocenTZ. Converselgyi,vena fullyinvarianctongruenRce, wegeta
clonceongru•e,=n{cRen1},nCbcoytakinRgn1,=RnFZ(XnT)2h.epsaessargees

324 J.A. GOGUEN and J. MESEGUER
mutuallyinversaendgiveanisomorphisCm0-Z)- FIC(Fz(Xco))T. hisfollowsfrom
the definitionof Fø andthe following
LEMMALe. tZ bea one-sorstiegdnatuanredletl-'ø= {l-'•,l}n•cboeaclone
congruencoenTZ. Thenfor every0 • n • m wehave
(t,t') • Fnø,1ifandonlyift,t'• FZ(Xn)an(dt,t')• Fom1, .
PROOF. The direct implication follows for n = 0 from condition (d) in the definitionof Fø and for n > 0 from condition(c) in the definition l-'øand the fact that
t(x1....,xn)=t, t'(xl,...,xn)=t'. Theinversiemplicatiofnollowsforn= 0 fromthe
"invariance of constant functions," axiom (iv) in the definition of clones,combined with condition(c) in the definitionof Fø, whichgives
(t(t,..m.,t)),t'(=t,(..tm,t'.)•,tF))Ol-,
The casen > 0 follows againfrom condition (c) and the fact that
t =t(xl,.n..,Xmn-,...),,rtk' n=t'(x1,.n..,Xrno-,...,nxn)..
For • a many-sortedsignature,the passagefrom a fully invariant congruence
R _CFz(Xco)toaclonecongruencaenbedefinejdustinthesameway,
• ={Rwi},w,i•Xl*IwitRhwi:,RiCF• Z(Xw, )i2
andit is clearthatFø_C FocoB. utforIII> 1theequalitFyø= Focodoesnotholdin
generala, ndwe shallcalla clonecongruencFeøfaithful preciselywhenthatequality doeshold.It iseasyto seethat Fø is faithfulif andonly if for everyv,v' • I* suchthat
Xv-CXv,theinducehdomomorphFiZsm,F(Xv-)• F•], F(Xv,)isinjective.
The first example in Section 1.2 givesa non-faithful clone congruence,sincefor
Xe=0_CXa theinducehdomomorphFiZsm,F(Xe)-F• Z,F(Xai)snotinjectlye, becauFsZe,F(Xbe=) {T,F},whilienFZ,F(Xbaw) ehavTe=F.Thesecoenxdample
in Section 1.2 shows that one can also have Fø non-faithful when there are no
constainnZt,si.e.w, heZne,i=0foralli•I, sincfoerXa={{x]},•C} Xa=b
{{x•},{xwbleh}}avFeZ,F(aX=aF)Z(Xa=a{)on(x>•)•1ln}b, uitnFz,F(Xawabe)
havoen(x]=)o(x•)foralln•>1. If oneisonlyinterestinedtheinitiaallgebFraZ,F(Ot)h, enaclonceongruence
o
Fømighntotbefaithfublu, tstilFl Z,F(Oc)oulbderecovefrreodmFcioncasPeei,=
Fø-•Fz(O)fio2ralli6I; i.e.i,ncasteheuniqhuoemomorFpZh,ips(mO)->

COMPLETENESSOF MANY-SORTEDEQUATIONAL LOGIC

325

Fz,p(Xcois)injectivAe.clonceongruenwcitehthisproperstyhalbl ecalleidnitially faithfulW. eshalcl haractertizheosTeZ forwhichallPøareinitiallyfaithful.
o
REMARK(Si). Fromthedefinitionof themapsPø• FcoandR• R which
assigna fully invariant congruenceto a clone congruenceand vice versa,it is easyto
•O
seethatRco= R foranyfullyinvarianctongruenRce. HenceFcoisexactlythefully
invaricaonnt grugenencerabtyeFdwhecnonsidseirmedpalsyasubsoefFtz(Xc2o)
o
(i.e.,forgettinagboutthequantifiersI)n. otherwordsF, coisgeneratefdromF bythe
ordinary rules of equational deduction mentioned in the introduction (i.e., the variants of the rules (1) - (4) obtained by eliminating the quantifiers). Hence a clone congruencePø isfaithful if andonlyif an equation(t,t') belongsto Pø exactlywhenit is derivable from F by the ordinary rules of equational deduction. It is clear that the initial (Z,P)-algebra is definable in ordinary form in the sensementioned in the introductionif andonlyif the clonecongruencPeø isinitiallyfaithful.
(ii) The above examples of non-faithful clone congruences exhibit some subtletiesof the many-sortedcasewhich do not appearfor one-sortedalgebrasI.f an algebraicdescription of the deduction rules is sought, clonesare unavoidablebecause fully-invariant 1;-congruencesare not fine enough to describededuction rules. As mentioned in the introduction, awareness of this fact is essential for arriving at the right conceptof variety and formulatingcorrectly the many-sortedBirkhoff Theorem (it does not hold as stated in [14], where only the varieties definable by fully invariant congruencesare considered).Indeed, if the set I of sortsis (as usual) finite, Birkhoff's Theorem will hold as expected for varieties in our sense,i.e., the classesof algebras closed under products, subalgebras,and quotients are exactly the varieties; however, if the set I of sorts is infinite, a fourth condition (namely closure under filtered colimits) has to be added. We now explain why the case I infinite is particularly subtle. Our notion of equation assumeda finite (I-sorted) set of variables in an equation
(VX) t=t'.
One could drop the finitenesscondition for X but, for I finite, the apparentextra generalityis vacuoussincein that casefor X arbitrary one can easilyshow,usingthe axiom of choice, that an equation

326 J.A. GOGUEN and J. MESEGUER
(VX) t=t '
is satisfied in an algebraiff the equation
(VX') t=t'
issatisfiefodrX' _CX a finiteI-sortesdubsewtithXi - 0 iffXi 0 andt,t'inF2;(X').
For I infinite sucha subsetX' doesnot exist in general,sincethen an I-sortedsetmay have all its componentsfinite and fail to be finite itself. Thus there is an infinitary (only as far as quantification is concerned)extensionof many-sortedequationallogic that allows the definition of more general varieties for which Birkhoff's Theorem still holds with the usual formulation, but such generalizedvarieties are not in general closedunder filtered colimits (a condition that alwaysholds for varietiesasdefined in
thispaper)H. ereisa simplexamplLe.etI ={ inlnGco}bea countabsleetof sorts
andlet 2;consisotfjusttwoconstantas,bof sorti0. LetX beanI-sortedsetwithjust onevariablfeoreachsortin andconsidethrevarietydefinedbytheequation
(VX) a = b.
ThealgebAra(sn)withA(n)i0=(a,abn}dwithA(n)ik=k{}Cif 0<k•<nand A(n)ik0=if k>n,areallinthevariedtyefinbedythaet quataionndforman
increasingchain whoseunion is clearly not in the variety. (iii) It is also easy to show the absenceof functionally free algebrasin certain
varieties.Given a set I-' of equations,[21 ] definesan algebraA to befunctionally free for I-' if an equation is satisfiedby A iff it is satisfiedby every algebrawhich satisfies all equationsin F. Our first example in Section 1.2 showsnot only that the ordinary rules of equational deduction are not sound, but also, contrary to the one-sortedcase, that there is no functionally free algebrafor somemany-sortedvarieties.The proof runs as follows' First observethat if there is a functionally free algebra,then there is a free algebrawhich is functionally free (this follows from the definition of functionally free and the fact that every algebrais a quotient of a free algebra).Next, for the first example of Section 1.2, observethat every free algebrawith no generatorsof sort a satisfiesthe equation
(V {{ A,A'},½)) A: A'
and therefore cannot be functionally free. Similarly, observethat every free algebra

COMPLETENESSOF MANY-SORTED EQUATIONAL LOGIC

327

with at least one generator of sort a will satisfy the equation
(VO) T= F.
Finally, note that neither of these equationsis true of every algebrasatisfyingthe
given equations.ß
The following notionsassociatedto an I-sortedsignature22will be needed:i C I
isquasi-isolatfeodr 22if andonlyif IF22(0)•il<1.i C I isstrictfor 2;if andonlyif IF22(0)i•[> 1.It iseasyto seethati • l isquasi-isolatiefdandonlyif:
(i) 122ile•,<1;and (ii) if thereexisot G22va,indr G22w,wi ithv,w=• e,v=iI '- -ik,w=j I "'Jm'
andwithiI .....ik andJl.....Jmallstrict,thentheyarealsoallquasi-isolatevd=,w,
o=r and22ie=, 0. It isalsoeastyoseethaitGI isstriciftandonlyifeithe(ri) 22e•,i0or(ii) theriesa w=iI..-ik•- esucthhat22w•,i0andil,...,ki areallstrict.
THEOREM 1. Let 22be an I-sorted signature. Then the following are equivalent:
(i)EvecrlyoncoengruFøe_nTCc•eisinitiafalliythful,'
(ii) Either every i C I is quasi-isolated,or every i G I is strict.
PROOF(i.i)=•(i):Leth:F22,F(-O• F) Z,F(Xcboe)theuniquheomomorphism. If IF22,F(O•<)i1[,thenhi isofcoursinejectivSeo.wecanreductoethecasienwhich alli • I arestricatndtherexisatsni • I sucthhatIF22,F(O>)1i[.Letthen[t],[t']• F22,F(iOa)ndsuppotsheath[t]=h[t'],i.e.,that(t,t')CFowi,forsomwe • I* If
w=ewearedonOet.herwleiwts=ei,l'"ik.Byhypothweehsaisvtiej• FZ(Of)oijr
1 •<j •<k. But, by condition(c) in the definition of Fø and the "invarianceof constant
functions," axiom (iv) in the definition of clones,this gives
(t,t'=) (t(ti,l...,tik),t.'.(.t.ti.ilk)6) r;,i,
i.e.,[t] = [t'] inF22,F(iOan) dhenchei isinjectire.
(i)=•(ii). Let 22bea signatusreuchthatthereexisit,j• I witht 4:t' CF22(0i )
andF22(O=)Oj .LetFøbetheclonceongruegnecneerabteydthesingelequatioFnii,= ((t,t')}.AsF22(0tr)ivialslyatisfiFejsi, wehavFe22(0F)=Z,F(Ob),utFøisnot initiallyfaithfubl ecausthee uniquehomomorphhis:Fm2;,F(O)•FZ,F(Xco)
identifies t and t'.ß

328 J.A. GOGUEN and J. MESEGUER
Recallthata 23-algebArais reachabl,eff thehomomorphisFm23(0)-A> is
surjective.We can now give the following model-theoretic version of Theorem 1'
COROLLARY. Let 23 be an I-sorted signature. Then the following are
equivalent.-
(i) EvecrlyoncoengruFøe_nICc2Zeisinitiafalliythful,'
(ii) Foreveryreachab2le3-algebAr,aif someAi isemptyt,hen[Ai[•<1fi?revery
PROOF.Sinceeveryreachablaelgebraisa quotienot f F23(0)(,ii) isequivalent
to
(iii) If somFe23(0i i)semptyt,henIF23(0)•i<l 1foreveryi.
This can be rephrasedby saying that if there is a non-strict sort, then all sorts are
quasi-isolated.Thus, (iii) is equivalent to condition (ii) in Theorem 1.w
We shall now characterize those signatures23for which every clone congruenceis
faithful.
THEOREM 2. Let F be an k-sortedsignature.Then the following are equivalent.'
(i) EvecrylonceongruFeøn_c_T2eCZisfaithful,'
(ii) Foreverwy GI* - {e}andi GI, wehaveFZ(Xwi)4=15; (iii)Foralli,jGI wehavFe23(Xi 4j=)O. PROOFB. ecausfoeranywGI* - {e} wehaveXi _CX_wCfori anyoftheletters
occurinign w,thisinduceasmapF23(Xi) ->FZ(Xw);therefor(eii) 4,(iii).
(i)=•(iii).Assumtheattherexisit•jGI sucthhatFz(Xji)=0-Thisimpliethsat F23(Xij=j)O,becautsheeriesahomomorpFhzis(rm):F23(X-j>j)F23j()Xinducbeyd
ß.
themarp:Xj-j>Xjwhicshenxdls,x•tox•fosr ojr,tanidstheidentmityafporthe
se0tinaltlheothseorrDtse.fiFnbeythseingeqleuaFtijoji=n,{(xi,xJW2)he}a. ve
Xjj__XCjji butFz(Xjj)satisfiFestriviallys,otheinducemdapF23,i,(XjjF)=23(Xjj)->
F2F3(,Xi)jijdentxifiiaensxdJa2ntdhereifsonroeitnjective.
(ii)=•(i).SupptohsaetthereexisFtøs_TC•noftaithfiu.el,.w, ehavve,wGI*
oo
andj GI suchthatXv_CXw,t,t'GF23(Xv()tj,,t')GFwdand(t,t')• Fvj•. Assume
v= e.Bythepreviouthseoremweconclud3ei CI suchthatFZ(0)i = O.Thisforces
F23(Xj)0i=asdesirebde, cauisfet"CF23(Xi jt)hent"(t)• FZ(0i)whichisa
contradiction. So we may assumev 4=e. As we saw in the proof of the Completeness

COMPLETENESSOF MANY-SORTED EQUATIONAL LOGIC

329

Theorem, the derived operations
F2;F,(Xv)v(Ft)2,;,F(Xv)vF(t2');F:,(X)vv• F2;F,(Xv)j
are necessarilydifferent. On the other hand we have
F2;,p(Xv)w=F(t2) ;,F(Xv)wF(t2');:,p(Xv-)>WF2;,p(Xj v)
byhypothNesoiwsif.v=i1'-oki thetnhisaytshaFt 2;,p(Xv=)/0i=mform=1,...,k
(otherwwiseewoulhdaveF2;,F(Xv=)0V,andthetwoderiveodperatiownosulbde
equaSl)in. cXevCXwwehavfeort,t'GF2;(Xv()Tj=Ej)avn, dxi,l...,iXl1ni
F2;(Xw=)Til2;iwl a, nxdi1k""' •nkik GF•2(Xw=)Tik•2w(,wikhearsbeefonriehisthe numboefor ccurreonficheinsv)thatthesubstitut=tiot(nxs,l.l..x.inkik)t,'=
t,(x.i..l,.lXinkki)GF2;(Xj =wT)2;jwar, etransfoinrmtsoeudbstituotffiuonncstbioyns
theclonme apF2;,F(XvT):2-;• O(F2;,F(X).vI)nothewr ordsw,ehavtehediagram
F2;,p(X)wv•

(1ir1.r.r.•'r.l.•kF)Z,Ft,(Xv)w( F2;,r,(Xv) v(t F2;,F()Xvv & >F) 2;,r(Xj v) FZ,F(Xv)v(t')
Conseqtuheefnutnlyct(iror1n•-,.-;irknikc)annboesturjecBtiuvatest.hearerneo
repeavtaerdiaibntlheselisxtl,l...,xinkthiiskcan only happen if for some index i
occurringw(andnotoccurringv)wehavFe2;,F(Xi v=)0.HencFe2;(Xiv=)
COROLLARY. Conditions (i) - (iii) in Theorem 2 are all equivalent to the
following model-theoreticcondition:
(iv) Forevery2;-algebAra, if someAi isempty,theneveryAi isempty.
PROOF. (ii)• (iv) is exactly (2)• (3), given in the proof of Theorem 3 in
Section 5..
REMARK. Condition (iii) in the last theorem is automatically satisfied if the
signature2; is "strict," i.e., if everyi G I is strict. Strictnessis not necessaryfor (iii) to
holdt:akeforexampIl=e,{a,b}2, ;a,=b{c•}a, nd2;b,=a{r}.Howeviefcr,ondition
(iii) holds and one of the sortsis strict, then all the sorts(and hence2;) are strict. To
seethisa,ssumt GeF2;(0i=) T2;iea, ndforeacjhGI lett'GF2;(Xji=) (T•)ii,.Then

330 J.A. GOGUENandJ. MESEGUER

t'(t)G(Tz)ej ,=FZ(0j). HencFeZ(0j)%0-
5. One-sortedrepresentationof many-sortedalgebras.In his commentsto a previous draft of this paper, Professor Saunders Mac Lane kindly brought to our attention Barr's paper [1]. This section explains the relationshipbetween Barr's results and those in Section 4. The outcome of this comparison can be informally summarizedin the following statement which further clarifiesthe differencesbetween one-sortedand many-sorted algebras:
For a many-sortedsignature Z the following are equivalent: 1. The ordinary rulesof equationaldeductionaresoundand complete. 2. •-algebras can be "faithfully represented"as one-sortedalgebras. We will presently make precisethe meaningof "faithfully represented"in the above statement. Let 2; be an I-sorted signature.Then there is a "forgetful functor"
UZ:AlgZ-->SeIt

sendingeach Z-algebraA to its underlying1-sortedset { Ai} and each Z-homomorphfistomitsunderlyinI-gsortefdunctio{nfi}' ForavarietAy lgzF, this
forgetful functor restricts to a functor
UZ,FA:lgz•,FSeI.t
There is alsoa "product functor"
l-I:SeIt-->Set,

sendinegachI-sortesdet{Ai} tothecartesiapnroducIt1Ai andeachI-sortefdunction

{ fi} tothefunctionfi.

DEFINITIONF.or Z andI-sortedsignaturae,varietyAIgzF, definedby
equations F isfaithfully representableby one-sortedalgebrasif there is a one-sorted

varietyAlgz,,F, andan equivalen[c1e8] of categoriVe:sAIgz,F->AIgz,,F,
(calledthe representationfunctor) suchthat the following diagramcommutes:

V

AIgzF,

>A!gz*,F*

UZI 'F U2;*'F* SetI ) Set II

COMPLETENESSOF MANY-SORTEDEOUATIONAL LOGIC

331

Thisdefinitionrequiresthat for eachalgebraA in thevarietywecanput analgebraic

structuroentheproducIt-IAi (itsrepresentatiionna)"faithfuwl ay,"i.e.,onesuch
that the original many-sortedalgebra can be recoveredfrom its one-sorted

representationM. oreover,the definition assertsthat the collectionof all those

representationasndtheirisomorphicopiesisa varietyof one-sorteadlgebras.

REMARK. Althoughthis fact will not be usedin the sequel,we note that if

AIgz,,aFn, AdIgz;$a,rFetw$ ovarieotifoesne-soarlgteedbrerapsreseAnlgtFizn,g thetnheclonTeEs,,Fa,nTdE$$,mF ubsetisomoarpnhtdhicims aktehsvearieties
themselvesisomorphicover Set [ 16].

Wenow summarizethoseconceptsandresultsof [ 1] whichdirectlytouchon the

representabiliptyroblem.Barr'sresultsareverygenerala, ndoursummarywill only

coverthe applicationdsevelopedin the lastsectionof hispaper.Barrcallsa Z-algebra

A = {Ai }pureif andonlyif eitherallthesetsAi areemptyorallarenonemptyF.or

AIgz;,aFvariettyh,efullsubcategfoorrmy ebdyitspurealgebrisadsenotePdAlgz;,F. PAlgz;i,sFnotavarietoyfAlg1u2nlesitscoincidweisthAlgz;,iFtselbf;utwedohave
the following

THEOREM([1T,heorem5]). Tirereis a varietyAIg2j,,F,of one-sorted

algebrasndan equivalenocfecategoriVe:sPAIgzF,->AIgz,,F,suchtltatthe

following diagram commutes
PAlgzF,

V

) Algz,,F,

Algz;,F

US*,F*

SetI ) Set
El
REMARKS. (i) The needto restrictto purealgebrasis is due to the fact that all
informatioanboutanalgebrAa = (Ai } is lostin theproducrtIAi whenoneof the
componeAnjitssemptayndanothAekrisnots, inctehenIIAi=0.
(ii) To makethe expositionsimpler,wehavechangedthe originalformulationof

332 J.A. GOGUEN and J. MESEGUER
Barr's Theorem. Although it is not used in what follows, we summarize here the technicalreasonswhy our formulation follows from Barr's:
1. Up to isomorphism of categories,a monadic (tripleable) functor U: K-> Set -- --
thatpreservfeilsteredcolimitisoftheformU2;,,F,:Alg2;,,F•, Setforsome
one-sortedsignatureZ* and equationsF* [9], Satz 10.3.
2.ThfeunctHor:SseI•t SeatnUdZ,FA:IgFz-,>SeI tpresefrilvterceodlimits
[18]andPAIgzF,iscloseudndefrilterecdolimitinssidAeIgzF, .
The property
PAlgzF, = Algz,F
doesnot dependon F, i.e., it holdsif and only if
PAlgZ = AlgZ
does. This is so becauseif a Z-algebra is not pure, then none of its quotients is pure
eitherT.husforanyF,Alg2V, willcontaiannonpuraelgebrifaf Alg•doesW. ecan
now establish the connection between Barr's results and those of Section 4.
THEOREM 3. Let • be an I-sorted signature.Then the following are equivalent.'
1.EvecryloncoengruFe_nTC2c•iesfaithful,'
2. ForeverywEI* - (e} andi EI wehaveF2(Xwi):/:0;
3. PAlg•= Alga;
4. EachvarietAylgaF, __AClg•isfaithfullryepresenbteydone-sortaeldgebras.
PROOF. (1) o (2) wasprovedin Theorem 2. We claim that (2) o (3). (3) =• (2) follows easily from the definition of pure algebraand is left to the reader. To see that (2)=• (3), first notice that, sincepure algebrasare closedunder quotients and every algebrais a quotient of a free one, it is enough to show that all free algebrasare pure. Then, recall that, as already stated in the last remark, pure algebras are closed under filtered colimits. Since every free algebrais a filtered colimit of finitely generatedfree algebras,it will suffice to show that all finitely generatedfree algebrasare pure. Condition (2) impliesthat all finitely generatedalgebrasare pure, except perhapsfor the initial algebra.The proof that (2) implies that the initial algebra is pure was already given (but without that terminology) in the last remark of Section 4. (3) =• (4) follows from Barr's Theorem above,so we will finish the proof if we

COMPLETENESSOF MANY-SORTED EQUATIONAL LOGIC

333

show that (4) =• (3). Supposethat (4) holds and let A be a nonpure Z-algebra. Then
IIAi--0,butsomAej:/:0.Thisgiveascontradictsioinnc,we ecanthenexhibaitn algebrAa' sucthhatA• A'butsuchthatIIAi'--0.Indeedif,Ajhasmorethanone
element, we can form a quotient of it identifying all the elementsof sortj; otherwise,
letx beavariabloef sorjt andletA'-- F•(A ß (x•), whereAß (x• isthel-sorted setobtainebdyattachinxgtothecarrieorfA.SinctehecardinaloitfyAjisdifferent
fromthatofF•(At9(x•})wj ehavAe• A'.HowevAer'i,sanonpuarlegebsrain, ce wecangeat surjecthivoemomorpt'h•:iFs•m;(A• •x•)-->AinducbeydtheI-sorted mapf:Aß •x•-->AthatistheidentitoynAandmapxstotheonlyelemeonftAj.m
ACKNOWLEDGEMENTS. We wish to thank Gerard Huet for stimulating our
curiosity about the anomaliesof many-sortedequationallogic. A previousdraft of the paper benefitted from the criticism of Professor Saunders Mac Lane who led us to explore the connections with the work of [1], and pointed out that similar
precautionshad been taken by [3] in the context of higher-order logic. We are also grateful for the excellent comments of an anonymousreferee, leading to substantial improvements in the exposition. Finally, we wish to thank Kathleen Goguen for
extensivehelp with preparation of the manuscript.

REFERENCES
1. Barr, M., The point o.f the empty set, Cahiersde Topoloeie et GeometrieDifferentielle, 13(1972), 357-368. Benabou,J., Structuresalgebriquesdar•vles categoriesC, ahiersde Topologieet Geometrie Differentiel,10(1968), 1-126. Boileau,A., andJoyal,A., La LogiquedesTopos,J. SymbolicLogic,46(1981), 6-16. Burstall, R. M., and Goguen,J. A., The Semanticsof Clear, a SpecificationLanguage,in Proceedingsof the 1979 CopenhagenWinter School on Abstract Software Specification, Springer-Verlag1,980, 292-332, LectureNotesin ComputerScience,Volume86.
5. Burstall, R. M., and Landin, P. J., Programsand their Proofs: an AlgebraicApproach, in B. Meltzer and D. Michie (eds.), MachineIntelligence4, Universityof EdinburghPress,1969,
17-43.
Cohn,P.M., UniversalAlgebraH,arperandRow, 1965,Rev.ed., 1980. Ehrich,H.-D., On the theoryof specificationi,mplementationandparameterizationof abstract datatypes,J of Assocf.or ComputingMachinery2, 9(1982), 206-227. Ehrig,H., Kreowski,H.-J., andPadawitz,P.,AlgebraicImplementationof AbstractData Types, TectmicaRl eport,TechnicaUl niversityof Berlin,1979. Gabriel,P., and Ulmer, F., Lokal PrasentierbarKe ategorien,LectureNotes in Math., Vol. 221, Sr•ringer-Verlag1,971. 10. GoguenJ, . A., andBurstall,R. M., IntroductingInstitutions,in E. ClarkeandD. Kozen(eds.),

334 J.A. GOGUEN and J. MESEGUER

ProceedingsL, ogicsof ProgrammingWorkshop,Springer-VerlagL, ecture Notes in Computer Science,Vol. 164, 221-256. 11. Goguen,J. A., and Meseguer,J., UniversalRealization,PersistentInterconnectionand Implementation of Abstract Modules, in Proceedings,9th International Colloquium on Automata, Languagesand ProgrammingL, ectureNotesin ComputerScience,Springer-Verlag,
1982.

12. Goguen, J. A., Thatcher, J. W., and Wagner, E., An Initial Algebra Approach to the

Specification,CorrectnesasndImplementationof AbstractData Types,in R. Yeh (ed.), Current

Trendsin ProgrammingMethodologyP, rentice-Hall,1978, 80-149;OriginalVersion,IBM, T. J.

WatsonResearchCenterTechnicalReportRC 6487, October,1976.

13. Guttag,J. V., TheSpecificationandApplicationto Programmingof AbstractData TypesP, hD.

ThesisU, niversityof Toronto,1975,ComputerScienceDept.,ReportCSRG-59.

14. Higgins,P. J., Algebraswith a schemeof operatorsM, athematischeNach.,27(1963), 115-132.

15. Kutzler, B., and Lichtenberger, F., Bibliography on Abstract Data Types,

Springer-Verlag1,983, Informatik-FachberichteV,olume68.

16. Lawvere, F. W., Functorial Semanticsof Algebraic Theories,ProceedingsN, at'l. Acad. of

Sciences5,0(1963),Summaryof Ph.D.ThesisC, olumbiaUniversity.

17. __,

Introduction, in Model Theory and Topoi, Lecture Notes in Math., Volume 445,

Springer-Verlag1, 975, 3-14.

18. MacLane,S., Categoriefsor the WorkingMathematicianS, vringer-Verlag1,971.

19. Meseguer,J., and Goguen,J. A., Initiality, Induction and Computability,in M. Nivat and J.

Reynolds(eds.),AlgebraicMethodsin SemanticsC, ambridgeUniv.Press1, 985.To appeara, lso

availableasSRI CSLTechnicalReport 140, December,1983.

20. MossesP, ., Modular DenotationalSemantics,TechnicalReport, AarhusUniversity,Computer

ScienceDept., Aarhus,Denmark, 1979.

21. Tarski,A., A remarkon functionallyfree algebrasA, nnalsof Math., 47(1946), 163-165.

22. Zilles,S., AbstractSpecificationof Data Types,TechnicalReport119,ComputationStructures

Group,MIT, 1974.

SRI Intemational
Menlo Park, California 94025

Stanford University Stanford, California 94305

ReceivedJune 15, 1982 RevisedVersionReceivedSeptember8, 1984

