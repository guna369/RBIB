Canonical Sets of Horn Clauses
Nachum Dershowitz Department of Computer Science
University of Illinois 1304 West Spring eld Avenue
Urbana, IL 61801, U.S.A.
email: nachum@cs.uiuc.edu

1 Background

Rewrite rules are oriented equations used to replace equals-by-equals in the speci ed direction.

Input terms are repeatedly rewritten according to the rules. When and if no rule applies, the

resultant normal form is considered the value of the initial term. If no in nite sequences of

rewrites is possible, a rewrite system is said to have the termination property. Con uence of

a rewrite system is a property that ensures that no term has more than one normal form. A

convergent rewrite system is one with both the con uence and termination properties.

Let T be a set of  rst-order terms, with variables taken from a set X , and G be its subset

of at

ground variable-free terms. If t is position  and by t s  or simply t

a term in T , s  we denote

by tj t with

we its

signify the subterm of t subterm tj replaced by

rooted a term

s. We use the following notations for equational deduction: s ' t stands for the usual sense of

eeoqqriuueaanlltisatytiuoisnninlogofgeiacqaurleawstyirosintteeemrus; ;less!$inReRtt;oosrr

just s just s ! t,

$ !
for

t denotes one step of replacement of equals for t stands for one replacement according to the any number including zero of rewrites; s $ t

also stands for one rewrite step in either direction. Two terms s and t are said to be joinable if

there is a term v such that s ! v  t, or s  t for short. For convergent R, an identity s ' t

holds in the theory de ned by R each rule viewed as an equation if and only if the normal

forms of s and t are identical. Thus, validity of equations is decidable for nite convergent R,

since the joinability  relation is decidable. A ground convergent rewrite system is one that

terminates and de nes unique normal forms for all ground terms. Ground convergent systems

can be used to decide validity by skolemizing s and t and reducing to normal form. For a survey

of the theory of rewriting, see Dershowitz and Jouannaud, 1990 .

A conditional equation is a universally-quanti ed de nite Horn clause in which the only

predicate symbol is equality.
meaning that equality s ' t

We write such holds whenever

a clause in the form e1 ^    ^ en  s all the antecedent equations ei, hold.

' t n  0, The term s

will be called the left-hand side; t is the right-hand side; and the ei are the conditions. If n = 0,

then the positive unit clause will be called an unconditional equation. Conditional equations

are important for specifying abstract data types and expressing logic programs with equations.

A conditional rewrite rule is an equational implication in which the equation in the conse-

quent s ' t is oriented. To give operational semantics to such a system, the conditions under

which a rewrite may be performed need to made precise. The most popular convention see

Dershowitz and Okada, 1990  for conditional rewriting is that the terms in each condition be

This research supported in part by the National Science Foundation under Grant CCR-9007195.

joinable. stance l

Thus, of the

a rule u1 left-hand

' v1
side,

^
if

 ui



^uvni

' vn  l
for each

! r, is applied to a condition ui ' vi, in

term t containing an inwhich case t l ! t r .

We call sets of such rules standard conditional rewrite systems; they provide an applicative

programming language with especially clean syntax and semantics, and can be extended to logic

programming paradigms. The ground normal forms of ground convergent conditional systems

form an initial algebra for the underlying system of conditional equations. In fact, a rst-order

theory admits initial term models if and only if it is a universal Horn theory see Makowsky,

1985 . In this sense, ground convergent conditional rewriting implements the initial-algebra

semantics for operations constrained by conditional equations.

One of the basic results in unconditional rewriting is the Critical Pair Lemma Knuth and

Bendix, 1970 , which states that con uence of  nite terminating systems can be e ectively

tested by checking joinability of a nite set of equations, called critical pairs", formed by

overlapping left-hand sides. In the conditional case, we propose the following de nition: Let be

some partial ordering on ground terms with the replacement" property, s t implies u s u t

for all contexts u  . We write s t for nonground terms if s t for all ground substitutions

and s 6 t if s 6 t for some . If p  l ' r and q  u ' v are conditional equations, then the

cvuoian6dmitopisotn;gaqelneeqmruaaelatuinoniningperth^matqguu isuwniotrthsamna'ollnevvratrhiisaabanlneansouyrbdsteiedrreemdoufcjaonnodifniutsit,oaunnatli6actrevidtic;cauolnpdaritirioni,f

l uni es and also in p or

q. It was shown in Dershowitz et al., 1987 that there exists a terminating conditional rewrite

system all critical pairs of which are joinable, but which is not con uent. On the other hand,

when the conditional system is such that recursively evaluating the conditions also terminates,

the critical pair condition su ces. More precisely, we say that a conditional system is decreasing

if there exists a well-founded extension of ! in other words, rewriting always reduces terms

in the ordering with two additional requirements: has the subterm" property each term is

greater under than its proper subterms and conditions for rule application are smaller than

the term that gets rewritten for each rule c  l ! r and substitution , u l c . For

such decreasing systems, all the basic notions are decidable, i.e., the rewrite relation, joinability

relation, and normal form attribute are all recursive. Decreasing systems generalize the concept

of hierarchy" in Remy and Zhang, 1984 , and are slightly more general than the simplifying"

and reductive" systems considered in Kaplan, 1987 and Jouannaud and Waldmann, 1986 ,

respectively. In fact, it can be shown Dershowitz and Okada, 1990 that decreasing systems

exactly capture the niteness of recursive evaluation of terms. Thus, they are ideal for most

computational purposes.

It is well known that any conditional equational theory is expressible as a set of universally

quanti ed Horn clauses in which the equality symbol is uninterpreted, since the axioms of

equality are themselves Horn. Thus, positive-unit resolution, or any other variation of resolution

that is complete for Horn clauses, could be used to prove theorems in equational Horn theories,

but the cost of treating equality axioms like any other clause is prohibitively high. For this

reason, special inference mechanisms for equality, notably paramodulation Robinson and Wos,

1969 , have been devised. In recent years, term orderings have been proposed as an appropriate

tool with which to restrict paramodulation. On the ip side, any Horn theory can be expressed

as an unconditional equational theory. Some of the implications of this correspondence are

explored in Section 2.

In Knuth and Bendix, 1970 , it was suggested that a noncon uent unconditional system be

completed" by adding new rules according to some user-supplied partial ordering whenever

a critical pair fails the joinability test. When this process succeeds, a nite set of equations is

obtained from which all theorems follow by rewriting. Completion, as de ned in Knuth and

Bendix, 1970 and studied in Huet, 1981 , fails when a critical pair, after its two sides have

been reduced to normal form, is neither trivial nor orientable by the ordering supplied to the procedure for this purpose. Completion was rst extended to conditional equations by Kaplan 1987 . Equations are turned into rules only if they satisfy a decreasingness condition. The problem is that the critical pair of two decreasing rules can easily be nondecreasing. Ganzinger 1987 suggested narrowing the conditions of nondecreasing rules. Like standard completion, both these methods may fail on account of inability to form new rules. In Section 3, we extend these methods|analogous to unfailing ordered completion as described in Bachmair et al., 1989 |to provide an ordering-based theorem-proving method.
As in Hsiang and Rusinowitch, 1986; Kounalis and Rusinowitch, 1987; Zhang and Kapur, 1988; Rusinowitch, 1989; Bachmair and Ganzinger, 1990; Nieuwenhuis and Orejas, 1990; Dershowitz, 1991 , our goal in developing theorem proving procedures is to minimize the amount of paramodulation, while maximizing the amount of simpli cation, without threatening completeness thereby. Orderings are used to choose which literals participate in a paramodulation step, and which side of an equality literal to use. Our method also allows for almost unrestricted simpli cation demodulation by directed decreasing equations. It requires less paramodulation and o ers more simpli cation than Kounalis and Rusinowitch, 1987 , for example. For our completeness proofs, we adapt the proof-ordering method of Bachmair et al., 1986; Bachmair and Dershowitz, to appear to conditional proofs using an ordering that is much simpler than the one in Ganzinger, 1987 .
A reduced rewrite system is one such that each right-hand side is in normal form, as are proper generalizations and proper subterms of all left-hand sides. For convergent systems, this is equivalent to the de nition in Huet, 1981 which requires that left-hand sides not be rewritable by other rules. Reduced convergent systems are called canonical in Dershowitz and Jouannaud, 1990 . If two canonical systems have the same equational theory and are contained in the same well-founded ordering, then they must be literally similar i.e. the same except for variable renamings. This important result was rst mentioned in Butler and Lankford, 1980 . It means that all implementations of standard completion must yield the same system, given the same inputs E and , provided they use the encompassment relation Dershowitz and Jouannaud, 1990 for simpli cation of rules. In our view, simpli cation in completion is intimately related to reduction: by striving to nd the unique reduced convergent systems, necessary simpli cations are illumed. To guide the choice of simpli cation strategies for conditional completion, we develop, in Section 4, a notion of reduced conditional system, and look for an appropriate uniqueness result. Only in circumstances that ensure that a convergent system will be found whenever there is one, do we consider it reasonable to refer to a conditional inference mechanism as completion", rather than theorem proving".

2 Horn theories

We begin our discussion with Horn clauses not containing interpreted equality symbols. Any

Hpu1noc^ronn dcliat^iuospnena.lp1rSe^iwncreitet^hrepunlleeftp-1hq^anisd

logically equivalent side is longer than
 ^ pn ^ q ! p1 ^ 

to the equivalence p1 the right, we view this   ^ pn, with the order

^    ^ pn ^ q 
as a terminating of conjuncts left

intact. Let H be a set of Horn clauses and ! be the corresponding rewrite relation. The

completeness of selected positive-unit SPU resolution means, in this framework, that, for an

arbitrary conjunction P of atoms, H ` P by rst-order reasoning if and only if P ! T ^  ^T

can be derived from rules generated in the following manner:

From p ^ s ^ q ! p ^ s and p0 ! T, where atoms p and p0 are uni able with most general uni er , q is any atom, and s is any conjunction of atoms, infer s^q ! s. When s is empty, this is q ! T.

For example, from the two Horn clauses

pa ! T px ^ pfx ! px

all pfia ! T are generated, one after the other.

The above inference rule is su cient for completeness, but our goal is to allow as much

simpli cation as possible. In particular, given a rule p ^ q ! q, or even p ^ r ! r, we are

tempted to simplify a clause like p ^ q ^ r  p ^ r to q ^ r  p ^ r. The problem is that the

latter has sides of equal length, and cannot, in general, be oriented into a rule e.g. if p is x y

and q is y x. Hence, adding simpli cation would lead to incompleteness of this inference

mechanism.

To recover completeness, we need inferences that apply to more general equivalences between

conjunctions. The idea is to apply the ordered completion method for unconditional equations

in Hsiang and Rusinowitch, 1987; Bachmair et al., 1989; Dershowitz and Jouannaud, 1990 to

these equivalences. There is no need to use Boolean identities hence no need for associative-

commutative uni cation, since reasoning equationally with these equivalences su ces; the only

Boolean rule needed is T ^ x ! x. This results in a better method than the one in Bachmair

et al., 1989 for Horn clauses, since more simpli cation is possible. Additional optional simpli -

cation strategies may be incorporated in this theorem proving strategy, just as long as they are

sound and do not make more complex proofs necessary cf. Section 3.

A total ordering on ground terms G is called a complete simpli cation ordering if it

has a the replacement property, s t implies u s u t for all contexts u  , and b the

subterm ordering

property, t 
Dershowitz,

tj for
1982 .

all A

subterms tj of t. Such a ground-term
completable simpli cation ordering on

ordering must be
all terms T cf.

a wellHsiang

and Rusinowitch, 1987  is a well-founded partial ordering that c can be extended to a

complete simpli cation ordering on ground terms, such that d s t implies that s t

for all ground substitutions . Furthermore, we will assume that e the truth constants T and

F are minimal in . Of course, the empty ordering is completable, as are the polynomial and

path orderings commonly used in rewrite-based theorem provers see Dershowitz, 1987 . By

results in Bachmair et al., 1989 , providing ordered completion with a completable simpli cation

ordering is guaranteed to succeed in nding a canonical system for the given theory, if one exists

that is compatible with the given ordering.

Ordered completion|with simpli cation|is likewise guaranteed to derive a contradiction

from Horn clauses H and the Skolemized negation of an atomic formula p such that H ` p.

The point is that the only Boolean equation used implicitly in the above SPU-mimicking

inference rule is T ^ x ' x, from which it follows that the equational representation of H plus

this Boolean equation provides an equational proof of p ' T. The completeness of ordered

completion for equational reasoning Bachmair et al., 1989 means that the contradiction F ' T

will be generated from these equations plus p^ ' F, where p^ is p with its variables replaced by

Skolem constants.

Rather than give the general case which is no di erent from ordinary ordered completion|

except that associative-commutative matching can, but need not, be used when simplifying

one rule via another, we show here how simpli cation provides, in the propositional case, a

quadratic algorithm to convert a set of ground Horn clauses to a unique representation in the

form of a unconditional canonical rewrite system. Given any well-ordering of atoms, de ne a

well-ordering on conjunctions under which longer conjunctions are bigger, and equal-length ones are compared lexicographically. The algorithm operates on Horn clauses expressed as equivalences:
Repeat the following, until no longer possible: Choose the equivalence p  q or q  p that has not yet been considered such that q is minimal among all sides vis-a-vis the total ordering . If all the atoms in p occur together on one side r of any other equivalence r  s or s  r, remove them from r and merge what is left in r with the atoms in q. Delete duplicate atoms and occurrences of the constant T unless T is the only atom from all equivalences. Discard equivalences with identical
sides and duplicate equivalences. For example, the rst clause of
p ^ q  p; p ^ q  q; p ^ q ^ r  p ^ q rewrites the others assuming p q r to q  p and p ^ r  p. Then, the rst becomes p ^ p  p and is deleted, leaving the Horn clauses p  q, q  p, and p  r.
This algorithm is based on the completion-based congruence closure method in Lankford, 1975 , shown to be doable with low polynomial time complexity in Gallier et al., 1988 . By the theorem in Lankford and Ballantyne, 1983 for uniqueness of canonical associative-commutative rewriting systems, it results in a unique set of equivalences, determined by the ordering . The resultant system can be used to decide satis ability in the given propositional Horn theory, though not as fast as in Dowling and Gallier, 1984 . The equivalences can optionally be converted back to Horn form.
3 Completion
In this section, we turn to Horn clauses with equality, that is, to conditional equational theories. For e ciency, it is unreasonable to just add axioms of equality and use Horn-clause theorem-proving methods. Instead, we develop an unfailing completion procedure for conditional equations, based on the incomplete method in Ganzinger, 1987 . Complete, orderingbased theorem-proving methods for such theories include Kounalis and Rusinowitch, 1987; Dershowitz, 1991 . The allowable inferences are a stringent restriction of paramodulation. A user-supplied ordering is used to guide the inference mechanism, so that only maximal terms are used in any inference step. When is the empty ordering, the method reduces to special" paramodulation, in which the functional-re exive axioms are not needed and paramodulation into variables is not performed see Lankford, 1975 . Most important, a nonempty ordering allows conditional equations that are simpli able to be replaced without compromising refutational completeness. Hence, the power of the method, both in minimizing possible inferences and maximizing potential simpli cations, is brought to bear by employing orderings that are more complete than the empty one. The method is like the one in Bertling, 1990 , but we give a speci c strategy for simpli cation.
Given a set E of conditional equations, a proof in E of an equation u ' v is a sequence of terms u = t1 $ t2 $    $ tn = v n  1, each step tk $ tk+1 of which is justi ed by an appropriate conditional equation in E, position in tk, substitution for variables in the equation,
and subproofs for each of its conditions. Steps employing an unconditional equation do not have
subproofs as part of their justi cation. Any equation s ' t that is valid for E is amenable to such an equational proof. Note that a conditional equation e1 ^   ^ en  s ' t is valid for E if

and only if s ' t is valid for E fe1;   ; eng. Hence, proving validity of conditional equations
reduces to proving validity of unconditional ones.
We write u !e v with respect to a partial ordering , if u $e v using an instance p  s ' t of e, and u v; p by which we mean that u is bigger than v and bigger than both sides of each condition in p. A conditional equation may have some ground instances that are decreasing in the complete ordering if s t; p, and others that are not decreasing. The Critical Pair Lemma
of Kaplan, 1987 for decreasing systems can be adapted to ground con uence of decreasing systems:

Let E be a set of conditional equations and a completable simpli cation ordering. If all ground instances of ordered conditional critical pairs rewrite, under !E, to the identical term, then the system is ground con uent.

However, a counterexample in Dershowitz et al., 1987 shows that this critical pair condition is

insu cient when rewriting by nondecreasing instances of equations is included.

We formulate our theorem-proving procedure as an inference system operating on a set of

conditional equations, and parameterized by a completable ordering . The rules may be classi-

ed into three expansion" rules and four contraction" rules. The contraction rules of standard

completion signi cantly reduce its space requirements, but they make proofs of completeness

much more subtle.

The rst expansion rule generates critical pairs from clauses that may have decreasing in-

stances:

E

8 :

E p

 p  l ' r;  qu'v p  l ' r; q  u ' v;
^ q  u r  '

v

9 = ;

if

8 :

uuj=6 62mpXgu;quj;v; l; u r 

A

Superposition i.e. oriented paramodulation of positive equational literals is performed only

at in

nonvariable positions a decreasing direction

uj u

62 6

X . Only positive equations are used in this rule, p; q. Of course, if the relation 6 is not known

and only precisely,

one must be conservative and apply the inference whenever it cannot be guaranteed that all

ground instances of u are larger than the corresponding instances of p, q, v, and u r .

Either side of an equation may be used for superposition, but only if, in the context of the

paramodulation, it is believed to be potentially the This can probably be strengthened a bit to require

largest term involved u l 6 p instead of u 6

6

v; p.

u r . Now and

henceforth, when a rule refers to a clause of the form q  u ' v, an unconditional equation

u ' v is also intended.

We need, additionally, a rule that applies decreasing equations to negative literals:

E

8 :

E p ^

 q

q ^

p ^s't
q^ s r 

 
p s't ' t

l ' r;  u'v  l ' r;  u ' v;  u ' v

9 = ;

if

8 :

ssj=6 62mpXgu;qsj;t;l; s r 

B

Whenever this or subsequent rules refer to a conditional equation like q ^ s ' t  u ' v, the intent is that s ' t is any one of the conditions and s is either side of it.

The last expansion rule in e ect resolves a maximal negative literal with re exivity of equals

x ' x:

E E

n q

q^ ^s

s' 't q

t

  

u'v u ' v;

o 

u ' v

if



 = mgus; t s 6 q

C

The four contraction rules all simplify the set of conditional equations. The rst two eliminate

trivial equations:

E n q  u'u o

E

n E

q

n^

s q

E 's


 u

u 'v

'o

v

o

D E

The last two use decreasing clauses to simplify other clauses. One simpli es conditions; the

other applies to the equation part. In both cases, the original clause is replaced by a version

that is equivalent but strictly smaller under .

E E

n n

p

q

 

u u

' '

v v

o o

if

p !E q

F

In simplifying equations, we utilize an extension of the encompassment ordering from

terms to clauses in which terms are larger than proper subterms and smaller than proper

instances: Terms are compared with ; equations are compared by comparing the multiset

of their Manna,

two terms 1979 ; to

in the multiset compare terms

extension mul with equations

of we

the term ordering see make s bigger than u

Dershowitz and
' v if s u; v;

nally, q  u ' v p  l ' r if q mul p, or q =mul p i.e. q = p as multisets and u

encompassment ordering, or q =mul p, u = l, and v r.

E E

n n

q q

 

u w

' '

v v

o o

if



u q

!e u

w; e _v

2E u_

q



u

'

v

e

l in the G

Here q u means that there is always one side of one condition in q that is bigger than u; hence, the clause is nondecreasing.
As a simple example, consider the following three clauses:

0 c0 ' T cy cz ' y z cc0 x ' T  c0 x ' T

1 2 3

The rst two are decreasing; the third is not. We employ a straightforward ordering e.g. leftto-right lexicographic path ordering Kamin and Levy, 1980; Dershowitz, 1987 . Expansion inference A does not apply between 1 and 2, since 0 and cy do not unify. By the same token, B does not apply between 1 and the condition in 3. Applying B between 2 and 3 yields
c0 x ' T  c0 cx ' T

which contracts, using G and 2, to another nondecreasing clause

c0 x ' T  0 x ' T

4

Applying B to it yields a decreasing clause

0 x ' T  0 cx ' T

5

The critical pair obtained by superposing 1 on 0 cx gives a trivial equation contractable by D. Since 5 does not unify with the conditions of 3 and 4, we are done. Note that the decreasing rules 1,2,5 reduce any term ci0 cj0, such that i j, to T.
A valley proof s ' t is one in which the steps take the form s  t. We de ne a normal-form proof of s ' t to be a valley proof in which each subproof is also in normal form and each term in a subproof is smaller than the larger of s and t. Any non-normal-form proof has a
peak made from decreasing instances with normal-form subproofs, or has a nondecreasing step with normal-form subproofs, or has a trivial step. We say that a sequence of inferences is fair if expansions of all persistent conditional equations have been considered. Formally, that may
be expressed as expE1  Ei, where E0, E1, . . . is the sequence of conditional equations generated, E1 = lim sup Ej is the set of conditional equations that each persist from some Ej on, and expE1 is the set of conditional equations that may be inferred in one expansion step
from persisting equations. For a method based on these rules to be complete, we need to show that with enough inferences, any ground theorem eventually has a normal-form proof. Precisely stated:

If an inference sequence is fair, conditional equations, there is a

then for any normal-form

proof proof

of of

s s

' '

t in the initial set t in the limit E1.

E0

of

This is a consequence of the following observations: If E0 can be inferred from E, then for

any proof in E there exists a proof in E0 of equal or lesser complexity, and, furthermore, that

there are always inferences that can decrease the complexity of non-normal proofs. Complexity

may be measured by assigning to each step s $ t in a ground proof or its subproofs the weight

hfq1 ; . . .; qn ; sg; ei, where e is the conditional equation q1 ^    ^ qn  l ' r justifying the

step, is the substitution, and s is the larger of s and t in the complete simpli cation ordering

extending . Steps are compared in the lexicographic ordering of these pairs. The rst

components of pairs are compared in the multiset extension of the ordering on equations and

terms described above. Second components are compared using . Proofs are compared in the

well-founded multiset extension of the lexicographic ordering on steps. We use to denote this

proof ordering. It can be shown by standard arguments Dershowitz and Manna, 1979 that

is well-founded.

By induction with respect to , the eventual existence of a normal-form proof follows: If

P is a non-normal-form proof in E, there exists a proof P0, using equations in E and expE,

such that the complexity of P is strictly greater in the proof ordering  that that of P0. In

particular, trivial steps can be eliminated, reducing complexity by removing elements from the

multiset of proof steps. Peaks between decreasing steps will have smaller proofs on account of

inference rule A and the Critical step out of its largest condition p

Pair Lemma. breaks down

A nondecreasing into two cases: If

sttheepdsec!reeastinwgitshteapdpecr!easqinigs

in the nonsubstitution part of p , then an application of rule B supplies a new equation that

can be used in a step of smaller complexity since p , which was the largest element of the rst

component of the complexity of the place in the substitution part, then

sttheepresi!s aent,ailsterrenpaltaicveedpbryooqf.s

If the
! s0

decreasing
!e t0 

step takes t, where s

and t are rewritten by the same decreasing equation. The new e step is smaller that the old

one since its conditions are. Any new steps introduced are smaller than the eliminated cost of

p ! q, since they apply to terms smaller than p . Lastly, a nondecreasing step with trivial

subproofs can be replaced after generating a new equation using C.

The contraction rules were also designed to decrease proof complexity. Thus, any fair sequence of inferences must allow for a simpler proof, and eventually a normal-form proof must persist.
An alternative completion procedure may be based on the fact Dershowitz et al., 1987 that a system is con uent if all its critical pairs are joinable and are formed from overlaps between left-hand sides at their topmost position. In such a procedure, any non-root critical pair would
be eliminated by pulling out subterms. For example, the rules a ! b and hfa ! c overlap,
but not at the top. To get around that, the second rule can be replaced by the more powerful
x ' a  hfx ! c, eliminating the o ending pair. Note that interpreting Horn clauses as conditional rules rewriting predicates to T gives a system satisfying the above constraint,
because predicate symbols are never nested in the head of a clause. Furthermore, all critical pairs are joinable, since all right-hand sides are the same. This also applies to pattern-directed functional languages in which de ned functions are not nested on left-hand sides.
4 Uniqueness of Systems
In our view, there is a qualitative di erence between theorem proving and completion. As pointed out in Huet and Oppen, 1980 , completion is a compilation-like process; the goal is to nd a convergent system that can later be used to prove a certain class of theorems e ectively. A theorem prover is, accordingly, deemed complete" if it can prove any provable theorem in the class of theorems under consideration; a completion procedure, on the other hand, is complete" in the sense of Dershowitz, 1989  if it will nd a convergent system whenever there is one for the given ordering. The unit method of Dershowitz, 1991 , for example, should not qualify as a completion procedure for conditional rules, since it may go o producing perhaps in nitely many unconditional rules, even when one conditional rule su ces. For example,
given the con uent system fhfx ! hx; hx = ha  gx ! cg, it will proceed to add super uous consequences gfia ! c among others.
Suppose R is a convergent conditional rewrite system for some theory E and the rewrite relation !R is contained in a partial ordering . Then, the normal form of any term t is the element in the E-congruence class of t that is minimal vis-a-vis Avenhaus, 1986 . Hence, if R and S are two such systems for the same theory E and ordering , then R and S have the same normal forms and the same reducibility relation. We say that a term t is reduced, with respect to theory E and ordering , if, of all elements in its E-congruence class, it is minimal with respect to . An unconditional rewrite system is said to be reduced if, for each of its rules, l ! r, the right-hand side r is reduced and all terms s less than l in the encompassment ordering are also reduced. The contraction inference rules for unconditional systems see Bachmair et al., 1986  are themselves con uent", implying that the same reduced system is obtained regardless of the order in which they are appplied to a given con uent system.
Reduced unconditional systems are unique with respect to in the stronger sense that if R and S are canonical, have the same theory, and their rewrite relations are both contained in , then R and S are essentially identical cf. Butler and Lankford, 1980; Metivier, 1983 . We saw in Section 2 how this gives a unique representation for nonequational Horn clauses. But for conditional systems, reduction is clearly insu cient. For example, the two equivalent rules, a ' b  fa ! c and a ' b  fb ! c, are each convergent and reduced in the above sense. Applying the contraction rules of Section 3 to a set of conditional equations a process that will of necessity terminate is not enough for this purpose. One needs, rst of all, some sort of contextual rewriting" a la Zhang and Remy, 1985  to reduce the left-hand side of the rule so that it contains the smaller of the hypothesized-equal terms a and b. This suggests an additional

inference rule like:

E E

n n

q q

 

r s

o o

if r !e s; e 2 T hE

q

H

where T hE q is the set of equational consequences of E and q. But even this ine ective rule is insu cient, as can be seen from the following alternatives: a ' b ^ a ' c  fb ! c vs. a ' b ^ a ' c  fc ! c. If a b; c, we still need to choose between the minimal terms b and c.
Let p  l ! r be a conditional rule e in a system R. It is deemed reduced if r and all terms smaller than l in the encompassment ordering are reduced with respect to E^p, l itself is reduced with respect to R p , feg, and there is no logically weaker condition such that l is reducible. Let R and S be two reduced convergent conditional systems for E and . If p  l ! r is in R, then l ' r has a proof in S p. Even if we could show that l must be a left-hand side of a rule e0 in S which must have right-hand side r a question we leave open, the conditions in e and e0 may di er, and additional completion and simpli cation are required to preclude that. Imagine a rule p  l ! r. To get true uniqueness, one must complete the equations p modulo any other equations to nd a unique representation that is, the nite canonical system for p if one exists at all. Also, one would want to eliminate conditions of the form x ' t; otherwise, the conditional rule x ' a  fx ! b could be preferred over fa ! b.

Acknowledgment
I thank Subrata Mitra and the referees for their comments.

References
Avenhaus, 1986 Jurgen Avenhaus. On the descriptive power of term rewriting systems. J. Symbolic Computation, 2:109 122, 1986.
Bachmair and Dershowitz, to appear Leo Bachmair and Nachum Dershowitz. Equational inference, canonical proofs, and proof orderings. J. of the Association for Computing Machinery, to appear.
Bachmair and Ganzinger, 1990 Leo Bachmair and Harald Ganzinger. Completion of rstorder clauses with equality. In M. Okada, editor, Proceedings of the Second International Workshop on Conditional and Typed Rewriting Systems, Montreal, Canada, June 1990. Lecture Notes in Computer Science, Springer, Berlin.
Bachmair et al., 1986 Leo Bachmair, Nachum Dershowitz, and Jieh Hsiang. Orderings for equational proofs. In Proceedings of the IEEE Symposium on Logic in Computer Science, pages 346 357, Cambridge, MA, June 1986.
Bachmair et al., 1989 Leo Bachmair, Nachum Dershowitz, and David A. Plaisted. Completion without failure. In H. A
t-Kaci and M. Nivat, editors, Resolution of Equations in Algebraic Structures 2: Rewriting Techniques, chapter 1, pages 1 30. Academic Press, New York, 1989.
Bertling, 1990 Hubert Bertling. Knuth-Bendix completion of Horn clause programs for restricted linear resolution and paramodulation. In S. Kaplan and M. Okada, editors, Extended Abstracts of the Second International Workshop on Conditional and Typed Rewriting Systems, pages 89 95, Montreal, Canada, June 1990. Revised version to appear in Lecture Notes in Computer Science, Springer, Berlin.
Butler and Lankford, 1980 George Butler and Dallas S. Lankford. Experiments with computer implementations of procedures which often derive decision algorithms for the word problem

in abstract algebras. Memo MTP-7, Department of Mathematics, Louisiana Tech. University, Ruston, LA, August 1980. Dershowitz and Jouannaud, 1990 Nachum Dershowitz and Jean-Pierre Jouannaud. Rewrite systems. In J. van Leeuwen, editor, Handbook of Theoretical Computer Science B: Formal Methods and Semantics, chapter 6, pages 243 320. North-Holland, Amsterdam, 1990. Dershowitz and Manna, 1979 Nachum Dershowitz and Zohar Manna. Proving termination with multiset orderings. Communications of the ACM, 228:465 476, August 1979. Dershowitz and Okada, 1990 Nachum Dershowitz and Mitsuhiro Okada. A rationale for conditional equational programming. Theoretical Computer Science, 75:111 138, 1990. Dershowitz et al., 1987 Nachum Dershowitz, Mitsuhiro Okada, and G. Sivakumar. Con uence of conditional rewrite systems. In S. Kaplan and J.-P. Jouannaud, editors, Proceedings of the First International Workshop on Conditional Term Rewriting Systems, pages 31 44, Orsay, France, July 1987. Vol. 308 of Lecture Notes in Computer Science, Springer, Berlin 1988. Dershowitz, 1982 Nachum Dershowitz. Orderings for term-rewriting systems. Theoretical Computer Science, 173:279 301, March 1982. Dershowitz, 1987 Nachum Dershowitz. Termination of rewriting. J. of Symbolic Computation, 31&2:69 115, February April 1987. Corrigendum: 4, 3 December 1987, 409 410. Dershowitz, 1989 Nachum Dershowitz. Completion and its applications. In H. A
t-Kaci and M. Nivat, editors, Resolution of Equations in Algebraic Structures 2: Rewriting Techniques, chapter 2, pages 31 86. Academic Press, New York, 1989. Dershowitz, 1991 Nachum Dershowitz. Ordering-based strategies for Horn clauses. In Proceedings of the 12th International Joint Conference on Arti cial Intelligence, Sydney, Australia, August 1991. To appear. Dowling and Gallier, 1984 William F. Dowling and Jean H. Gallier. Linear-time algorithms for testing the satis ability of propositional Horn formulae. J. of Logic Programming, 13:267 284, 1984. Gallier et al., 1988 Jean Gallier, Paliath Narendran, David Plaisted, Stan Raatz, and Wayne Snyder. Finding canonical rewriting systems equivalent to a nite set of ground equations in polynomial time. In E. Lusk and R. Overbeek, editors, Proceedings of the Ninth International Conference on Automated Deduction, pages 182 196, Argonne, Illinois, May 1988. Vol. 310 of Lecture Notes in Computer Science, Springer, Berlin. Ganzinger, 1987 Harald Ganzinger. A completion procedure for conditional equations. In S. Kaplan and J.-P. Jouannaud, editors, Proceedings of the First International Workshop on Conditional Term Rewriting Systems, pages 62 83, Orsay, France, July 1987. Vol. 308 of Lecture Notes in Computer Science, Springer, Berlin 1988. Hsiang and Rusinowitch, 1986 Jieh Hsiang and Michael Rusinowitch. A new method for establishing refutational completeness in theorem proving. In J. H. Siekmann, editor, Proceedings of the Eighth International Conference on Automated Deduction, pages 141 152, Oxford, England, July 1986. Vol. 230 of Lecture Notes in Computer Science, Springer, Berlin. Hsiang and Rusinowitch, 1987 Jieh Hsiang and Michael Rusinowitch. On word problems in equational theories. In T. Ottmann, editor, Proceedings of the Fourteenth EATCS International Conference on Automata, Languages and Programming, pages 54 71, Karlsruhe, West Germany, July 1987. Vol. 267 of Lecture Notes in Computer Science, Springer, Berlin. Huet and Oppen, 1980 Gerard Huet and Derek C. Oppen. Equations and rewrite rules: A survey. In R. Book, editor, Formal Language Theory: Perspectives and Open Problems, pages 349 405. Academic Press, New York, 1980. Huet, 1981 Gerard Huet. A complete proof of correctness of the Knuth-Bendix completion algorithm. J. Computer and System Sciences, 231:11 21, 1981.

Jouannaud and Waldmann, 1986 Jean-Pierre Jouannaud and Bernard Waldmann. Reductive conditional term rewriting systems. In Proceedings of the Third IFIP Working Conference on Formal Description of Programming Concepts, Ebberup, Denmark, 1986.
Kamin and Levy, 1980 Sam Kamin and Jean-Jacques Levy. Two generalizations of the recursive path ordering. Unpublished note, Department of Computer Science, University of Illinois, Urbana, IL, February 1980.
Kaplan, 1987 Stephane Kaplan. Simplifying conditional term rewriting systems: Uni cation, termination and con uence. J. Symbolic Computation, 43:295 334, December 1987.
Knuth and Bendix, 1970 Donald E. Knuth and P. B. Bendix. Simple word problems in universal algebras. In J. Leech, editor, Computational Problems in Abstract Algebra, pages 263 297. Pergamon Press, Oxford, U. K., 1970. Reprinted in Automation of Reasoning 2, Springer, Berlin, pp. 342 376 1983.
Kounalis and Rusinowitch, 1987 Emmanuel Kounalis and Michael Rusinowitch. On word problems in Horn theories. In S. Kaplan and J.-P. Jouannaud, editors, Proceedings of the First International Workshop on Conditional Term Rewriting Systems, pages 144 160, Orsay, France, July 1987. Vol. 308 of Lecture Notes in Computer Science, Springer, Berlin 1988.
Lankford and Ballantyne, 1983 Dallas S. Lankford and A. Michael Ballantyne. On the uniqueness of term rewriting systems. Unpublished note, Department of Mathematics, Louisiana Tech. University, Ruston, LA, December 1983.
Lankford, 1975 Dallas S. Lankford. Canonical inference. Memo ATP-32, Automatic Theorem Proving Project, University of Texas, Austin, TX, December 1975.
Makowsky, 1985 J. A. Makowsky. Why Horn formulas matter in computer science: Initial structures and generic examples. In Mathematical Foundations of Software Development, pages 374 385, 1985. Vol. 185 of Lecture Notes in Computer Science, Springer, Berlin.
Metivier, 1983 Yves Metivier. About the rewriting systems produced by the Knuth-Bendix completion algorithm. Information Processing Letters, 161:31 34, January 1983.
Nieuwenhuis and Orejas, 1990 Robert Nieuwenhuis and Fernando Orejas. Clausal rewriting. In S. Kaplan and M. Okada, editors, Extended Abstracts of the Second International Workshop on Conditional and Typed Rewriting Systems, pages 81 88, Montreal, Canada, June 1990. Concordia University. Revised version to appear in Lecture Notes in Computer Science, Springer, Berlin.
Remy and Zhang, 1984 Jean-Luc Remy and Hantao Zhang. REVEUR4: A system for validating conditional algebraic speci cations of abstract data types. In Proceedings of the Sixth European Conference on Arti cial Intelligence, pages 563 572, Pisa, Italy, 1984.
Robinson and Wos, 1969 G. Robinson and L. Wos. Paramodulation and theorem-proving in rst order theories with equality. In B. Meltzer and D. Michie, editors, Machine Intelligence 4, pages 135 150. Edinburgh University Press, Edinburgh, Scotland, 1969.
Rusinowitch, 1989 Michael Rusinowitch. Demonstration Automatique: Techniques de reecriture. InterEditions, Paris, France, 1989.
Zhang and Kapur, 1988 Hantao Zhang and Deepak Kapur. First-order theorem proving using conditional equations. In E. Lusk and R. Overbeek, editors, Proceedings of the Ninth International Conference on Automated Deduction, pages 1 20, Argonne, Illinois, May 1988. Vol. 310 of Lecture Notes in Computer Science, Springer, Berlin.
Zhang and Remy, 1985 Hantao Zhang and Jean-Luc Remy. Contextual rewriting. In Proceedings of the First International Conference on Rewriting Techniques and Applications, pages 46 62, Dijon, France, May 1985. Vol. 202 of Lecture Notes in Computer Science, Springer, Berlin September 1985.

