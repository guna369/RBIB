Decidability of Second-Order Theories and Automata on Infinite Trees
Author(s): Michael O. Rabin
Source: Transactions of the American Mathematical Society, Vol. 141 (Jul., 1969), pp. 1-35
Published by: American Mathematical Society
Stable URL: http://www.jstor.org/stable/1995086
Accessed: 17/09/2008 16:59
Your use of the JSTOR archive indicates your acceptance of JSTOR's Terms and Conditions of Use, available at
http://www.jstor.org/page/info/about/policies/terms.jsp. JSTOR's Terms and Conditions of Use provides, in part, that unless
you have obtained prior permission, you may not download an entire issue of a journal or multiple copies of articles, and you
may use content in the JSTOR archive only for your personal, non-commercial use.
Please contact the publisher regarding any further use of this work. Publisher contact information may be obtained at
http://www.jstor.org/action/showPublisher?publisherCode=ams.
Each copy of any part of a JSTOR transmission must contain the same copyright notice that appears on the screen or printed
page of such transmission.
JSTOR is a not-for-profit organization founded in 1995 to build trusted digital archives for scholarship. We work with the
scholarly community to preserve their work and the materials they rely upon, and to build a common research platform that
promotes the discovery and use of these resources. For more information about JSTOR, please contact support@jstor.org.
American Mathematical Society is collaborating with JSTOR to digitize, preserve and extend access to
Transactions of the American Mathematical Society.
http://www.jstor.org
DECIDABILITY OF SECOND-ORDER THEORIES 
AND AUTOMATA ON INFINITE TREES(') 
BY 
MICHAEL 0. RABIN 
Introduction. In this paper we solve the decision problem of a certain second- 
order mathematical theory and apply it to obtain a large number of decidability 
results. The method of solution involves the development of a theory of automata 
on infinite trees-a chapter in combinatorial mathematics which may be of in- 
dependent interest. 
Let I = {0, 1}, and denote by T the set of all words (finite sequences) on E. Let 
ro: T -> T and rl: T -- T be, respectively, the successor functions ro(x) = xO and 
r1(x) = xl, x E T. Our main result is that the (monadic) second-order theory of the 
structure <T, ro, r1> of two successor functions is decidable. This answers a question 
raised by Biichi [1]. 
It turns out that this result is very powerful and many difficult decidability 
results follow from it by simple reductions. The decision procedures obtained by 
this method are elementary recursive (in the sense of Kalmar). The applications 
include the following. (Whenever we refer, in this paper, to second-order theories, 
we mean monadic second-order; weak second-order means quantification restricted 
to finite subsets of the domain.) 
The second-order theory of countable linearly ordered sets is proved decidable. 
As a corollary we get that the weak second-order theory of arbitrary linearly 
ordered sets is decidable; a result due to Lauchli [9] which improves on a result of 
Ehrenfeucht [5]. 
In [4] Ehrenfeucht announced the decidability of the first-order theory of a unary 
function. We prove that the second-order theory of a unary function with a count- 
able domain is decidable. Also, the weak second-order theory of a unary function 
with an arbitrary domain is decidable. 
There are also applications to point set topology. Let CD be Cantor's dis- 
continuum (i.e., {O, 1}O with the product topology). Let F, be the lattice of all sub- 
sets of CD which are denumerable unions of closed sets, and let LC be the sublattice 
of all closed subsets of CD. The first-order theory of the lattice Fa, with LC as a 
distinguished sublattice, is decidable. Similar results hold for the real line with the 
usual topology. This answers in the affirmative Grzegorczyk's question [8] whether 
Presented to the Society, July 5, 1967; received by the editors March 4, 1968. 
(1) The author wishes to thank S. Winograd for many extremely helpful conversations on 
the topics of this paper. Preparation of this paper was supported, in part, by the U.S. Office of 
Naval Research, Information Systems Branch, under Contract F61052 67 0055. 
1 
2 M. 0. RABIN [July 
the first-order theory of the lattice of all closed subsets of the real line is 
decidable. 
Through Stone's representation theorm, the results concerning Cantor's dis- 
continuum lead to results about boolean algebras. Thus the theory of countable 
boolean algebras with quantification over ideals, is decidable. The first-order theory 
of arbitrary boolean algebras with a sequence of distinguished ideals is decid'able. 
This last result is an improvement of Tarski's result [15], and of Ershov's [6, 
Theorem 9]. 
Finally, we give an application to the theory of games. We show that the state- 
ment, proved by Wolfe [17], that every Gale-Stewart game (see ?2.5 for terminology) 
with a set in F, is determinate, is expressible in the second-order theory of two 
successor functions. Thus Wolfe's theorem could be proved by applying the 
decision procedure. 
Due to the fact that we use reductions to a second-order theory, our decidability 
proofs are very direct. Through appropriate interpretations, the set variables allow 
us to talk about all structures in a certain class. Thus, for example, for every 
sentence F of the second-order theory of linear ordering, we write a sentence F of 
the second-order theory of <T, ro, r1> which asserts that F holds in all countable 
linearly ordered sets. Since we can decide whether Fis true in <T, ro, r1>, we can also 
decide whether F is in fact true in all countable linearly ordered sets. 
It would be interesting to see whether this direct approach, involving some 
powerful decidable second-order theory, would yield a similar unified approach to 
other classes of solvable decision problems, e.g., in the theory of various fields. 
Let us briefly explain the connection with automata theory. The set T can be 
viewed as the full binary tree with root A (the empty sequence), and where xO and 
xl are the nodes branching out of the node x E T. For a finite set 1, a E-(valued) 
tree is a mapping v: T --S . The set of all E-trees is denoted by V2. A s-automaton is 
a system W = <S, M, SO, F>, where S is a finite set, M: S x E >- P(S x S), SO C S, and 
Fc P(S). We define the notion of a finite automaton W accepting a s-tree v. The set 
of all E-trees accepted by W is denoted by T(W). A set A c V, is called finite auto- 
maton (f.a.) definable if for some 9, T() = A. 
For a E, x ,2-tree v the projection on E, is the E1-tree p1v, where p1(x, y) = x. The 
basic properties of f.a. definable sets are as follows. If A c Vy, BC V2, and C 
c VE1 X,2 are f.a. definable, then so are A u B, Vs-A, and p1(C). Automata 
defining the latter sets can be effectively constructed from automata defining the 
sets A, B, and C. 
The emptiness problem, whether for a given automaton W we have T(%) = 0, is 
effectively solvable. 
Now let En be {O, i}n. We set up a one-to-one correspondence r between n-tuples 
A = (A1, . . ., An) E P(T)n of subsets of T, and En-trees. Namely, T(j) = vA where 
VA(X) = (XA1(X), * * *, XAn(X)) x e T, where XA denotes the characteristic function of A. 
For every formula F(A1, . . ., An) of the second-order theory of two successor 
19691 DECIDABILITY OF SECOND-ORDER THEORIES 3 
functions, we can effectively construct a 14-automaton %F so that for A c P(T)", 
VA E T(Ft() if and only if <T, ro, r1> F (X). This result, coupled with the solvability 
of the emptiness problem, leads immediately to the decidability of the second-order 
theory of two successor functions. 
As indicated above, our method also yields a complete survey of the relations 
definable in KT, ro, r1> using (monadic) second-order language. Via the interpreta- 
tions used in the decidability proofs, we are in a position to get complete informa- 
tion about definability in all the other theories proved decidable by our method. 
This question, however, is not explored in the present article. 
The paper is organized in three parts. Chapter I contains the basic definitions and 
the proof, using automata on infinite trees, of the main result concerning the 
decidability of the second-order theory of <T, ro, r1>. Chapter II contains the 
various applications of the main decidability result. In Chapter III we develop in 
detail the theory of automata on infinite trees. We prove the two difficult theorems 
used in Chapter I; namely, that the class of f.a. definable sets is closed with respect 
to complementations, and that the emptiness problem is effectively solvable. The 
treatment of automata theory is self-contained and the relevant results concerning 
sequential automata and automata on finite trees, are fully explained. Anyone 
looking for further background information may consult, in addition to the original 
papers quoted, also the survey article [12]. 
The reader who is mainly interested in automata, may get a complete picture of 
the theory of automata on infinite trees by reading ?1.4 and Chapter III. 
CHAPTER 1. THE THEORY OF TWO SUCCESSOR FUNCTIONS 
1.1. Notations and terminology. We shall use the usual set theoretic notation 
throughout this paper. Thus, a function f: A -- B is a subset fc A x B satisfying 
certain conditions. Sometimes we shall describe a mapping by the notation x wFflx), 
x E A, which indicates that for x E A, x is mapped into f(x). For example, x -* x2, 
x E [0, 1], denotes the squaring function f(x) = x2. If f: A -- B then A and f(A) 
= {f(a) j a E A} are called, respectively, the domain D (f) and the range R (f) of .f 
Iff: A -? B and Cc A, then fj C will denote the restriction f n (C x B) off to C. 
We adopt the convention that every ordinal number a is the set a = {/3 I f < a) of 
all smaller ordinals. Thus 0 = 0 (the empty set), n = {0, 1, . . ., n - 1}, and 
c={0, 1, .. . }. We shall use [n] to denote the set {, ..., n}=n-{0}. The cardin- 
ality of a set A will be denoted by c (A). 
The set of all subsets of a set A will be denoted by P(A). 
For A a set and a an ordinal, Al is the set of all a-termed sequences of elements 
of A; i.e., Aa={b I ?: a - A). 
Let A be a set, n an integer, and 1 ? i ? n. The projection onto the ith coordinate 
is the mapping pi: An -? A such that pi((xl, . . ., xn)) = xi. Strictly speaking, pro- 
jections such as (x, y) -* y and (x, y, z) -* y are different mappings, but we shall 
denote both by P2. 
4 M. 0. RABIN [July 
In writing logical formulas, we shall employ boldface type to denote the predicate 
or function constants, and the various variables (these will be either set variables or 
individual variables). 
Let W = <A, R> be a structure and F(B, x) be a formula of a language appropriate 
for W (here B is a set variable and x is an individual variable). For B c A, x E A, the 
notation W k F(B, x) is used to indicate that the formula F(B, x) is satisfied in W by 
B and x. 
The conjunction of the formulas Fi, 1 _<i < n, is denoted by A i <n Fi; sim iarly 
for disjunction. 
1.2. Structures and theories. We shall prove the decidability of some first-order 
and monadic second-order theories which are defined semantically as the set 
of all sentences true in a certain structure or class of structures. Let M- be a class 
of similar structures V =<A, Px>x <A, where A is an ordinal and Pa is an n(a)-ary 
relation or function on A. With M we associate a language L appropriate to it. 
L may be a first-order or a second-order language. L has the usual logical con- 
nectives and quantifiers, equality, a sequence u, v, x, y, z, . . ., of individual 
variables, and an n(a)-ary predicate or function constant Pa for each a < A. 
In the case that L is the (monadic) second-order language appropriate to M- it 
has, in addition to the above, a sequence of set variables, A, B, C, . . ., and the 
membership symbol e. The atomic formulas of L include formulas of the form 
t E V, where t is a term of L, and V is a set variable. Quantification is possible 
over both set variables and individual variables. In defining a language L we shall 
sometimes impose restrictions on some of its set variables. For example, we may 
confine some or all of the variables to range over finite subsets of the domain. Or 
else we may confine the variables to range over ideals of an algebra, or over 
subsets of the domain closed in a given topology, etc. 
With a given structure 9M and an appropriate language L, we associate the theory 
T= Th (9M, L) which is, by definition, the set of all sentences of L true in WD. The 
theory Tconstructed in this manner will be referred to as the theory of the structure 
9, or, sometimes, as the theory of the relations andfunctions Pa, a < A. The adjective 
second-order, with appropriate qualifications, will be added when the language L 
is of that kind. The theory Th (_3C L) of a class M- of similar structures is, by 
definition, Th (t L) = n v Th (M, L). The first-order theory of XA will be denoted 
by Th, (X); the (monadic) second-order theory will be denoted by Th2 (X9) 
As usual, a theory T is called decidable if the set T (more precisely, the set of 
Godel numbers of the sentences in T) is recursive. T is called primitive recursive or 
elementary recursive if (as a set of integers) it is primitive recursive or elementary 
recursive (in the sense of Kalmar). We shall not trace this fact explicitly, but all the 
decidability proofs given in this paper will actually show that the theory in question 
is elementary recursive. 
1.3. Theory of n successor functions. For an arbitrary set A, let A* denote the set 
of all finite sequences of elements of A. The elements x E A are also called words 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 5 
on A. For x E A*, I(x) denotes the length of the sequence x. The unique word 
x E A* for which l(x) = 0 is called the empty word and is denoted by A. If x E A*, 
y E A*, then xy will denote the result of concatenating x with y. 
On A* we define a partial ordering by x <y (x is an initial of y) if y = xz for some 
z E A*. If x<y and x=y, then we shall write x<y. 
If A is linearly ordered by < A, then we can introduce the ordering < which is the 
lexicographical ordering of A* induced by <-A. Thus x-y if and only if x <y, or 
x=zau and y=zbv, where a E A, b E A, and a<Ab. Note that <A*, <> is a totally- 
ordered set. 
For a e A, define the (immediate) successor function ra: A* - A* by ra(x) = xa. 
We also define a predecessor function pd: A* A* by pd (x) =y if either x =y = A 
or x= ra(y) for some a E A. 
DEFINITION 1.1. For 0<n<cv let Tn=n*{i I i<n}*. The structure 9k= 
<Tn,ri -<r, , >i < where < is the lexicographic ordering induced by the usual 
ordering on n, is the structure of n successorfunctions. Th2 (%n) iS called the second- 
order theory of n successor functions and will be denoted by SnS. 
The structure 91% = <{}*, ro, <, <> is (up to isomorphism) the set of integers 
with the usual successor function x i x + 1 and ordering <; the relation < is 
the same as < in this case. Thus SnS, 1 < n, is a natural generalization of the ord- 
inary theory of a single successor function. 
For every finite n < co, the relations < and < on Tn are definable (in second-order 
language) from r0, . . ., rn - 1. This is not true for TC, and we, therefore, include these 
relations in the definition of 9n, n < cv. 
Our main decidability result is 
THEOREM 1.1. The (monadic) second-order theory of two successor functions 
(S2S) is decidable. 
This result, which will be proved later on, has a large number of consequences. 
In particular, it trivially implies that SnS for every integer n, as well as ScoS, are 
decidable (?1.9). For this reason we prove directly only the decidability of S2S, 
even though the very same method would apply to every SnS, n < co. 
1.4. Trees and automata. As explained in the Introduction, the solution of the 
decision problem of S2S will require a theory of automata on infinite trees. In this 
section we give the basic definitions and results concerning automata. 
The infinite binary tree is the set T= T2= {0, 1}* of all finite words on {0, 1}. The 
elements x E T are the nodes of T. For x E T, the nodes xO, xl are called the im- 
mediate successors of x. The empty word A is called the root of T. Our language is 
suggested by the following picture. The lowest node of T is the root A. The root 
branches up to the (say) left into the node 0 and to the right into the node 1. The 
node 0 branches into 00 and 01; the node 1 branches into 10 and 11. And so on 
ad infinitum. 
6 M. 0. RABIN [July 
For x E T, the subtree Tx with root x is defined by Tx={y I y E T, x<y}. Thus, 
TA=T1. 
A path 7T of a tree Tx is a set 7TCTx satisfying: (1) x E rr; (2) for y E rr, either yO E 7T 
or yl E rr, but not both; (3) if y E rr and x#Ay then pd (y) E rr. It can be verified that 
if y, z err, then y?z or z?y. 
For a mapping A: A -- B, define 
In (4) = {b I b E B, c(-'-(b)) ? wo}. 
In the following, E denotes a finite set called the alphabet. 
DEFINITION 1.2. A >-(valued) tree is a pair (v, Tx) such that v: Tx - > E. If (v, T) 
is a valued tree, then (v, T,) will denote the induced value subtree (v I Tx, Tx). 
The set of all s-trees (v, Tx), for a fixed x E T, will be denoted by V,,. The set 
UXeT VzX of all s-trees, will be denoted by V>. 
DEFINITION 1.3. A table V' over s-trees is a pair V' = <S, M> where S is a finite 
set, the set of states, and M is a function M: S x E -? P(S x S), the (nondetermin- 
istic) table of moves (P(A) denotes the set of all subsets of A). 
Afinite automaton (f.a.) over s-trees (a s-automaton) is a system % = <S, M, SO, F> 
where <S, M> is as above, SO c S is the set of initial states, Fs-P(S) is the set of 
designated subsets of S. 
DEFINITION 1.4. A run of ' =<S, M> on the s-tree t =(v, Tx) is a mapping 
r: Tx -- S such that for y E Tx, (r(yO), r(yl)) E M(r(y), v(y)). We also talk about a 
run of an automaton % on a tree, meaning a run of the associated table V'. The set 
of all %-runs on t is denoted by Rn (%, t). 
DEFINITION 1.5. The automaton % = <S, M, SO, F> accepts (v, Tx) if there exists 
an A-run r on (v, Tx) such that r(x) E SO and for every path rT of Tx, In (r I -) E F. 
The set T(%) of s-trees defined by % is 
T(%) = {(v, T1) I x E T, (v, Tx) is accepted by %}. 
A set A c V. is f a. definable if for some f.a. A, A = T(). 
REMARK. A set A c V. is called invariant if for every s-tree t = (v, T) and every 
x E T, t E A if and only if the tree t' = (v', Tx) defined by v'(xy) = v(y), y E T, is 
in A. The invariant subsets of Vz are a boolean algebra. It is clear from Definition 
1.5 that every set T(%) is invariant. To prove that an invariant set A is f.a. definable, 
it suffices to construct an automaton % such that (v, T) E T(%) if and only if 
(v, T) E A. 
The following results are immediate. 
LEMMA 1.2. If A c Vz is f a. definable, then there exists an automaton %= 
<S, M, SO, F> such that So={so}, so E S, and T(%) =A. 
THEOREM 1.3. If A, Bc Vz are f.a. definable, then so are A u B and A n B. 
19691 DECIDABILITY OF SECOND-ORDER THEORIES 7 
Proof. Let A = T(W), B=T(93) where 9 = <S, M, so, F>, 3 = <S', M', s', F'>. We 
assume that S n S'= o. Construct the automaton 
Wt U 3 = <S u S', M u M', {s0, sO}, FU F'>. 
Clearly, T(W u V3)=A u B. 
With the above notations, define 9 x 3 = <S x S', M, (so, s), F> as follows. 
((Si, S1), (S2, S2)) E M((s, s'), a) if and only if (s1, S2) E M(S, C) and (sj, S2) E M'(s', a). 
Let Pi and P2 be the projection functions (x, y) ~-* x and (x, y) h-* y. Define F 
G I G CSx S', p1(G) e F, P2(G) E F'}. We have T(9 x 5 =3)=A n B. 
DEFINITION 1.6. Let t = (v, T) be a Il x 22-tree and let pi again be the projection 
(x, y) t-* x. The projection p1(t), by definition, is the E1-tree (p1v, T). 
The projection p1(A) of a set AC V21 2 is p1(A) ={pl(t) J t e A}. The 2- 
cylindrification of a set B C V21 is the largest set A C V21 X 22 such that p1(A) = B. 
THEOREM 1.4. If Ac V21X 2 is a f.a. definable set, then p1(A) c VE1 is a f.a. 
definable set. If Bc VE, isf.a. definable, so is its >2-cylindrification A CV21 X F22 
Proof Let 9 = <S, M, so, F> be a ll xZ2-automaton with T(9t)=A. Define a 
E1-automaton by 9t = <S, M1, s0, F>, where M1(S, a1) = Ua2E2 M(s, (a1, a2)), 
a1 E >1, s E S. One can check that T(1) =p1(A). 
The proof concerning cylindrification is left to the reader. 
THEOREM 1.5. The complement V, - T(W) of a f.a. definable set is a f.a. definable 
set. 
THEOREM 1.6. There exists an effective (even elementary-recursive) procedure for 
deciding for every automaton W whether T(W))= 0. 
For a proof of these two difficult theorems, see Chapter III. 
1.5. Definability in %2. The basic facts concerning automata on infinite trees 
lead, in a natural way, to a proof of Theorem 1.1. The proof proceeds by setting 
up a correspondence between n-tuples (A1,..., An) of subsets of T= T2 and valued 
trees. 
DEFINITION 1.7. For a set A c T, let XA: T {O, 1} be the characteristic function 
of A. Denote {O, 1}n by In, n < w. With A= (A1l,... An), associate the En-tree 
(vx, T) defined by VA(X) = (XA1(X), ..., XAn(X)), x E T. The mapping r: AX F- (vA, T) 
sets up a one-to-one correspondence between P(T)n and Vn,A = {(V T) v n}. 
THEOREM 1.7. There exists an (elementary-recursive) effective procedure for 
assigning to every formula F(A1, . . ., An) of S2S a En-automaton WF so that 
(1.1) T(itF) r) V,nA- ({(A1, .. ., An) | 12 k F(A1, . *. An)}) 
If (1.1) holds for an automaton 9, then we shall say that 9 represents the formula 
8 M. 0. RABIN [July 
Proof. Call two formulas F(A1,..., An) and G(A1,..., An) equivalent (in %2) 
if for all A1,..., An, 92 k F(A1, . . ., An) if and only if 92 k G(A1, . . ., An). We 
start by showing how to assign (effectively) to every formula. F an equivalent 
formula G which is in a special normalform. 
We introduce the following abbreviation for terms of S2S. A variable x will be 
abbreviated by x. Inductively, if t is abbreviated by xw, where w E T, then r6(t), 
S E {O, 1}, will be abbreviated by xwS. 
A formula P(A1,..., Am) of S2S is called principal if it has the form 
(1.2) 3x[xwlq1Ail A ... A XWk?7kAik], 
where each ij satisfies 1 <ij_m and each 7j is either E or 0. Note that it is not 
required that every Ai, 1 <i < m, actually appear in (1.2). 
Every formula F(A1,..., An) is equivalent to a formula G of the normal form 
Qn1.... QmM(A1 . . ., Am), where M is a boolean combination of some principal 
formulas P1, . . ., Pr, and each quantifier Qi is either ]At or VA,. 
The formula G is obtained from F by a sequence of simple steps as follows. In F, 
replace every occurrence of t1< t2, where t1 and t2 are terms, by 
t1 ? t2 V 3Z[ro(z) < t1 A r1(z) ? t2]. 
In the resulting formula, replace every occurrence of t1 = t2 by VA [t1 E A -- t2 E A], 
and every occurrence of t1 ? t2 by 
VA[Vx[x E A ro(x) E A A rL(x) E A] A t E A--t2A]. 
We obtain a formula F' equivalent with F, in which the only atomic subformulas 
are of the form t E V where t is a term and V is a set variable. By a well-known 
procedure of second-order logic, F' is transformed into an equivalent formula F1 
of the form Qnl ... QmMi(A . . .M Am) where each Qi is VAi or 3Ai, and M1 is in 
prenex form with quantification only over individual variables. By pushing the 
quantifiers of M, one by one into M1, M1 is transformed into an equivalent boolean 
combination M(A1, . . ., Am) of principal formulas. Thus, F is equivalent to the 
formula Qn+1 ... QmM of the desired normal form. 
Returning to the proof of the assertion in our theorem, we may now assume that 
F itself is in the normal formQn+l *. * QmM(A,L.. ., Am,)(2). That the assertion is 
true for a principal formula P(A1, ..., Am) of the form (1.2), can be seen by an 
explicit construction of an automaton 9p so that (1.1) holds. Alternatively, this 
will be obtained as Corollary 3.13. The existence of an automaton 9M representing 
the boolean combination M of principal formulas now follows from Theorems 1.3 
and 1.5. 
(2) M. Megidor has suggested that a slight modification of the argument which follows will 
establish our result directly by induction on formulas, without having to pass to normal form 
In this approach individual variables are treated as special set variables ranging over singleton 
sets. 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 9 
The proof of our theorem will be completed if we can establish the following 
proposition. If G(A1, . . ., Ak) is a formula represented by the Sk-automaton %, and 
Qk iS 3Ak or VAk, then QkG(Al, ..., Ak) is representable by a Ek- '-automaton Z. 
Since VAkG is equivalent with - 3Ak- G and the class of f.a. definable sets is closed 
under complementation (this is the crucial application of Theorem 1.5!), it suffices 
to consider the case 3AkG. 
Let p be the projection p: (xl,..., Xk) * (Xl,..., Xk- 1). Since Ek =k- 1 X 1 
(where El = {0, 1}), p induces a projection from Sk_trees to Ek - '-trees (Definition 
1.6). This projection commutes with the mapping i-: AX -> (vg, T), i.e., 7(p(X)) 
=p(r(X)) for A~E P(T)k. Now 
H = {(Al, . . ., Ak-1) | 2 ] 3AkG(A1,.. ., Ak)} 
= p({(A1, .. ., Ak) ( 92 k G(A1,. .., AJA 
Applying i- to both sides and interchanging i- and p, we get 
r(H) = p(T({(Al, ..., Ak) | %2 k G(A1, .. ., A,)})) = p(T(9)) Al VSk-1,A 
the last equation being our assumption about G and W. By Theorem 1.4, there 
exists a k - '-automaton %3 such that T(Q3) =p(T(f)). This 93 represents 3AkG. 
1.6. Proof of Theorem 1.1. Let G be a sentence of S2S. We wish to determine 
effectively whether 9% 1 G. Without loss of generality, assume that G is of the form 
3A,F(Al). Construct the automaton 9F. Now 9% 3 HA1F(Al) if and only if T(9F) 
#A 0. The question whether T(%F) # 0 can be effectively decided by Theorem 1.6. 
1.7. Addition of finite-set variables. Theorem 1.1 can be strengthened to show 
that S2S remains decidable upon adding to the language set variables a, b, . . . 
ranging over finite subsets of T2. This will be done by proving that the finiteness 
of a set A c T is a property definable in S2S. 
To do this, and also for later applications, let us briefly recall the notion of a 
relation R being definable in a structure 9J = <A, Pa>c, < A, using a language L 
(less precisely, R being definable in Th (9N, L)). Thus, for example, R (-A2 x P(A) 
is definable in Th2 (9N) if there exists a formula F(x, y, B) of L such that for x, y E A, 
Bc A, we have <x, y, B> E1 R if and only if 9J k F(x, y, B). Our proofs that a given 
relation is definable in a given structure will often be informal. We shall give a 
verbal description of the relation, leaving it to the reader to check that this verbal 
description is expressible by a formula of the language in question. 
LEMMA 1.8. The predicate Fn (A), true for A (T2 if and only if A is finite, is 
definable in S2S. 
Proof. We recall that A c T is totally-ordered by <. Thus A is finite if and only 
if every B c A has both a largest and a smallest element with respect to . 
The same definition of finiteness applies to every SnS, n ? w. 
COROLLARY 1.9. Let L' be the second-order language L appropriate to 9Z2, 
augmented by the addition of variables a, b, . . ., ranging over finite subsets of T2. 
Th (9%2, L') is decidable. 
10 M. 0. RABIN [July 
1.8. Definability of T(9) in S2S. Theorem 1.7 asserts that if RcP(T)l is definable 
in S2S, then r(R) is finite-automaton definable. The converse of this statement is 
also true. 
THEOREM 1.10. Let R P P(T)n be an n-ary relation between subsets of T and let 9 
be a En-automaton such that T(9) n VZfl,A = r(R). There exists a formula 
F(A19 . .. X An) of S2S so that <A1, ... An> e R if and only if W2 kF W(A1,**.. * An) 
Proof. We shall use the following notational abbreviation. If A =(A1, ..., An) 
and (81, . . ., ) =a e En (= {O, 1}n), then vI(x) = a will abbreviate the formula 
x-q1Ai A ... AxrqnAn where -i is E if Si = 1 and -i is 0 if Si =O, 1 _ i _ n. This notation 
captures the intention of Definition 1.7. If Hc2n, then vj(x) E H will abbreviate 
VGGH v(x) = a. 
Let 9X=<S, M, so, F>. We may assume that S(-Em for an appropriate m. Thus 
to each S-valuation r: T -? S there corresponds a B= (Bl1,.,Bm) such that 
vA(x)=r(x) holds for B and for every x E T. 
With r and B as above, C c T a path, and s E S, s E In (r I C) holds if and only if 
Vx3y[x E C- Y E CA X <Y A rb(y)=s] is true in %2 for C and A. This implies that 
for F-P(S) the statement In (r I C) E F is expressible by an appropriate formula 
InF (B, C) of S2S. Finally, there exists a formula Path (C) of S2S which is true if 
and only if Cc T is indeed a path. Note that all the above mentioned formulas can 
be constructed so as to contain no set quantifiers. 
Putting the previous remarks together, we see that for A = (A1, ..., An) E P(T)n, 
A = (A1, . . ., An) and B= (B1, . . ., Bin) (where the latter two are sequences of set 
variables), (vA, T) E T(Q) if and only if A satisfies the formula Fa(A1, . . ., An) 
which reads 
3B, .. 3BmVC[vx/\ A [vi(X) = or A VA(X) = S 
(1.3) V Y(XO) = S1 A VB(XI) = S2] (S1, 32)GM(3, a) 
A vh(A) = so A [Path (C) -> InF (B, C)]]. 
This formula Fw is the desired one. 
COROLLARY 1. 1 1. Every formula F(A1, . . ., An) of S2S is equivalent o a formula 
G of the form 3BVCM(A, B, C) where M is a formula with no set-quantifiers. 
Proof. This follows at once by combining Theorems 1.7 and 1.10 and noting that 
formula (1.3) has the required form. 
The dual form of the previous corollary is, of course, also true. 
1.9. Decidability of SwS. The binary tree T2=T, in a certain sense, contains as 
subtrees all trees with countable branching. For this reason, the decidability of 
S2S implies decidability of second-order theory of more complicated particular 
trees and classes of trees with countable branching. Here we shall treat only the 
case T,. 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 11 
THEOREM 1.12. The second-order theory SwS = Th2 (9Z,) of w successor functions 
is decidable. 
Proof. Let A c T be a set with a unique element AA E A smallest with respect to 
<. Define a relation S(A) c A2 by (x, y) E S(A) if and only if 
xeA A yeA A x < y A Vz[zeA-- -[x < z < y]]. 
If (x, y) E S(A), then we shall say that y is an (immediate) successor of x in A. Thus 
T(A) = <A, S(A)> is a tree with root AA- 
Note that for x, y E A, x ? y (where ? is the partial ordering of T) if and only if x 
precedes y in the tree T(A). 
Let A={A} u {1n01n20 ...1nkO I < k < , 0 < ni, 1 < i < k}. In T(A), the set of 
immediate successors of an x e A is well-ordered in an w-sequence by < (the 
lexicographic ordering of T). Thus we can define rA(x) =y by (x, y) e S(A) A 
Vz[(x, z) E S(A) -* y<z] and, inductively on n < , rA 1(x) =y by (x, y) E S(A) A 
Ai<n r4 (x):y A Vz[(x, z) E S(A) A Ai<n r"(x)#z y:z]. With this definition of 
the successor functions rn, n < w, the structure <A, rn, =< IA, -<IA>n< " is isomorphic 
to %". 
Now the set A and the relations rA(X) =y, n < , are definable in S2S. Combined 
with the previous remark, this implies decidability of SwS. 
CHAPTER II. APPLICATIONS OF THE DECIDABILITY OF S2S 
2.1. Linearly ordered sets. Let J`<* be the class of all linearly ordered sets 
<A, < > such that c (A)? < c. 
THEOREM 2.1. Th2 (SCO), the second-order theory of countable linearly ordered 
sets, is decidable. 
Proof. This is an almost trivial consequence of the decidability of S2S. 
Let Bc T be the set of all sequences xlO1 such that xlOl has no (consecutive) 
subsequence 101 except the one at the end. Thus if x, y E B and x?y, then x=y. 
It can be easily verified that <B, I B> has the order type q of the set of rationals. 
This implies that for every <A, ' > E SO there exists a set AcT so that <A, _ > 
-<A, -,IA>. 
Let F be any sentence of the second-order theory of linear ordering. Let FA be the 
sentence obtained by replacing in F all occurrences of ? by <, relativizing in- 
dividual quantifiers to A and relativizing set quantifiers to subsets of A. By the 
above, Fe Th2 (V') if and only if VAFA E S2S. 
It has been observed (Corollary 1.9) that S2S remains decidable upon inclusion 
of set variables ranging over finite sets. The previous theorem may be strengthened 
in the same way. Combining this with the fact that the downward Skolem-Lowen- 
heim theorem is valid for weak second-order logic, we get as a corollary the follow- 
ing result of Lauchli [9], which strengthens Ehrenfeucht's result [5]. 
12 M. 0. RABIN [July 
COROLLARY 2.2. The weak second-order theory of linearly ordered sets is de- 
cidable. 
In contrast with the treatment in [5], [9], we get here elementary recursive 
decision procedures. 
Since the notion of well-ordering is obviously definable in Th2 (X@), we have 
the following result which is related to Buichi's Theorem 1' of [2]. 
COROLLARY 2.3. The second-order theory of countable well-ordered sets is 
decidable. 
It is not known whether the second-order theory of arbitrary well-ordered sets 
is decidable. By the same token, it is not known whether Th2 (Y<), where =< 
is the class of all linearly ordered sets, is decidable. It may be that some sentence of 
second-order theory of linear ordering is independent of set theory. In this case, 
it will be impossible to produce a decision procedure for Th2 (g?) by means of 
arguments formulated within set theory. 
Closely related to this is the following question. Does there exist a sentence F 
of second-order theory of linear ordering so that <A, < > i Fif and only if c (A) co ? 
The existence of such a sentence would imply that Souslin's Hypothesis is express- 
ible in this theory. Souslin's Hypothesis is known to be independent of set theory. 
2.2. Second-order theory of a unary function. Let Vf be the class of all structures 
W =<A,f> where f: A ->- A is a (unary) function from A to A. By .X7fP we shall 
denote the class of all structures <A, f> E Xf with c (A) ? w. The structures in X*f' 
will be referred to, throughout this section, as algebras. Thus, the term "algebra" 
always implies countability. We shall list without proofs some simple observations 
about the structure of algebras. 
Two elements x, y E A of an algebra W = <A, f> are called connected (x - y) if for 
some n <w, m < w, fn(x) =fm(y). The relation is an equivalence relation. For 
x E A, the equivalence class {y I y - x, y E A} is a subalgebra of W. An algebra W is 
called connected if every two x, y E A are connected. Every algebra SC= <A, f> is the 
cardinal sum of a countable collection of connected algebras; i.e., A = Un < m I " A n 
where each <An,fIAn> is a connected subalgebra of W, and An rAk= 0 for 
n < k < m. 
An algebra is called a prime algebra if it is one of the following: 
Wn = <{aj1 0 _ i < n},f>, 
1<n<, where, for n<w, f(ai)=ai+1, O_i<n-1, f(an-1)=ao;- and for n=, 
f(ai) = ai + 1 Every algebra contains at least one prime algebra. A connected algebra 
W is said to be of type n, 1 < n < co, if W contains an algebra An. The type of a con- 
nected algebra W is uniquely determined by t. 
Let Wt= <A, f> be a prime algebra. The enveloping algebra e = <B, g> W of W is 
defined as follows. Let N= w - {O} be the set of positive integers. Set B= AN* and 
define g(ail ... ik+ 1) = ail ... ik, g(a) =f(a), for a E A, il ... ik+1 e N*. 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 13 
The following basic property of the enveloping algebra is easily verifiable. Let 
Wn be a prime algebra of type n, and e v 9n be its enveloping algebra. If C v RI is a 
connected algebra of type n, where Rn is a prime algebra, then any isomorphism 
+: fln 
- n can be extended to a monomorphism ~: C e of C into Z. Thus, 
every connected algebra is a subalgebra of an enveloping algebra. This implies that 
every algebra is embeddable in a (countable) cardinal sum of enveloping algebras. 
THEOREM 2.4. Th2 (I*f), the second-order theory of a unary function with a 
countable domain, is decidable. 
Proof- We shall interpret Th2 (17') in SwS = Th2 (1,,), which is decidable 
(Theorem 1.12). This will be done by constructing a relation F(x, y, C) definable 
in %,,, so that for a fixed Cc T., the set of pairs <x, y> for which F(x, y, C) holds 
is a unary function f, and the algebra 9c = <D(_f),f> is the cardinal sum of de- 
numerably many enveloping algebras. Conversely, for every cardinal sum W of 
denumerably many enveloping algebras, there will exist a C so that W 9c. 
Assume for the moment the existence of such a relation and let F(x, y, C) be the 
formula of SwS defining it. The formula Al(A, C) which is 
Vx3y[x E A --F(x, y, C) A y E A], 
is true for A c To, Cc To, if and only if <A, f IA> is a subalgebra of c = <KD(f),f >. 
By the remarks concerning algebras, for every W ewf there are sets A, Cc T. so 
that Al(A, C) holds, and 9t K<A,ftA>. If S is a sentence-of second-order theory 
of a unary function, let 3 be the formula of ScoS obtained from S by replacing 
f(x) =y by F(x, y, C), relativizing all individual quantifiers to A and relativizing 
all set quantifiers to subsets of A. We have S E Th2 (M*') if and only if 
VAVC[AI(A, C) > ] E SwS. 
Thus, all that remains is to construct F(x, y, C). We shall do this informally, 
leaving verification that the relation in question is definable in W., to the reader. 
Let Cc T. be a set so that Cc {onOm I n < co, m < w}, and for every n < w, C contains 
at most one word of the form OnlOm. For n < , let An={OnlO, I i?m} if OnlOm E C, 
and An={OnOi I i <w} if no OniOlm is in C. Let Bn = AnN* where N=--{O}, and let 
B= Un<, Bn. 
The idea is to define F(x, y, C) so that under the corresponding unary f, each 
subset Bnc B will be an enveloping algebra. f will be the predecessor function for 
x #OnlO,, and for x=OnlOO the definition will be different. The detailed definition 
follows. 
Let pd (x) be the usual predecessor function on T. (see ?1.3). Note that pd (x) =y 
is definable in %, by x =y = A V y < x A Vz [y < z < x]. Let F(x, y, C) hold if and 
only if C has the above mentioned property, x E Bn for some n, and y satisfies the 
following. If x OnIOlz, A ? z E N* then y = pd (x); if x = OnOt 1 C, then y = ro(x) 
=On1Ot+1; if x=OnIOmeC then y=Onl. Letf:B-*B be the mapping such that 
f(x) =y if and only if F(x, y, C). 
14 M. 0. RABIN [July 
For a fixed n < , if OnlOm E C, then <An,f IAn> is the prime algebra of type m + 1, 
and if no onlom is in C then <An,f IAn> is the prime algebra of type w. In either case, 
=n <Bn,f tBn> is the enveloping algebra of <An,f tAn>. Thus <B,f> is the cardinal 
sum of the enveloping algebras 5n, n < w, and every denumerable cardinal sum is 
obtained in this way by an appropriate choice of Cc To. This concludes the 
proof(3). 
We may again strengthen our result by including in the language set variables 
a, b, . . ., ranging over finite sets and still retaining decidability (see Corollary 1.9). 
As in the case of linearly ordered sets, we get 
COROLLARY 2.5. The weak second-order theory of a unary function is decidable. 
This is a strengthened version of Ehrenfeucht's result [4] where he announced the 
decidability of the first-order theory of a unary function (Th1 (*f) in our notation). 
We again get, both for Theorem 2.4 and Corollary 2.5, that the theories in question 
are elementary recursive. 
2.3. Subsets of {O, 1}0. Let CD = {O, 1}?', and introduce on CD the usual product 
topology. As is well known, CD is essentially the same as Cantor's discontinuum 
(ternary set). 
There is a natural one-to-one correspondence between CD and the set of paths 
Tc T of the binary tree T= T2. Namely, each path v is simply the set of all (finite) 
initials of a unique element #: w ->- {O, 1} of CD. Thus, we shall view the paths 
Tc T as elements of CD, and sets of paths as subsets of CD. 
We wish to define in S2S subsets of CD. This is not directly possible because the 
paths ITc T are already sets and, therefore, sets of paths are third-order objects 
(sets of subsets of T). An indirect way for defining subsets of CD is to consider a 
formula F(B, A) of S2S of the form G(B, A) A Path (B), where R2 k Path (B) if and 
only if Bc T is a path. Such a formula gives a mappingf: P(T) -* P(CD) defined by 
f(A) = {r I rc T, 2 k F(ir, A)}. When A ranges over subsets of T, f(A) ranges over 
a class of subsets of CD. Appropriate choices of F will produce interesting classes 
{f(A) I A c T} cP(CD). 
THEOREM 2.6. Let Cl (B, A) be [Bc A] A Path (B) and F,(B, A) be Fn (A n B) 
A Path (B) (see Lemma 1.8). cl (A) ranges over all closed subsets of CD, and f,(A) 
ranges over all Fa (countable unions of closed sets) subsets of CD. Here cl andf, are 
the mappings corresponding to Cl and Fa in the above explained manner. 
Proof. That for every A c T the set cl (A) = {Ir I ITc T, vT c A} is a closed subset of 
CD is trivial. Conversely, let SC CD be a closed set. Let A = U,s'T. We have 
cl (A) = S. Note that for this last A, if ,T A, then c (7r n A) < w. 
(3) The interpretation of the second-order theory of unary functions with a countable 
domain in S2S, was noted independently by J. J. Le Tourneau in his thesis. 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 15 
Let A c T; we have f,(A) = {7r I c (7r f A) < w} = Un < , Sn, where 
Sn = { cf I c(fr A) _ n}. 
Each set Sn is closed; hence, f,(A) E F. 
Conversely, let SC CD be an F, set. We may assume S=Un <c, Sn, where Sn is 
closed and Sn C Sn+ 1, for n < w. Let An = UieSn X; then Sn = cl (An) and An c An+ 1, 
for n<w. 
If v 0 S, then for every n < w, c (IT nl An) < w. This enables us to define a sequence 
Xn(7r), n < a, as follows. xO(7T)=minXX,..AOAx (i.e., xO(7r) is the smallest node, with 
respect to _, in Xr but not in AO). Inductively, Xn + 1(X) = minX,n(,) < x- An x. Note that 
if 7r', T" ' S and Xn(T') E -T", then Xn(7T') = Xn(TT"); this is proved by induction on n. 
Let A {Xn(7T) I v 0 S, n < w}. We claim thatfa(A) = S. If7r I S then Xn(7r) E f ri A 
for n< w, so that c (- n A)= w and 7r fG(A). Hence,f,(A)-S. Assume7r iE S; then 
7r -An for some n < w and hence c An+k, k < c. This implies that if xm(IT') E vr for 
a Ir ' S, then 0_m <n. We claim c (Ir r A) <n+ 1 and hence IT e-f(A), which will 
establish ScfG(A). Otherwise, there exist Xm0(7rO), ..., Xmn(ITn), which are pairwise 
different and elements of 7r. From mi <n, 0<_ i< n, it follows that for some 0_ i 
<j< n, mi = mj = m. Now xm(rTi) E 7r and xm(ITj) E 7r. Therefore, they are comparable 
and, say, Xm(i) < Xm(7j). Hence, Xm(IT) E irj; but this contradicts Xm(Ii) # xm(ffj). 
THEOREM 2.7. Let C = <CD, < > be Cantor's discontinuum with the usual ordering; 
i.e., IT < 7I' iffor some z E T, zO E IT and zl E IT'. Let L be a language appropriate to C 
which has (besides the individual variables) set variables C1, C2,... ranging over 
closed subsets of CD, and set variables D1, D2, . .. ranging over FJ, subsets of CD. 
Th (C, L) is decidable. 
Proof. Let S be a sentence of L. Let 3 be the sentence of S2S obtained from S by 
replacing xi < x1 with Bi = Bj v 3x[x0 e Bi A xl e Bj], replacing xi E C1 with Cl (Be, Cj), 
replacing xi E Dj with FG(Bi, Dj), and replacing all quantifiers 3xt or Vxi by 3Bj or 
VBi relativized to Path (Bt). We have that S E Th (E, L) if and only if S E S2S. 
THEOREM 2.8. Let e = <F, u, n, L,> be the lattice of F,-subsets of CD, with 
the lattice of all closed subsets of CD as a distinguished sublattice (i.e., x E L, if and 
only if x is a closed subset of CD). Th1 (e) is decidable. 
This is a trivial consequence of Theorem 2.7. 
The above results carry over from CD to the segment [0, 1] with the usual to- 
pology and order. For IT1, IT2 E CD, define an equivalence - by IT1 -,fI2 if and only if 
IT1 =IT2, or for some x E T, X1on E I1, n <w, and xOln E IT2, n < w, or vice versa with 
7rI and IT2 interchanged. The quotient space CD/ - is homeomorphic with [0, 1]. 
THEOREM 2.9. Let I= <[0, 1], <> be the unit interval with the usual ordering, and 
let the language L be the same as in Theorem 2.7. Th (I, L) is decidable. 
Proof. The relation - between paths of T is definable in S2S. Let S be a sentence 
of L and let 3 be as in the proof of Theorem 2.7. Replace in 3 all subformulas 
16 M. 0. RABIN [July 
Bi = B1 by Bi - Bj (recall that the variables Bi in S are all relativized to Path (Bi)), 
Cl (Bi, C,) by 3BA + 1 [Bi Bi + 1 A Cl (BE + 1, C1)], and similarly for F0(B2, Dj). The 
resulting sentence S' is true in 912 if and only if S E Th (I, L). 
This last result answers in the affirmative Grzegorczyk's question [8] whether the 
first-order theory of the lattice of all closed subsets of the real line is decidable. 
2.4. Boolean algebras. Denote the class of all boolean algebras by .B, and the 
class of countable boolean algebras by YB . Let LI be the language appropriate for 
.B, which has set variables I, J,..., ranging over ideals of the boolean algebras. 
THEOREM 2.10. Th (*Bj, LI), the theory of countable boolean algebras with 
quantification over ideals, is decidable. 
Proof. Let , = <B, u, n, '> be the free boolean algebra on a denumerable 
number of generators. By Stone's representation theorm (see [14, Sections 8, 14]), 
Z,, is isomorphic by a mapping 2: ,,-* P(CD) with the algebra of all closed-open 
(clopen) subsets of CD(4). The ideals Ic Z,, stand on a one-to-one correspondence 
with the open subsets of CD by the mapping U(I) = UbeI +(b) c CD. Thus, we have 
b E I if and only if #(b) c U(I). The notions of open subset of CD, closed-open, and 
the boolean operations on clopen sets, are all definable in Th (LY, L). Thus the 
decidability of Th (Q30), LI) follows from Theorem 2.7. 
Now, the arbitrary algebra 3 E %B'71 is isomorphic with Z3./I for an appropriate 
ideal Ic Z,, and the ideals J' c Q3 stand in a one-to-one correspondence with the 
ideals J, I-Jg Z,, This implies the decidability of Th (4B0, LI). 
As a corollary- we get the following improvement of Tarski's result [15] to the 
effect that the first-order theory of boolean algebras is decidable. 
THEOREM 2.11. The first-order theory of boolean algebras with a sequence of 
distinguished ideals is decidable. 
Proof. The class, call it XBI, of structures in question consists of all boolean 
algebras 5 =<B, u, n, ' where I,, is an ideal of e for n< w. Let F be a 
sentence of the first-order language of .BI and let the list IO, ..., I,,, include all the 
ideal-constants appearing in F. It follows from the Skolem-Lowenheim theorem 
that F E Th, (.BI) if and only if VIo ... VImF E Th (.4B0, LI). 
Theorem 2.11 also implies a result of Ershov [6, Theorem 9] to the effect that the 
first-order theory of Boolean algebras with a distinguished maximal ideal, is 
decidable. 
2.5. Games on {0, 1}@. Let D c CD = {0, 1}G). With D we associate the Gale- 
Stewart [7] game, which is played by two players 1 and 2. Player 1 picks an el e{0, 1}, 
plaver 2 then picks an e2 E {0, 1}, and so they alternate ad infinitum. If the result 
X=e1E2e3 * * * of the play satisfies X E D, then player 1 won that play; if X ? D, then 
player 2 won the play. 
(4) This connection was pointed out to me by D. Scott. 
19691 DECIDABILITY OF SECOND-ORDER THEORIES 17 
A strategy is a mapping f: {0, 1}* -- {O, 1}. A sequence 7r=ee2- * - has been 
played by player 1 according to the strategyf, if f(A) = e, and I+1 =f(s"l .e2n), 
1 < n < w. The strategyf is winning for player 1 if every 7r played by 1 according tof 
satisfies 7e E D. The notion of a winning strategy for player 2 is similar. 
The set D - CD is called determinate if one of the two players has a winning 
strategy. With the aid of the axiom of choice, it can be shown that not every 
D c CD is determinate. Gale and Stewart [7] have shown that if D is open or closed, 
then it is determinate. Wolfe [17] proved that if D E F6, then it is determinate. The 
best result thus far is due to M. Davis who has proved that D E F6 implies de- 
terminacy. 
We shall show that the statement that every D Ec F, is determinate, is expressible 
in the second-order language of 912. Thus, Wolfe's theorem is among those decided 
by the decision procedure for S2S. 
A strategy f: {O, 1}* -? {O, 1} of the Gale-Stewart game can be viewed as the 
characteristic function of a set A c T; namely, A = {x I f(x) = 1}. Note that the sets 
El = {x l (x) = 2n, n < }, E2= {x I I(x)=2n + 1, n < w}, are definable in S2S by 
appropriate formulas El(x) and E2(x). 
Let Wi(A, D), i= 1, 2, be the formula 
VB[Path (B) A Vx[Ei(x) A x E B -* [x E A " xl E B]] -Ft(B, D)] 
where F1 is just F6, and F2 is F,. %2 F Wi(A, D) if and only if XA is a winning 
strategy for player i in the game associated with f6(D). 
The sentence of S2S asserting that every set in F, is determinate reads 
VD3A[W1(A, D) v W2(A, D)]. 
CHAPTER III. AUTOMATA ON INFINITE TREES 
The basic definitions and some preliminary results concerning f.a. on infinite 
trees were given in ?1.4. This chapter will be devoted to the proofs of Theorems 1.5 
and 1.6 which were stated in that section. This will involve a number of auxiliary 
concepts and results. 
3.1. Sequential automata. We shall briefly recall some notions and results 
concerning automata on infinite sequences. 
Let - be a finite set; SO is the set of all w-sequences on E. 
A (sequential) 1-table is a system 9'=<S, M> where S is a finite set and M: 
S x E -* P(S). If c (M(s, a)) = 1 for all s E S, a E X, then 9' is called deterministic. 
An W'-run on v e S0 is a mapping r: - S such that r(n+ 1) E M(r(n), v(n)), 
n<w. 
A (nondeterministic) finite automaton (see [13]) is a system 9=<S, M, So, F>, 
where <S, M> is as above, SoC S, FC S. Following Bulchi [1], we say that 9 
accepts v E La if for some 9-run r on v, r(O) E SO and In (r) rn F# 0. The set of all 
v e- E which are accepted by W is denoted by T,,(%). A set A cE is called f a. 
definable (in Biichi's sense), if for some f.a. 9, A = T0(W). 
18 M. 0. RABIN [July 
D. Muller [11] formulated a different notion of acceptance of a sequence by an 
automaton. Let % = <S, M, so, F>, where <S, M> is a deterministic table, so E S, 
and F-P(S). Following Muller, we say that W accepts v E E;@ if for the (unique) 
%-run r on v which satisfies r(O) =so, In (r) E F holds. Again, we denote by T,,(%) 
the set of all v E SO accepted by the (Muller) automaton W. 
McNaughton [10] proved the following fundamental result. Every set A(-I 
f.a. definable in Buichi's sense isf.a. definable in Muller's sense, and vice versa. 
We may further generalize the notion of automaton by combining the ap- 
proaches of Biichi and Muller. Thus in Muller's definition, allow <S, M> to be 
nondeterministic and say that W accepts v E SO' if for some W-run r on v, r(O)=so 
and In (r) E F. Again we do not obtain any new definable sets. This can be seen, for 
example, by showing that every generalized Muller automaton is equivalent with 
an appropriate Biichi automaton. 
The class of f.a. definable sets A c:1' is a boolean algebra (Biichi [1]). 
3.2. Generalization of acceptance by automata. Let (r, T) be an S-tree 
(r: T-- S), and 7 c T be a path. With r IT we associate an co-sequence (rI7),, of 
elements of S as follows. Let = {xN I n < w} where xo < xl < * - - . Define (r I T),,(n) 
=r(xn). This makes (rl7r),, a mapping from the set co into S; i.e., (rl7r),, E S0'. 
The definition (1.5) of the notion of an automaton W accepting a tree t = (v, TO) 
involves the condition In (rl) E F, i.e., In ((rl7),,) E F. This condition on the 
cW-sequence (riT),, E S0O is recognizable by a sequential S-automaton. The following 
theorem states that using any (sequential) automaton-definable condition on the 
sequences (r I ),, we still get just f.a. definable sets of s-trees. 
THEOREM 3. 1. Let % = <S, M> be a table over , and B c SI' be af.a. definable set 
of w-sequences on S. Define Cc- V,g to be the set of 2-trees t=(v, TJ) such that for 
some run r e2 Rn (S, t), and every path 7rcTx, we have (r Ir),, e- B. The set C is f.a. 
definable. 
Proof. Let 3 =< U, K, uo, H> be a (sequential) deterministic automaton over S 
such that T,,(3) = B. Note that H P(U). Define a Y-automaton ( = <U x S, M, 
{uo} x S, F> as follows. 
For (u, s) e Ux S, a e E, define 
M((u, s), a) = {<(K(u, s), sl), (K(u, s), S2)> I (S1, S2) e M(s, a)}. 
Let pl: (x, y) ~-* X, P2: (x, y) ~-* y be the projection functions. For every run r of 
< U x S, M> on a 2-tree t = (v, T), p2r: T -* S is an 9-run on t, and every A-run 
is obtained in this way. Also, along any path Tc T, (plrl7)s, is a 5-run on the 
sequence (P2r H),. 
Define now F= {A I A c U x S, p1(A) E H}. We have T(Q) = C. 
Note that in the previous proof, we assumed that B c S"' is defined by a de- 
terministic (Muller) automaton. In applying Theorem 3.1, we shall usually prove 
the f.a. definability of the B c SO' in question by exhibiting a nondeterministic 9e 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 19 
such that B1= Tso(3) (in the generalized Muller sense). McNaughton's theorem (see 
?3.1) assures us of the equivalence of the two notions of f.a. definability. 
3.3. Marked E-trees. 
DEFINITION 3.1. Let Q be a finite set, H' Tx x Q, and (v, Tx) = t be a 2-tree. The 
tree t marked at H, is the E x P(Q)-tree it= (v, Tx) such that for y E Tx, v(y)= 
(v(y), {q I (y, q) e H}). 
Let Q be a finite set and let Cq, for q E Q, be a f.a. definable set of E x P(Q)-trees. 
In the sequel we shall consider sets A of 2-trees (v, T) satisfying an iterative 
condition which is, roughly, as follows. (v, T) E A if and only if there exist a qo E Q 
and a set H oc (T- {A}) x Q so that the tree (v, T) marked at HA qo is in Cqo. 
Furthermore, for every (x, q) E HA-,l there exists a set Hx q c (Tx- {x}) x Q so that 
(v, Tx) marked at Hx,q is in Cq. And so on. We shall need the fact that such an 
A c V, is f.a. definable. This situation is made precise in the following 
LEMMA 3.2. Let Q be a finite set, qo E Q, and let 9q, q e Q, be a E xP(Q)-auto- 
maton. Define an invariant (see ?1.4) set A c V. by the condition: (v, T) E A if and 
only if there exist a set Hc T x Q and a mapping (x, q) -Hx q (x, q) E H, such that 
(1) (A, qo) E H; (2) Hx.q C (Tx-{x}) x Q, and Hx q c H; (3) for (x, q) E H, the tree 
(v, T,) marked at Hx q is accepted by (q. 
The set is f.a. definable. 
The proof of this lemma will be given in ?3.6. 
3.4. Well-founded mappings. We shall also require a version of Lemma 3.2 with 
the additional assumption on (x, q) -* Hxq that it is well-founded. 
DEFINITION 3.2. Let Ho 0 be a set and let x ~-* Hx, x E H, HX c H, be a mapping. 
We shall say that this mapping is well-founded if every sequence Xl X2, ... E H 
such that xk+1 E HXk, k= 1, 2,..., is finite. 
LEMMA 3.3. The mapping x -* Hx, x E H, HX C H, is well-founded if and only if 
there exists a decomposition H= Ua <l Ha (i is an ordinal) such that a <,B implies 
Ha n H# = 0, and for every x EH < , x t, HX C UA <a HA. 
Proof. That from the existence of such a decomposition follows the well- 
foundedness of x w-* Hx is clear. 
Assume now that the mapping is well-founded. Define Ho={x I x E H, HX= O}. 
Note that Ho # 0. Define by transfinite induction 
Ha x I x E H, x Y U HA, Hx C U HA} 
A<a A<a 
The sets Ha are mutually disjoint. Let ,u be the smallest ordinal such that HA = 0. 
Assume that D = H- Ua <A Ha # 0. For every x E D there exists a y E HX such that 
y E D. This entails the existence of an co-sequence (xk)k <, such that xk +1 E HXk, 
k < co, a contradiction. 
LEMMA 3.4. With the same notations as in Lemma 3.2, define an invariant subset 
Ws Vr, by the condition: (v, T) E W if and only if there exist a set Hs Tx Q and 
20 M. 0. RABIN [July 
a mapping (x, q) -? Hx (x, q) E H, such that conditions 1-3 of Lemma 3.2 hold, and 
in addition: (4) the mapping (x, q) HX q is well-founded. The set W isf.a. definable. 
The proof of this lemma will be given in ?3.7. 
3.5. Simultaneous runs. Trying to recognize whether a 2-tree t = (v, T) is in the 
set A of Lemma 3.2, we may proceed as follows. For each q E Q we construct a 
n-automaton Zq which can move on a 2-tree t = (v, T) and accept it only if for some 
HAcq ' (T- {A}) x Q, the tree t marked at HA,q is accepted by Wq. The construction 
of 53q is essentially the one used in the proof of Theorem 1.4. Intuitively speaking, 
what S8q does is to "guess" at each x E T how v(x) can be supplemented by a 
Q' e P(Q) so that on the pair (v(x), Q') e E xP(Q), 9tq will make the "correct" 
transition. Now, if at x E T the set Q' was used, and q' E Q', then the tree (v, Tx) 
should be accepted by eq'; to check this, we must run a copy of 3q' on (v, Tx). In 
this way, more and more copies of the automata 53q, q E Q are activated, and this 
process cannot be directly described by a finite automaton. 
The crucial observation is that for any y E T, even though many copies of a '3q 
may have been activated at various x <y, at y the number of different states of 53q 
which appear is still bounded by the cardinality of the set of all states of Zq. Thus, 
all the copies of Q,q reaching y in the same state s can be replaced by just one of 
these copies. In this way, we have, at any node y, just a bounded number of copies 
of each 5q, and this can be described by a finite 2-table. In addition to having 
copies of 5q move on (v, T), we will also need to record which copies merged when 
reaching the same state. The above considerations motivate the following formal 
definition of a 2-table Z3. 
In order to simplify notations, we shall formulate Definition 3.3 and prove 
Lemmas 3.2 and 3.4 for the case c (Q) = 1. The treatment of the general case, 
however, will be essentially the same. 
Let Q = {q} and let Wq = = <S, M, so, F> be a E x {0, {q}}-automaton. Assume 
c (S)=n, and denote [n+ 1]={1, .. ., n+ 1}. 
DEFINITION 3.3. For 9 as above, define the 2-table Z=<SKS, MB> as follows: 
Set U={u: E -S I u is 1-1, Ec [n+ 1]}; D={d=(d1, d2,d3) I d1 c [n+ 1]; d1 =#0 
implies d2={m} c [n + 1]; d1 = o implies d2=0; d3: E -*Ec [n+ 1]}. Define now 
S3 and MS by SS3={(u, d) I ue U, de D, d1cD(u), d2:#0 implies d2$D (u), 
R (d3) = D (u)}, where R (q) and D (q) denote the range and domain of 0; 
((u', d'), (u", d")) e Mz((u, d), a) 
if and only if D (d3) = D (d3) = D (u) u d2 and 
(u'(d0(m)), u"(d"(m))) e M(sO, (a, 0)), for m E d2, 
E M(u(m), (a, {q})), for m E d1, 
e M(u(m), (a, 0)), for m E D (u)-d1. 
For later use, we also introduce an initial state st E S3 defined by 
s= ({1,so>}, (o, 0, {1, 1>})). 
19691 DECIDABILITY OF SECOND-ORDER THEORIES 21 
The interpretation is that if (u, d) E S3, D (u)={m1, . . ., mk}, and d= (dl, d2, d3), 
then the "copies" Ml... ., mk, of t are active and in the states u(m, ... ., U(Mk); 
the copies m' E d1 c D (u) behave as if they see (a, {q}); the new copy m E d2 is 
activated in the state so; and, finally, the copies m1, . . ., Mk, are the replacements, by 
the mapping d3, of the copies m E D (d3) of % active at the piredecessor node. 
DEFINITION 3.4. Let r E Rn (Z, (v, T)) and r(A) = s'. Denote r(x) = (uX, dx), 
dx=(dlx, d2x, d3). We shall say that m E [n + 1] is active at x E T if m E D (ux) u dx. 
Also, m E [n+ 1] is activated at x c Tif m= 1 and x=A, or m E d2l. 
Let m be active at x and let y=xO or y=xl. We say that m at x is replaced by m} 
at y ((m, x) - (m1, y)) if m1 = d3(m). The notion of replacement is extended by 
passing to the transitive closure. Thus, assume x <y, x = x0, xi +1= xii, ei E {0, 1}, 
O 
_ 
i < k-1, and y = Xk. We shall say that m at x is replaced by m' at y ((m, x) 
(m', y)), if for a sequence mi E [n+ 1], 0 i_ k, mO = m, mk= m', and (mi, x) 
>(Mi+1, xi+l), 0O_i_k- 1. 
LEMMA 3.5. Let r E Rn (Q3, (v, T)), (v, T) E V2, and r(A) =s3. Denote again r(x) 
by (ux, dx). Define H= ({A} u {x I d2x 0 }) x {q}. 
For (x, q) E H, let m be activated at x; define 
Hx-q = {y I x =A y E Tx, 3m'[(m, x) -+ (m', y) and m' E dl]} x {q}. 
For (x, q) E H and m as above, define rx,q: Tx -* S by rx,q(x) = so; rx,q(y) = uY(m'), 
if x < y E Tx and (m, x) --. (m', y). 
For (x, q) E H, rx,q is an 9X-run on the tree (v, T.) marked at Hx 
The proof is clear from the definitions. 
3.6. Proof of Lemma 3.2. We still restrict ourselves to the case Q = {q}, and 
retain the notations of ?3.5. Let A c Vy, be as in Lemma 3.2. We claim that (v, T)eA 
if and only if there exists a 23-run r: T -S93 on (v, T) with r(A) = s, such that for 
every path vc T, and every x E -, at which some m E [n+1] is activated, 
In (rx,qlj) c F. 
Assume the existence of such an r. Define H, and a mapping (x, q) Hx ' 
(x, q) E H, as in Lemma 3.5. Now rx,q: Tx - S is an %-run on the tree (v, Tx) 
marked at Hx . Our condition implies that this tree is accepted by %. Thus, 1-3 of 
Lemma 3.2 hold and (v, T) E A. 
Assume (v, T) E A and let H and (x, q);> Hx,q satisfy 1-3 of Lemma 3.2. Thus 
for every (x, q) E H there exists an 2-run rx on the tree (v, Tx) marked at Hx,q with 
rx(x) =so, such that for every path x E ic T, In (rxI 7) E F. 
We shall define a 53-run r: T-* S? and show that it satisfies the above condition. 
The run r will have some additional properties. If m E D (uX) u dx, y = xO or y = xl, 
and m E D (uy), then dy(m) = m will hold. Thus we shall have a well-defined function 
px: D (uX) u d2x - {y I y ? x}, such that px(m) =y if m was last activated at y. In 
particular, if m e d2x, then px(m) = x. We shall use this function in the sequel, 
writing p(x, m) instead of px(m). 
22 M. 0. RABIN [July 
Also, if m E D (ux), then (p(x, m), q) E H, uX(m) = rI,(xm)(x); and m E djx only if 
(x, q) C HoP(xm),q. Thus, if the copy m of W was activated at y, then (y, q) E H, and m 
goes through the run ry until replaced. 
The values r(x) will be defined by induction on 1(x). Set r(A) = s; thus p(A, 1) = A 
(recall that 1 is activated at A). Assume that r: {x I 1(x) < n} -* SF is defined, is the 
restriction of a 2-run, and has the special properties mentioned above. For x with 
1(x)=n, we shall define r(xO); the definition of r(xl) is completely analogous. For 
m E D (ux) u d,, where 1(x) = n, denote rp(x,m)(xO) by s(m). 
The idea is that in going from x to xO, all the m' E D (ux) u dx for which s(m') = s 
are replaced by that m for which s(m) =s and p(x, m) is minimal. This leads to the 
following formal definitions. 
Put D (uxO) = {m I m iE D (ux) u dx, p(x, m) < p(x, m') for all m' such that s(m) 
-s(m')}; uxO(m)=s(m), for m E D (uXO). Note that uXO is 1-1. dx0=={m j m E D (uxO), 
(x0, q) E fto(x,m'q}. If dx? 0, then set d-= {m} for some m E [n +1 - D (uXO) (this 
set is nonempty); otherwise, put dx0 =0. Define d3xO(m') = m for m' E D (uX) U d2, 
m E D (uxo), s(m') =s(m). 
It is readily checked that these definitions extend r to a mapping 
r:{xIl(x)?n+1}->S V 
which has the same properties as the original mapping. 
The above inductive definition yields a well-defined function r: T - S$. It is 
easily verified that r is a 93-run on (v, T). Now, using the notion of replacement 
(Definition 3.4), (m, x) -* (m', y) and m #A m' imply that p(y, m') < p(x, m). This 
implies that along every path x, for every x E 7r and m which is activated at x, there 
exists a y > x and a m' such that (m, x) -> (m', y) and, along that path IT, m' at 
p(y, m') = w is always replaced by itself; i.e., for w <z e , (m', w) -+ (m', z). 
Hence, for z y, z EIT, rx,q(z) = rw,q(z) (see Lemma 3.5). But In (rw,q1T) = In (rwIT) E F 
which proves our assertion. 
The proof that A is f.a. definable will be completed by showing that the property 
of the paths 7i- Tthat for every x E 7T and m E [n+ 1+] activated at x, In ((rx, qjI)) E F, 
is recognizable by a (sequential) automaton, and appealing to Theorem 3.1. 
Let Dc (SO)O be the set of all sequences 8 = ((uk, dk))k< > such that (u?, d0)= 
and D (dk + ')= D (Uk) u dk. Note that for every 23-run r on any t E VE, and every 
path IT, (rc-T), E D; thus, it suffices to restrict ourselves to sequences in D. The set D 
is obviously f.a. definable. 
The notions of m E [n + 1 ] being activated at k, 0 < k < c, and of m at k being 
replaced by m' at k' > k ((m, k) -* (m', k')), are defined for sequences 8 E D in the 
same way as the corresponding notions were defined for runs r e Rn (53, t) 
(Definition 3.4). Similarly, we have for k < w and m E [n+ 1] activated at k, the 
sequence &k,q E SO of states of t. 
What we must show is that the set Bc (S3)0, B= { c E D, for every k < w and 
m activated at k, In (8k,q) E F}, is f.a. definable. This will be done by constructing a 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 23 
nondeterministic (sequential) automaton ( = <S(, M(, S6, F(> such that D rl Tj(Y) 
= D - B. (We do not care about what C accepts outside of D.) Define S- = {e} u 
([n+1] xS), where e is a "new " element, and S is the set of states of t. Put 
MI(e, (u, d)) = {e, (m, so)} for m E d2, (u, d) E S43. Define 
M%((m, s), (u, d)) = e if m 0 D (d3), 
= (d3(m)), u(d3(m)), for m e D (d3). 
Finally, define S = {e, (1, so)}, and Th= {H I Hc [n +1] x S, p2(H) e P(S) - 
(F u {0})}. We have D r) T>,(C,) = D -B and this proves that B is f.a. definable. 
3.7. Proof of Lemma 3.4. We use again the automaton Q3 (Definition 3.3) and the 
concepts and notations of Definition 3.4, Lemma 3.5, and ?3.6. Note that we again 
assume Q = {q}. 
Let Wc V, be as in Lemma 3.4. We claim that (v, T) E W if and only if there 
exists an r E Rn (5l3, (v, T)) with r(A) = sA, so that for every path 7r c T: (i) for every 
x E vT and m E [n+ 1] activated at x, In (rx,qI7r) E F; and (ii) every sequence 
(Xk, MkI, hik), k= 1, 2, .. ., such that Xk E , m k is activated at Xk, Mk lc dXk+ , 
and (ink, Xk) -> (Mk + 1, Xk + 1), is finite. 
Assume the existence of such a run r. Define the set Hc Tx {q}, the mapping 
(x, q) Hxq and the W-runs rx,q: Tx -* S, (x, q) E H, corresponding to this run r 
as in Lemma 3.5 and the proof of Lemma 3.2. By the proof of Lemma 3.2, con- 
dition (i) on r implies that H and (x, q) F-* Hxq satisfy conditions 1-3 of Lemma 3.2. 
Assume now that (Xk)k I is a sequence such that (Xk+i, q) E HXk,q, k <w. This 
relationship implies Xk<Xk+ , k<cw. Therefore, there exists a unique path irc T 
such that xkc E i, k< . Let mi-k E [n+ 1] be activated at Xk, and Mk+l E [n+ 1] be such 
that (mik, Xk) -* (Mk+1, Xk+1). Now (Xk+1, q) e HXkq. This implies, by our defi- 
nitions, that Mk+l+ edLk +1. Thus the sequence (Xk, Mk, rnk)k < satisfies the con- 
ditions of (ii), but is infinite, a contradiction. Hence (x, q) v-* Hx,q is well-founded 
and thus (v, T) E W. 
To prove the asserted implication in the other direction, assume the existence of 
H_ Tx{q}, and a mapping (x,q)+-*Hx,q, (x,q) eH, satisfying conditions 1-4, 
of Lemma 3.4. Let rx: Tx -* S, for (x, q) e H, be an W-run on the tree (v, Tx) 
marked at Hx q such that rx(x) =so and for every path ITc Tx, In (rx17T) E F. 
Since (x, q) -* Hx,q is well-founded, H can be decomposed as in Lemma 3.3. 
Define a mapping Od: H-- {a I a < ,u} by Od (x, q) = a if and only if (x, q) E H,. We 
have that (y, q) e Hx,q implies Od (y, q) < Od (x, q). 
As in the proof of Lemma 3.2, define by induction on 1(x) x E T, a 23-run r: T-V, 
and a function px: D (ux) u d2x - T. The only difference will be in the definition of 
D (UXO); here we define it as follows: 
D (uXO)={m I m iE D (uX) u d2x; for all m' such that s(m)=s(m') either 
Od (p(x, m), q) < Od (p(x, m'), q), or Od (p(x, m), q) = Od (p(x, m'), q) and p(x, m) 
<p(x, m')}. 
24 M. 0. RABIN [July 
The idea behind this definition is that in going from x to xO, we replace all the 
m' e D (ux) u d2 such that s(m') = s by the m with s(m) = s for which p(x, m) is 
minimal with respect to the lexicographic ordering: (Od (y, q), y) <(Od (z, q), z) 
if Od (y, q) < Od (z, q), or Od (y, q) = Od (z, q) and y < z. Note that for a fixed path 
7r, this is a well-ordering of {(y, q) I y E -T, (y, q) E H}. 
If (m, x) -* (m', y) and m :A m', then (Od (p(y, m'), q), p(y, m')) < (Od (p(x, m), q), 
p(x, m)). This entails, in exactly the same manner as in the proof of Lemma 3.2, 
that for every path JT c T, In (rx qf7r) E F. Thus (i) holds for r. 
To show that r satisfies condition (ii), let (xk, mk, fik), k= 1, 2, . . ., be a sequence 
such that Mk+1 c dXk+i, r, is activated at Xk, and (fik, Xk) Mk( k+1, Xk+ 1). The last 
two conditions imply Od (Xk, q) = Od (p(Xk, fik), q) > Od (p(Xk + 1, mk + 1), q). Denote 
P(Xk + 1 mk + 1) by y. From the definition of r it follows that mk + 1 E d, k + 1 implies 
(Xk + 1, q) E H'yq. Thus, Od (y, q) > Od (Xk + 1, q). Combining with previous re- 
lations, we have Od (Xk, q) > Od (Xk +1, q); this forces the sequence to be finite and 
establishes (ii). 
To complete the proof that W is f.a. definable, we must again show that the 
properties (i) and (ii) of a sequence r 1r are recognizable by a (sequential) automaton. 
Again we consider 8 = (rIi.r)C and restrict ourselves to 8 E D (see end of ?3.6). For 
property (i) this has already been done in the proof of Lemma 3.2. Since the class of 
definable subsets of (SO)I' is closed with respect to intersections, it suffices to show 
that the set Bc D of all sequences 8 with property (ii) is f.a. definable. 
It is again easier to show that the complement of the set of sequences with pro- 
perty (ii) is f.a. definable. Let Cc D be the set of all sequences . = ((uk , dk))k<,, 
8 e D, such that there exist an increasing w-sequence (ki)i<, of integers and 
sequences (mij)i < o, (miji < ., such that /mi7 is activated at ki, (mii, ki) - (mi + 1 ki + 1) 
and mij+ 1 kj+j for i < c. We shall show that C is f.a. definable. 
Construct an SO-automaton 9 -= S<, M0, g, FP> as follows. Define S6 = {g} 
u ([n + 1] x {e, f}), where g, e, f are any new elements. M6(g, (u, d)) = {g} 
u {(m, e) I me d2}, (u, d) e SO. Let s=(m, e) or s=(m,f), me [n+ 1], define 
MI(s, (u, d)) = g if m 0 D (d3), 
= {(d3(m), e)} if d3(m) dl 
= {(d3(m), e), (m',f)} if d3(m) e di, {m'} = d2. 
Set F(-= {G I G c SI, G n ([n + 1 ] x {f})#0}. It is readily seen that T,,(&) n D 
= C = D -B. This implies that B is f.a. definable. 
3.8. Dual acceptance by automata. In order to analyze the structure of the 
complement V, - T(9t) of a f.a. definable set, we need certain auxiliary concepts. 
DEFINITION 3.5. Let Q = ((Lf, Ut))1 i ?i k be a - sequence of pairs of sets. For a 
mapping 5: A -* S we shall say that f is of type Q (notation: f E [Q]) if for some i, 
1 < i_5 k, In ( ) rfl 0 and In ( ) r Li = 0. Furthermore, we shall say that S is 
of type Q-empty (5 E [Q, e]), if f E [Q] and for some j, 1 <j _ k, +(A) r Lj = 0 . 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 25 
The following concept is, in a sense, dual to the notion of the set defined by an 
automaton. It will turn out, in fact, that every complement of a f.a. definable set 
can be described in this way. 
DEFINITION 3.6. Let t = <S, M> be a s-table, s e S, and let Q be as above. We 
shall say that ?, with Q and s, (dually) accepts (v, T,) (notation: (v, T,) e D (?, Q, s)) 
if for every r e Rn (%, (v, Tx)) satisfying r(x) = s, there exists a path lTc T, such that 
ruT S [-Q]. Using formal notation: 
(v, T,) e D (%, Q, s) Vr3,z[r e Rn (%, (v, Tx)) A r(x) = s -r r I [Q]] 
Notice that the prefix Vr3r in the above definition is dual to the prefix 3rWir 
in the definition of acceptance by an automaton (Definition 1.5). 
LEMMA 3.6. For every EY-automaton t = <S, M, so, F> there exists a 2-table 
=<SO, MO>, a sequence Q of pairs of sets, and an element so e SO such that 
(v, T) e V -T(9T12) if and only if (v, T) e D (Z, Q, so). 
Proof. We have (v, T) e V, - T(9) if and only if 
(3.1) Vr 3w[r e Rn (%, (v, T)) A r(A) = so -* In (r uT) eP(S)-F]. 
Arrange P(S)-F-{0} in a sequence (Sl, S2, S...Sk). Set Q=X1f9ikP(SV), 
and S= Q x S. The table MO is defined by 
((ql, sl) (q2, S2) C- M3((q, s), 'g), (q, s) c- Q x S, 
if and only if (Sl, 52) c M(s, a) and, for 1 ? i? k, j= 1, 2, 
qj(i) = q(i) U {s}, if s e Si, q(i) # Si, 
= q(i), if s 0 Si, q(i) #A Si, 
= 0, ifq(i) = Si. 
Finally, set so = (qo, so) where qo(i) = 0 for 1 < i ? k. 
Let r e Rn (Z, (v, T)). The mapping p2r: T S is an t-run on (v, T) with 
p2r(A) =so, and every t-run is obtained in this way. 
Define now, for 1<_ik, L4={(q,s) qe Q,seS-S-} U={(q,s) I qe Q,seS, 
q(i) = S,}; let Q = ((Li, Ui)) l i k- 
Let r e Rn (Z, (v, T)), and let c T be a path. For a fixed i,- 1 ! i < k, In (p2rI7r)= 
Si, if and only if In (r IT) n U1 = o and In (rIl) n Li = 0; i.e., In (p2r1) F if and 
only if rn7r e Q. Thus (3.1) holds if and only if (v, T) e D (3, Q, so). 
LEMMA 3.7. Let %t= <S, M> be a 2-table, s e S, and Q = ((Li, Ui))l1i?k. Let A be 
the set of all E x P(S)-trees I such that t= (v, T,) e A if and only if 
(3.2) Vr[r e Rn (9, p,(i)) A r(x) = s 
34[rJIT e [L]] v 3y[y e Tx A 9(y) = (g, q) A r(y) e q]]. 
There exist a 2-table 53 =.<SO, MO>, a state so e- SO, and a sequence Q = 
((LU, U)) ?It<k such that A= D (Z, Q, so). Note that here the length of Q equals 
that of Q. 
26 M. 0. RABIN [July 
Proof. Let u 0 S. Set SO = S u {u}; so =s. Define M (u, a) = {(u, u)} for & e S. 
For s e S, g oe 2, q e P(S), define 
M3(s, (g, q)) = M(s, a), for s 0 q, 
={(u,u)}, forseq. 
We see that for a 3-run r on a s-tree (v, Tx), either there exists a y e T, such that 
e(y) = (ag, q) and r(y) e q, in which case r(z) = u for all z > y, or r is also an W-run 
on the s-tree pj((e, Tx)). 
Let U1=u1 u {u}, Li=Li, 1<i< k, U =Ui, 2<i<k, 2=((L1, Ui))1<i< k. With 
these definitions, A= D (5, R, so). 
LEMMA 3.8. With the same assumptions and notations as in Lemma 3.7, let B be 
the set of S-trees such that 1t= (v, T,) e B if and only if 
Vr[r e Rn (k, pj(1)) A r(x) = s 
- T > [. T c T, A r 1Te [Q, e]] v 3y[y e T, A e(y) = (ag, q) A r(y) eq]]. 
There exists a table 5 = <SO, MO>, a state so S SO, and a sequence 
C = ((Li, UV))1 ?< i k, 
such that Lk = 0 and B= D (3, Q, so). Again the length of Q equals that of Q. 
Proof. Set [i]={1, .. ., i}, O_i<k. Define (D by 'D={? I ?: [i] - [k], ?1 is 1-1, 
O<i?k}. Note that (D contains the function ?: 0 [k]; i.e., 0 5 (D. Define 
SO=(D x S) u {u}, and so=(0, s). 
We. shall define MO so that Q3-runs will have the following features. If ro is a 
5-run on t = (v, T) and rO(x) : u for all x e T, then r=p2rO is an W-run on pl(i). For 
rO(x) = (b, s), where b: [i] -* [k], L o() . .., Li(i), will be, in order of appearance 
along {yI y < x}, the Lj for which Lj rn r({y I y < x}) : 0. The state u will appear 
if and only if for some y e T, e(y) = (ag, q) and r(y) e q. This motivates the following 
formal definitions. 
Let (0, s) e SO, where 1: [i] [k]; i =(g, q) EX xP(S). Define M ((0, s),a) 
-{(u, u)} if s e q; also, MO(u, 0) = {(u, u)}. In all other cases, let b = {j I s e Lj}, 
denote b-R (?) ={ji, . . ., ji} where 1l<12 < ... <ji, and define +: [i+n] -* [k] by 
0 I [i]= 0, +(i+m)=jm, 1 <m<n (if b-R (?)= 0 then =f4). With these notations, 
define M%((, s), &) = {((q, S1) (q, S2)) I (S1, S2) M(s, a)}. 
For ?<i<k define Ui={(?f,s) I ieD(0)#[k],>(i)=j implies se Uj}; Li= 
{(q, s) I i e D (q) # [k], q(i) =j implies s e Lj}. Finally, define Uk = {u} U {(0, s) I for 
some i, 1i <i< k, i 0 R (O) and s e U}; Lk = 0 . Set Q=((Li, Ui)) ?< i k. It can now be 
verified that B= D (93, Q, so). 
3.9. Results concerning D (W, Q, s). To prove that the class of f.a. definable sets 
is closed under complementation, it suffices, by Lemma 3.6, to show that sets of the 
form D (W, Q, so) are f.a. definable. The proof will be accomplished by induction 
on the length l(Q) of Q. Assume that the statement has been established for all sets 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 27 
D (WI', Q', S) where t' is a table over any alphabet Z' and l(fQ')=k- 1. We shall 
prove that for every s-table ?, every sO e S2, and every sequence Q = ((Li, U2))1 ? i I k, 
the set D (W, Q, so) is f.a. definable. The induction from k-I to k will actually 
proceed in two "half-steps" (?3.11). 
This plan calls for an analysis of (v, T) e D (W, Q, so) by dual acceptance in- 
volving shorter sequences Q'. 
LEMMA 3.9. Let % =<S, M>, ??=((Li, Ui))l1? ik, and Qk-1=((L , Uf))l?t?l.k-1 
If t = (v, T) e D (v, Q, so), then there exists a set H0o (T- {A}) x Uk such that 
(1) (x, s) e H0 implies (v, T,) e D (W, Q, s); (2) for every t-run r on t satisfying 
r(A)=so, if rji7 [k-l1] for every path fcT, then there exists a (x, s) e H0 with 
r(x) = s. 
Proof. Define 
(3.3) H0 = {(x, s) I x e T-{A}, s e Uk, (v, T,) e D (W, Ql, s)}. 
Condition 1 holds for this H0. Assume now that r is an ?-run on (v, T) with r(A) 
=so, such that rlji , [Qk-1] for every path ff cT, and r(x)#As for every (x, s) e H0. 
Let H ={ITr I IcT, r(IT-{A}) n Uk#A o}. Define a mapping 7rh- x(7T), Tr e H, by 
x(7T)=min {y I A#y e 7r, r(y) e Uk}. If 7r, 7T' e H, then either TX(,)=TX(7,,) or 
Tx(,,) n T,(.,,) = o . 
Note that the set D = T- Ug, Tx(n) contains no y = A with r(y) e Uk. Con- 
sequently, for every path I(C D, rj 1T [Q]. 
Since (x(v), r(x(7r))) 0 Ho for 7r e Hl, there exists a run r,,: Tx(n) -* S with r (x(IT)) 
- r(x(7r)) so that for every path 7r' c TX(,), r, 17r' 0 [Q]. Define an ?-run r': T-- S by 
r'(y) = r(y), if y 0 U Tx(n), 
= r,(y), if y e Tx(,) for some fT e H. 
We have r'(A) = r(A) = so. Let IT' c T be a path. Either IrT'c D which implies rIW' 
= rtl', and hence r'tlr' 0 [Q]; or for some7r c eI we have that 7r'-Tx(,) is finite and 
hence again r't7r' 0 [Q]. Thus (v, T) 0 D (%, Q, so), a contradiction. This establishes 
condition 2 for Ho. 
REMARK. The above lemma, and its proof, remain valid for k= 1. In this case 
1k-l is empty and we stipulate that rIir 0 [Pk-l] always holds. The same remark 
applies to the following 
LEMMA 3.10. Let 1t= <S, M> be a 2-table; Ql=((Li, Ui))l?i?k with Lk= 0; 
Qk-l=((Li, Ui))l_i:?k-l; and so e S. A Y-tree (v, T) is in D (?, Q, So) if and only if 
there exist a set Hc (T- {A}) x Uk u {(A, SO)} anda mapping (x, s) H-> HX.s, (x, s) eH 
such that (1) (A, so) e H; (2) for (x, s) e H, HX.s-((Tx -{v}) x Uk) n H; (3) for 
(x, s) e H, 
Vr[r e Rn (9t, (v, Tx)) A r(x) = s -* 37r[7r c Tx A rj17 e [Qk-1]] 
v 3y[x =A y e Tx A (y, r(y)) e HX.s]]. 
28 M. 0. RABIN [July 
Proof. Assume existence of H and (x, s) H+ HX,s satisfying 1-3. Let r be an 
%-run on (v, T) with r(A) =so. We must prove the existence of a path irc T with 
nITr e [Q]. If for some ITc T, Ir I [Qe k- 1] then we are done. Otherwise, for every 
subtree (v, Tx) and every ITc TX, (rITx) I IT=rIIT v [Q4- ]. By 1-3 there exists a 
x0 > A such that (x0, r(xo)) e H and, hence, r(xo) e Uk. By 2-3 there exists an x1 > x0 
such that (x1, r(xl)) e H and again r(x1) e Uk. Continuing in this way, we get an c 
sequence (xi)i < ,, such that xi < xi + 1, r(xi) e Uk, i < w. For the unique path i(c T such 
that xi e r, i <, we have In (rIT) n Uk#= 0 and In (rIT) n Lk=In (rln) n 0 = 0; 
thus rIT e [Q]. 
To prove the other direction, assume (v, T) e D (%, Q, so). Define H={(A, so)} 
u Ho, where Ho is as in (3.3); thus, (A, s0) e H. Applying Lemma 3.9 to each tree 
(v, Tx) and s e S such that (x, s) e H, we obtain the existence of a set Hx', H such 
that 2-3 hold. The mapping (x, s) w-* HX,s is the desired one. 
REMARK. For the case k= 1, Lemma 3.10 reads: Let 9t= <S, M>, so e S, and 
Uc S. A s-tree t = (v, T) satisfies 
Vr[r e Rn (t, t) A r(A) = so -* 3[In (rlI) n U =# 0]] 
if and only if there exist a set H and a mapping (x, s) i-* HX,s satisfying 1-2 of 
Lemma 3.10 and: (3') for (x, s) e H, 
Vr[r e Rn (9, (v, Tx)) A r(x) = s -+ 3y[x # y e Tx A (y, r(y)) e Hx s]]. 
LEMMA 3.11. Let t= <S, M> be a Y-table, Q2=((Li, Ui))l?i9k, and so e S. 
(v, T) e D (v, Q,_ so) if and only if there exist a set Hc Tx S and a mapping (x, s) 
HXS, (x, s) e H, such that 
(1) (A,so)cfH; 
(2) H c (Tx-{x}) x S and HX,s _ H; 
(3) if (x, s) e H then 
Vr[r e Rn (9, (v, Tx)) A r(x) = s - 37T[I7T c Tx A rnIr e [Q, e]] 
V 3y[x # y'e Tx A (y, r(y)) e Hx,s]]; 
(4) the mapping (x, s) ~-* HX,s is well-founded. 
Proof. Assume that t = (v, T) satisfies the conditions concerning the existence of 
H and (x, s) v-* HX,s. Let r: T -+ S be an t-run with r(A) =so. We must prove that 
for some path I(c T, rT 17e [Q]4 If for some path Ir- T we have nr ITe [Q, e], then we 
are finished. Otherwise, by conditions 1 and 3, there exists a (x1, si) c HA so such 
that r(x1)=s;. If for some path ,7cz T,1 we have rl7T c [Q, e], then again we are 
finished. Otherwise, since (x1, s1) e H, there exists a (x2, S2) e Hxlsi with r(x2) =s,; 
and so on. Since the mapping (x, s) ~-* HX s is well-founded, we must arrive at a pair 
(xn, s,) e H such that r(xn)=sn and for some path ITc2Tx., rIT re [Q, e]. Let I' 
={ y I y _xJ} U i7. Then -7' is a path of T and rlj7r' c [Q]. 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 29 
Assume, conversely, that t E D (5, Q, s0). Let Ho c Tx S be defined by (x, s) E Ho 
if and only if 
Vr[r E Rn (%, (v, Tx)) A r(x) = s - 37r[7rC T, A rluT E [Q, e]]]. 
A sequence of sets Ha, ( Tx S will be defined by transfinite induction on a. Set 
Ga= UA<, HA. Define HI, by (x, s) c Ha if and only if(x, s) 0 Ga and 
Vr[re Rn (W, (v, T,)) A r(x) = s -?3r[T c Tx A rlr E [Q, e]] 
v 3y3s,[(y, sl) E Ga A r(y) = sj]] 
There exists an ordinal , such that H, = 0. Set H= G, (= UA<, HA). For 
(x, s) E H let a < ,u be such that (x, s) E Ha. Define Hx.s = ((Tx-{x}) x S) rn G. 
Our definitions insure that H and the mapping (x, s) H? Hx s satisfy conditions 2-4. 
It remains to show that (A, s0) E H. 
Assume that (x, s) 0 H. There exists an W-run rx,, on (v, Tx) such that rx,,(x) =s 
for every y e Tx we have (y, rx,,(y)) 0 H, and for every path vc Tx we have 
rx, sl 1,T [Q, e]. 
Thus, if 7rc Tx and rx,s,IT E [Q], then there exists a minimal y(r), x<y(IT) G 7T 
such that rx,s({z I x?z<y(7T)}) n Lj:# o for all 1 ? i<k. Define F(x, s)={y(ir) I 7 
c Tx, rx,8Ii E [Q]}. The set F(x, s) consists of pairwise incomparable elements. 
Notice the Tx- UYEF(x,s) Tycontains no path 7T with rx,,17T e [Q]. 
Assume by way of contradiction that (A, s0) 0 H. Define by (ordinary) induction 
a sequence (En)n < c, En C T, and a mapping 4: Un <, E,, -* S. Let Eo = {A}, +(A) = s0. 
Assume that En and 0: E, -+ S are already defined, that (y, +(y)) 0 H for y E En, 
and that the elements of En are pairwise incomparable. Define En, +1 = 
UyeEn F(y, 0(y)). Since F(y, /(y)) T - {y} and the elements of F(y, 0(y)) are 
pairwise incomparable, it follows that the elements of E,,+ 1 are pairwise incom- 
parable. 
For every x E E,, there is a unique y E En such that x E F(y, +(y)). Define 
b: E,,,+ --l S by 
+(x) = ry?(,)(x), x E F(y, +(y)), y F, En- 
Again, (x, +(x)) 0 H for x En +,1. 
For x E T there exists a maximal n such that for some (unique) y E En we have 
x E T,. Define a mapping r: T -* S by r(x) = r ,,,(,)(x) where x and y retain their 
above meanings. It can be verified that r is an %-run on (v, T). 
We wish to show that for every path i c T, rl IT 0 [Q]. This will contradict (v, T) 
E D (2, Q, so) and, therefore, imply (A, so) E H, thus finishing the proof. Observe 
that the construction of (En)n < ,, and the fact that F(y, +(y)) c Ty - {y}, imply that if 
Vn E,,# 0 then c (7r n En) = c (7T n Fm) 1= for 0 _ m ? n. Thus there either exists 
a maximal n such that 7T n En# z , or else 7T rl En, z for n < Co. 
30 M. 0. RABIN [July 
In the first case, let IT rE = {x}. We have 
ITr ={yIye?T,x <y} C TX- U Ty = D. yeF(x,?(x)) 
For y E D we have r(y)=rX, O(x)(y). Hence r Ir'=rX ,(x) 1r f [Q], so that nIr I [Q]. 
In the second case, let Ir n En = {xn}, n < cw. Now x., +1 E F(xX, i(xn)) for n < w. 
Hence 
r({y I Xn < Y < Xn+l}) n Li = rXnf,(Xf)({y I Xn < y < Xn+1}) PI Li =# 0, 
for 1 <i<k. Thus In (r I ) nLi #0, 1 <i<k; this again implies r I I [Q]. 
3.10. Automata on finite trees. We recall some facts concerning automata on 
finite trees. Our formulation differs from the one employed by Doner, Thatcher, 
and Wright (see [3], [16], [12]). It is, however, not hard to prove the equivalence of 
the various definitions. 
A finite binary tree is a finite subset Ec T, closed with respect to the predecessor 
function pd. The nodes x E E for which xO 0 E and xl 0 E, are called the terminal 
nodes of E. The set of terminal nodes of E is called the frontier of E and is denoted 
by Ft (E). A finite binary tree E is called frontiered if x E E and x 0 Ft (E) imply 
xO E E and xl E E. The term finite tree will, henceforth, always mean finite fron- 
tiered tree. 
Let E be a finite set. A finite E-tree is a pair (v, E) where v: E- Ft (E) - . 
A s-automaton on finite X-trees is a system % = <S, M, so, f> where S is a finite 
set, M: Sx2E -+P(Sx S u {(f,f)}), so E S, andf S. 
The notion of an t-run on (v, E) is completely analogous to Definition 1.4. 
We shall say that % accepts t = (v, E) if for some t-run r on t, r(A) = so and r(x) =f 
for x E Ft (E). The set of all (v, E) accepted by % is denoted, as usual, by T(%). 
Whether this notation refers to the finite or infinite case will be clear from the 
context. A set B of finite s-trees will be calledfinite automaton definable if for some 
W, B-=T(%). 
The f.a. definable sets of finite E-trees form a boolean algebra. There exists a 
natural one-to-one correspondence between the f.a. definable sets of finite {0, l}n- 
trees and the n-ary relations between finite subsets of {0, 1}* which are definable 
in the weak second-order theory of two successor functions. 
If (v, T) is a s-tree and Ecz T is a finite tree, then we shall denote the finite s-tree 
(v I (E- Ft (E)), E) by (v, E). 
LEMMA 3.12. Let A be a f.a. definable set of finite 2-trees. Let Bc V(, be the 
invariant set defined by the condition: (v, T) E B if and only if there exists afinite tree 
Ec T such that (v, E) E A. The set B is fa. definable. 
Proof. Let A = T(W) where W = <S, M so,f>. Set -=S u {f}. Define M: S x E 
--P(Sx3) by M(s,a)=M(s,a) for seS, M(f,a)={(f,f)}. Define 3=K<S,M, 
so, {{f}}>. We claim T(93) = B. 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 31 
That B c T(3) is quite obvious. To prove T(Q3) cB, assume t = (v, T) E T(13). 
Thus, for some r e Rn (Z3, t), r(A) =so and In (rlIr) = {f} for every path 7T. Define 
x(r)=min{xIxe-T,r(x)=f}. The set E={yIy<x(Ir) for some ITcT} is a finite 
(frontiered) tree. Let t= (v, E). rIE is an W-run on t and r(x) =f for x E Ft (E). 
Hence, I e A and t e B. 
We shall now fill up the small gap remaining in the proof of Theorem 1.7. 
COROLLARY 3.13. If P is a principalformula (?1.5), then there exists an automaton 
representing it. 
Proof. Assume that P(A1,..., Am) is the formula (1.2). Let 
R = T({| A se P(T)m, W2 k P(A)}) 
A {O, 1}m-tree t-(v, T) is in R if and only if for some x E T, and for 1 ?j?k, 
p1j(v(xwj)) = Ej, where Ej = 1 if -j is e, and Ej = 0 if -j is 0. 
Now, a tree t satisfies this condition if and only if for some finite subtree Ec T, 
(v, E) satisfies it. Since the set of finite {O, 1}m-trees atisfying the above condition 
(which, for finite trees, is expressible in weak second-order theory of %2) is f.a. 
definable, our assertion follows from Lemma 3.12. 
LEMMA 3.14. Let X= <S, M>, so E S and t= (v, T). If Ho ' Tx S is such that for 
every r E Rn (t, t) with r(A) = so there exists an x E T so that (x, r(x)) E Ho, then 
there exists a finite H1 ' Ho with the same property. 
Proof. Assume the conclusion not to hold. Denote Tn = {x I x E T, 1(x) _ n}. For 
every n < w there exists an 9-run rn on t satisfying rn(A) = so and, for x e Tn, 
(x, r.(x)) 0 Ho. By K6nig's Infinity Lemma there exists an increasing sequence 
(n(i)) <o such that for i j]< w, rn(i)ITi = rn(i)ITi. Let r: T -- S be the limiting func- 
tion; i.e., rjTi=rn(?)ITZ, i<cu. r is an %-run on t with r(A)=so. Furthermore, 
(x, r(x)) 0 Ho for all x E T, a contradiction. 
COROLLARY 3.15. Let 91=<S, M> be a L-table, so E S, P=P(S). Let B be the 
invariant set of 2 =X x P-trees defined by the condition: 1t= (v, T) E B if and only if 
for every %-run r on pl(i), if r(A) = so then for some x E T, e(x) = (g, q) and r(x) E q. 
The set B is f.a. definable. 
Proof. Let A be the set of all finite (frontiered) s-trees (v, E) satisfying the above 
condition. The set A is f.a. definable. 
By Lemma 3.14, i E B if and only if for some finite tree Ec T, (v, E) E A. The 
set B is now f.a. definable by Lemma 3.12. 
3.11. Proof of Theorem 1.5. To show that the class of f.a. definable subsets of V. 
is closed under complements, it suffices, by Lemma 3.6, to show that sets of the 
form D (9, Q, so) are f.a. definable. This will be done by induction on l(Q). 
We assume as our induction hypothesis that for all 9 = <S, M> (over any E), 
all sequences Qk,- 1= ((Li, Ui))l ?i k- 1 of length k - 1 and all s e S, the set 
32 M. 0. RABIN [July 
D (%, Qik -, s) is f.a. definable (if k= 1 then our assumption is vacuous). We wish 
to show that the same statement holds for all sequences Q=((Li, Ui))1??ik of 
length k with Lk= 0. 
Proof. Let 9 and Q be as above (thus Lk= o), so E S, and t= (v, T) E V'. By 
Lemma 3.10, t E D (%, Q, so) if and only if there exist a set H_ (T- {A}) x Uk 
u {(A, so)} and a mapping (x, s) ~-> HXs, (x, s) E H, such that for k > 1 conditions 
1-3 hold, and for k =1 conditions 1-3' (of the remark following Lemma 3.10) 
hold. 
Consider first the case k = 1. By Corollary 3.15 there exists for every s E S an 
automaton Ws over E x P(S)-trees such that for (x, s) E H the tree (v, Tx) marked at 
HX,s (Definition 3.1) is accepted by Ws if and only if 3' holds. 
Consider next the case k > 1. Let s E S. By Lemma 3.7 there exists a E x P(S)- 
table Rs, a state s of ts, and a sequence Qk- 1 of length k - 1 such that for (x, s) E H, 
the tree (v, Tx) marked at Hx,s is in D (Aks, Qk-l -) if and only if condition 3 of 
Lemma 3.10 holds. By the induction hypothesis, there exists a finite automaton Ws 
such that T(s) = D (s, k -1 S) 
In either case, D (%, Q, so) is f.a. definable by Lemma 3.2. 
We have thus far established that if ? = <S, M> is a s-table, s E S and Q= 
((Li, UO))1 < i < k with Lk =0. Then D (%, Q, s) is f.a. definable. We now wish to show 
that D (), Q, so) is f.a. definable for an arbitrary sequence Q of length k. 
Proof. By Lemma 3.11, (v, T) E D (%, Q, so) if and only if there exist a set 
HC T x S and a mapping (x, s) ? HX, s such that conditions 1-4 of that lemma hold. 
By Lemma 3.4 the proof that D (%, Q, so) is f.a. definable will be finished if we can 
show that for s E S there exists an automaton W. over the alphabet =E xP(S), 
such that for a L-tree t = (v, T) and a set Hxs (-Tx x 5, W accepts the tree t 
marked at Hx,s if and only if 3 of Lemma 3.11 holds. 
According to Lemma 3.8 there exists a L-table bs, a sequence Qs = ((Li, Ui))?i?-k, 
with Lk = 0, and a state s E S~s; such that for a 2-tree t = (v, Tx) and a set HX s 
c TX x S, condition 3 of Lemma 3.11 holds if and only if the tree t marked at HX s 
is in D (Q3s, Q), s). But D (Zs, C2, s) (which is a set of 2-trees) is f.a. definable by a 
L-automaton W. according to our inductive assumption. This completes the 
proof. 
3.12. Solution of the emptiness problem. We wish to give an effective procedure 
which will enable us to determine for every f.a. W= <S, M, so, F>, over any E, 
whether T(W) = 0. Consider the automaton T = <S, M, so, F> over the single letter 
alphabet = {a} defined by M(s, a) = U,a M(s, a), s E S. Instead of M(s, a), we 
shall simply write M(s). Since there exists for every subtree Tx just one- {a}-valued 
tree (v, Tx) (namely, e(y) = a, y E Tx) we shall omit mention of the valuation and 
talk about R-runs on Tx, % accepting T, etc. 
Notice that every %-run r: T-> S on a L-tree t = (v, T) is also an t-run on T. 
Conversely, if r is an %-run on T, then there exists a s-tree t so that r is an %-run on 
t. Coupled with the definition of T(%), this implies that T(%) A 0 if and only if 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 33 
T(,i) =# 0z; i.e., if and only if T(R) = {T, I x E T}. Thus, the emptiness problem is 
reduced to the case of automata over a single letter alphabet 2 and, henceforth, we 
shall restrict ourselves exclusively to this case. 
The set VE - T(W) is f.a. definable and, given , we can effectively construct a Q3 
such that T(Q) = V- T(W). Now, T(W) = V- T(Q). According to Lemma 3.6 
we can effectively construct a table (E, a sequence Q = ((Li, Uj))1 s i k, and a state 
so of (E so that T(W) = V 
-T(l) = D ((E, Q, so). 
Thus the emptiness problem will be solved if we exhibit an effective procedure 
for deciding for every s-table 5 = <S, M>, sequence Q = ((Li, U1))1 s i k, and 
so E S, whether T e D (%, Q, so). This will be done by reducing the length k 
of Q. 
In fact, the reduction will proceed in the same "half steps" used in proving 
(for an arbitrary E) that the sets D (%, Q, so) are f.a. definable. 
We shall show how to reduce the question whether T E D (%, Q, so) to a finite 
number of questions whether T e D (%, Q', s), where Q'= ((Li, Ui')), ?i k, and 
L = 0. Next we shall show that a question whether T e D (%, Q', s), with Q' as 
above and k > 1, reduces to a finite number of questions whether T E D (%, Qk- 1, s), 
where Qk-1 is a sequence of length k-1. Finally, we show how to solve effectively 
the problem T E D (%, Q, s) where Q = ((z, U)). We shall need the following 
DEFINITION 3.7. Let W = <S, M> be a table, S' c S. The table W restricted to S', 
denote it by %IS', is <S, M'> where M'(s)=M(s) r) S', s E S. 
REMARK Note that 2IS'-runs r on T, are precisely those %-runs for which 
r(y) E S' for y > x. 
In the case 1 ? k and arbitrary Q, let W = <S, M>, Q = ((Li, Uj)) ' i ' k, so s S. In the 
proof of Lemma 3.11 we constructed a sequence (H4),<g of sets and showed that 
(v, T) E D (%, Q, so) if and only if (A, so) E Ua<u Ha. In the case of a single-letter 
alphabet, the construction specializes as follows. Define Ho C S by s E Ho if and 
only if Vr[r E Rn (%, T) A r(A) =s => 3T[r IETc [Q, e]]]. 
Set Gm= Ui?m HI and define H,+c1S by s E Hm+i if and only if s 0 Gm and 
(3.4) Vr[r E Rn (%, T) A r(A) = s -* 3}T[rIr E [Q, e]] v 3y[r(y) E Gm]]. 
Let c (S)=n; then Hm= 0 for m>n. Now Te D (%, Q, so) if and only if so E 
Um n Hm. 
By Lemma 3.8 there exists for any s E S and z c Gm - S, a table 53, a sequence 
= ((Li, i))i <i _k with Lk = 0, and a state s E St such that (3.4) holds if and only 
if T e D (3, IQ, s). Thus the computation of (Hm)o m <n and the question whether 
T e D (%, Q, so), are reduced to deciding a finite number of questions whether 
T E D (5B, Q, s) where each Q2 is a sequence of length k with LLk = 0o. 
The case 1 <k, Lk= 0. Let 9t=<S, M>, so E S, Q?=((Li, Ui% ?<i:k, Lk= 0, and 
Specializing Lemma 3.9 to our case of a single letter alphabet, we see that 
34 M. 0. RABIN [July 
T e D (9X, Q, so) if and only if there exists a nonempty subset Hg Uk such that for 
s e H u {so} 
(3.5) Vr[r e- Rn (Q, T) A r(A) = s -? 3,T[rjITc [Qk -]] V x[A < x A r(x) e H]]. 
In view of Definition 3.7 and the remark following it, (3.5) holds if and only if 
(3.6) Vr'[r' e Rn (9', T) A r'(A) = s => 37T[r'I7Tc [Qke-l]]] 
where W'=5[I(S-H). But (3.6) is equivalent to Te D ({', Qk-1, s). Thus the 
question whether T e D (s, Q, so) effectively reduces to a finite number of questions 
whether T e D (t', Qkl, ,s) where t' ranges over automata 9 1(S-H), H P(S), 
s e S, and Qk-1 is of length k-1. 
The case k=1, L1= 0. Let s2=<S, M>, Q=((z, U)), so 0 SO. It follows at once 
from Lemmas 3.9 and 3.14, that T e D (S, Q, so) if and only if there exist a non- 
empty set UO = {s1, .. ., sm} c U and finite trees Ei, 0 _ i < m, such that for 0 < i _ m, 
if r is an t-run on E with r(A)=si then r(Ei-{A}) n UO# 0. 
Now the question whether for a set UO c U and an element s e S there exists a 
tree E such that for every t-run r on E, r(A) = s implies r(E-{A}) r) UO 0, is 
expressible in the weak second-order theory of 2, and hence, decidable by [3], [16]. 
REFERENCES 
1. J. R. Buchi, On a decision method in restricted second order arithmetic, Proc. Internat. 
Congr. Logic, Method. and Philos. Sci. 1960, Stanford Univ. Press, Stanford, California, 1962, 
pp. 1-11. 
2. , Decision methods in the theory of ordinals, Bull. Amer. Math. Soc. 71 (1965), 
767-770. 
3. J. E. Doner, Decidability of the weak second-order theory of two successors, Notices Amer. 
Math. Soc. 12 (1965), 819. 
4. A. Ehrenfeucht, Decidability of the theory of one function, Notices Amer. Math. Soc. 6 
(1959), 268. 
5. , Decidability of the theory of one linear ordering relation, Notices Amer. Math. Soc. 
6 (1959), 268-269. 
6. Yu. L. Ershov, Decidability of the theory of relatively complemented istributive lattices and 
the theory of filters, Algebra i. Logika Sem. 3 (1964), 5-12. 
7. D. Gale and F. M. Stewart, "Infinite games with perfect information," in Contributions 
to the theory of games. II, Ann. of Math. Studies, No. 28, Princeton Univ. Press, Princeton, 
N. J., 1953, pp. 245-266. 
8. A. Grzegorczyk, Undecidability of some topological theories, Fund. Math. 38 (1951), 
137-152. 
9. H. Lauchli, "A decision procedure for the weak second order theory of linear order" in 
Contributions to mathematical ogic, K. Schutte, editor, North-Holland, Amsterdam, 1968, pp. 
189-197. 
10. R. McNaughton, Testing and generating infinite sequences by a finite automaton, In- 
formation and Control 9 (1966), 521-530. 
11. D. E. Muller, Infinite sequences and finite machines, AIEE Proc. Fourth Annual Symp. 
Switching Circuit Theory and Logical Design, 1963, pp. 3-16. 
1969] DECIDABILITY OF SECOND-ORDER THEORIES 35 
12. M. 0. Rabin, Mathematical theory of automata, Proc. Sympos. Appl. Math., Vol. 19, 
Amer. Math. Soc., Providence, R. I., 1968, pp, 153-175. 
13. M. 0. Rabin and D. Scott, Finite automata and their decision problems, IBM J. Res. 
Develop. 3 (1959), 114-125; reprinted in Sequential machines, selected papers, edited by E. F. 
Moore, Addison-Wesley, Reading, Mass., 1964. 
14. R. Sikorski, Boolean algebras, 2nd ed., Ergebnisse der Math., Vol. 25, Springer-Verlag, 
Berlin, 1964. 
15. A. Tarski, Arithmetical classes and types of Boolean algebras, Bull. Amer. Math. Soc. 
55 (1949), 64. 
16. J. W. Thatcher and J. B. Wright, Generalized finite automata, Notices Amer. Math. Soc. 
12 (1965), 820. 
17. P. Wolfe, The strict determinateness of certain infinite games, Pacific J. Math. 5 (1955), 
841-847. 
IBM WATSON RESEARCH CENTER, 
YORKTOWN HEIGHTS, NEW YORK 
HEBREW UNIVERSITY, 
JERUSALEM, ISRAEL 
